## <a name="add-a-messaging-extension-to-your-app"></a><span data-ttu-id="90e33-101">Ajouter une extension de messagerie à votre application</span><span class="sxs-lookup"><span data-stu-id="90e33-101">Add a messaging extension to your app</span></span>

<span data-ttu-id="90e33-102">Une extension de messagerie est un service hébergé dans le cloud qui écoute les demandes des utilisateurs et répond avec des données structurées, telles qu’une [carte.](~/task-modules-and-cards/what-are-cards.md)</span><span class="sxs-lookup"><span data-stu-id="90e33-102">A messaging extension is a cloud-hosted service that listens to user requests and responds with structured data, such as a [card](~/task-modules-and-cards/what-are-cards.md).</span></span> <span data-ttu-id="90e33-103">Vous intégrez votre service Microsoft Teams via des objets Bot `Activity` Framework.</span><span class="sxs-lookup"><span data-stu-id="90e33-103">You integrate your service with Microsoft Teams via Bot Framework `Activity` objects.</span></span> <span data-ttu-id="90e33-104">Nos extensions .NET et Node.js pour le Bot Builder SDK peuvent vous aider à ajouter des fonctionnalités d’extension de messagerie à votre application.</span><span class="sxs-lookup"><span data-stu-id="90e33-104">Our .NET and Node.js extensions for the Bot Builder SDK can help you add messaging extension functionality to your app.</span></span>

![Diagramme du flux de messages pour les extensions de messagerie](~/assets/images/compose-extensions/ceflow.png)

### <a name="register-in-the-bot-framework"></a><span data-ttu-id="90e33-106">Inscrivez-vous dans le cadre bot</span><span class="sxs-lookup"><span data-stu-id="90e33-106">Register in the Bot Framework</span></span>

<span data-ttu-id="90e33-107">Si vous ne l’avez pas déjà fait, vous devez d’abord enregistrer un bot auprès de la Microsoft Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="90e33-107">If you haven’t done so already, you must first register a bot with the Microsoft Bot Framework.</span></span> <span data-ttu-id="90e33-108">L’id de l’application Microsoft et les paramètres de rappel de votre bot, tels qu’ils y sont définis, seront utilisés dans votre extension de messagerie pour recevoir et répondre aux demandes des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="90e33-108">The Microsoft app ID and callback endpoints for your bot, as defined there, will be used in your messaging extension to receive and respond to user requests.</span></span> <span data-ttu-id="90e33-109">N’oubliez pas d’activer Microsoft Teams canal de recherche pour votre bot.</span><span class="sxs-lookup"><span data-stu-id="90e33-109">Remember to enable the Microsoft Teams channel for your bot.</span></span>

<span data-ttu-id="90e33-110">Enregistrez votre identifiant d’application bot et mot de passe d’application, vous devrez fournir l’iD de l’application dans votre manifeste d’application.</span><span class="sxs-lookup"><span data-stu-id="90e33-110">Record your bot app ID and app password, you will need to supply the app ID in your app manifest.</span></span>

### <a name="update-your-app-manifest"></a><span data-ttu-id="90e33-111">Mettez à jour le manifeste de votre application</span><span class="sxs-lookup"><span data-stu-id="90e33-111">Update your app manifest</span></span>

<span data-ttu-id="90e33-112">Comme pour les bots et les onglets, vous mettez à jour le [manifeste de](~/resources/schema/manifest-schema.md#composeextensions) votre application pour inclure les propriétés d’extension de messagerie.</span><span class="sxs-lookup"><span data-stu-id="90e33-112">As with bots and tabs, you update the [manifest](~/resources/schema/manifest-schema.md#composeextensions) of your app to include the messaging extension properties.</span></span> <span data-ttu-id="90e33-113">Ces propriétés régissent la façon dont votre extension de messagerie apparaît et se comporte dans Microsoft Teams client.</span><span class="sxs-lookup"><span data-stu-id="90e33-113">These properties govern how your messaging extension appears and behaves in the Microsoft Teams client.</span></span> <span data-ttu-id="90e33-114">Les extensions de messagerie sont prises en charge en commençant par v1.0 du manifeste.</span><span class="sxs-lookup"><span data-stu-id="90e33-114">Messaging extensions are supported beginning with v1.0 of the manifest.</span></span>

#### <a name="declare-your-messaging-extension"></a><span data-ttu-id="90e33-115">Déclarez votre extension de messagerie</span><span class="sxs-lookup"><span data-stu-id="90e33-115">Declare your messaging extension</span></span>

<span data-ttu-id="90e33-116">Pour ajouter une extension de messagerie, incluez une nouvelle structure JSON de haut niveau dans votre manifeste avec la `composeExtensions` propriété.</span><span class="sxs-lookup"><span data-stu-id="90e33-116">To add a messaging extension, include a new top-level JSON structure in your manifest with the `composeExtensions` property.</span></span> <span data-ttu-id="90e33-117">Actuellement, vous vous limitez à créer une extension de messagerie unique pour votre application.</span><span class="sxs-lookup"><span data-stu-id="90e33-117">Currently, you are limited to creating a single messaging extension for your app.</span></span>

> [!NOTE]
> <span data-ttu-id="90e33-118">Le manifeste se réfère à des extensions de messagerie comme `composeExtensions` .</span><span class="sxs-lookup"><span data-stu-id="90e33-118">The manifest refers to messaging extensions as `composeExtensions`.</span></span> <span data-ttu-id="90e33-119">Il s’agit de maintenir la compatibilité vers l’arrière.</span><span class="sxs-lookup"><span data-stu-id="90e33-119">This is to maintain backward compatibility.</span></span>

<span data-ttu-id="90e33-120">La définition d’extension est un objet qui a la structure suivante :</span><span class="sxs-lookup"><span data-stu-id="90e33-120">The extension definition is an object that has the following structure:</span></span>

| <span data-ttu-id="90e33-121">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="90e33-121">Property name</span></span> | <span data-ttu-id="90e33-122">Objectif</span><span class="sxs-lookup"><span data-stu-id="90e33-122">Purpose</span></span> | <span data-ttu-id="90e33-123">Obligatoire ?</span><span class="sxs-lookup"><span data-stu-id="90e33-123">Required?</span></span> |
|---|---|---|
| `botId` | <span data-ttu-id="90e33-124">ID d’application Microsoft unique pour le bot inscrit dans le Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="90e33-124">The unique Microsoft app ID for the bot as registered with the Bot Framework.</span></span> <span data-ttu-id="90e33-125">Cela devrait généralement être le même que l’ID pour votre application Teams globale.</span><span class="sxs-lookup"><span data-stu-id="90e33-125">This should typically be the same as the ID for your overall Teams app.</span></span> | <span data-ttu-id="90e33-126">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-126">Yes</span></span> |
| `scopes` | <span data-ttu-id="90e33-127">Tableau déclarant si cette extension peut être ajoutée ou `personal` `team` étendues (ou les deux).</span><span class="sxs-lookup"><span data-stu-id="90e33-127">Array declaring whether this extension can be added to `personal` or `team` scopes (or both).</span></span> | <span data-ttu-id="90e33-128">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-128">Yes</span></span> |
| `canUpdateConfiguration` | <span data-ttu-id="90e33-129">Permet **Paramètres élément** de menu.</span><span class="sxs-lookup"><span data-stu-id="90e33-129">Enables **Settings** menu item.</span></span> | <span data-ttu-id="90e33-130">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-130">No</span></span> |
| `commands` | <span data-ttu-id="90e33-131">Tableau de commandes que prend en charge cette extension de messagerie.</span><span class="sxs-lookup"><span data-stu-id="90e33-131">Array of commands that this messaging extension supports.</span></span> <span data-ttu-id="90e33-132">Vous êtes limité à 10 commandes.</span><span class="sxs-lookup"><span data-stu-id="90e33-132">You are limited to 10 commands.</span></span> | <span data-ttu-id="90e33-133">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-133">Yes</span></span> |

#### <a name="define-commands"></a><span data-ttu-id="90e33-134">Définir les commandes</span><span class="sxs-lookup"><span data-stu-id="90e33-134">Define commands</span></span>

<span data-ttu-id="90e33-135">Votre extension de messagerie doit déclarer une commande, qui apparaît lorsque l’utilisateur sélectionne votre application à partir **du bouton Plus d’options** **(&#8943;)** dans la boîte de composition.</span><span class="sxs-lookup"><span data-stu-id="90e33-135">Your messaging extension should declare one command, which appears when the user selects your app from the **More options** (**&#8943;**) button in the compose box.</span></span>

![Capture d’écran de la liste des extensions de messagerie dans Teams](~/assets/images/compose-extensions/compose-extension-list.png)

<span data-ttu-id="90e33-137">Dans le manifeste de l’application, votre élément de commande est un objet avec la structure suivante :</span><span class="sxs-lookup"><span data-stu-id="90e33-137">In the app manifest, your command item is an object with the following structure:</span></span>

| <span data-ttu-id="90e33-138">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="90e33-138">Property name</span></span> | <span data-ttu-id="90e33-139">Objectif</span><span class="sxs-lookup"><span data-stu-id="90e33-139">Purpose</span></span> | <span data-ttu-id="90e33-140">Obligatoire ?</span><span class="sxs-lookup"><span data-stu-id="90e33-140">Required?</span></span> | <span data-ttu-id="90e33-141">Version manifeste minimale</span><span class="sxs-lookup"><span data-stu-id="90e33-141">Minimum manifest version</span></span> |
|---|---|---|---|
| `id` | <span data-ttu-id="90e33-142">ID unique que vous attribuez à cette commande.</span><span class="sxs-lookup"><span data-stu-id="90e33-142">Unique ID that you assign to this command.</span></span> <span data-ttu-id="90e33-143">La demande de l’utilisateur inclura cet ID.</span><span class="sxs-lookup"><span data-stu-id="90e33-143">The user request will include this ID.</span></span> | <span data-ttu-id="90e33-144">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-144">Yes</span></span> | <span data-ttu-id="90e33-145">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-145">1.0</span></span> |
| `title` | <span data-ttu-id="90e33-146">Nom de commande.</span><span class="sxs-lookup"><span data-stu-id="90e33-146">Command name.</span></span> <span data-ttu-id="90e33-147">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90e33-147">This value appears in the UI.</span></span> | <span data-ttu-id="90e33-148">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-148">Yes</span></span> | <span data-ttu-id="90e33-149">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-149">1.0</span></span> |
| `description` | <span data-ttu-id="90e33-150">Aide texte indiquant ce que cette commande fait.</span><span class="sxs-lookup"><span data-stu-id="90e33-150">Help text indicating what this command does.</span></span> <span data-ttu-id="90e33-151">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90e33-151">This value appears in the UI.</span></span> | <span data-ttu-id="90e33-152">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-152">Yes</span></span> | <span data-ttu-id="90e33-153">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-153">1.0</span></span> |
| `type` | <span data-ttu-id="90e33-154">Définissez le type de commande.</span><span class="sxs-lookup"><span data-stu-id="90e33-154">Set the type of command.</span></span> <span data-ttu-id="90e33-155">Les valeurs possibles sont `query` et `action`.</span><span class="sxs-lookup"><span data-stu-id="90e33-155">Possible values include `query` and `action`.</span></span> <span data-ttu-id="90e33-156">Si elle n’est pas présente, la valeur par défaut est définie sur `query` .</span><span class="sxs-lookup"><span data-stu-id="90e33-156">If not present the default value is set to `query`.</span></span> | <span data-ttu-id="90e33-157">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-157">No</span></span> | <span data-ttu-id="90e33-158">1.4</span><span class="sxs-lookup"><span data-stu-id="90e33-158">1.4</span></span> |
| `initialRun` | <span data-ttu-id="90e33-159">Paramètre optionnel, utilisé avec `query` des commandes.</span><span class="sxs-lookup"><span data-stu-id="90e33-159">Optional parameter, used with `query` commands.</span></span> <span data-ttu-id="90e33-160">Si elle est **définie pour** vrai , indique que cette commande doit être exécutée dès que l’utilisateur choisit cette commande dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90e33-160">If set to **true**, indicates this command should be executed as soon as the user chooses this command in the UI.</span></span> | <span data-ttu-id="90e33-161">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-161">No</span></span> | <span data-ttu-id="90e33-162">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-162">1.0</span></span> |
| `fetchTask` | <span data-ttu-id="90e33-163">Paramètre optionnel, utilisé avec `action` des commandes.</span><span class="sxs-lookup"><span data-stu-id="90e33-163">Optional parameter, used with `action` commands.</span></span> <span data-ttu-id="90e33-164">Réglez à **vrai** pour aller chercher la carte adaptative ou url Web à afficher dans le [module de tâche](~/task-modules-and-cards/what-are-task-modules.md).</span><span class="sxs-lookup"><span data-stu-id="90e33-164">Set to **true** to fetch the adaptive card or web url to display within the [task module](~/task-modules-and-cards/what-are-task-modules.md).</span></span> <span data-ttu-id="90e33-165">Ceci est utilisé lorsque les entrées de la `action` commande sont dynamiques par opposition à un ensemble statique de paramètres.</span><span class="sxs-lookup"><span data-stu-id="90e33-165">This is used when the inputs to the `action` command is dynamic as opposed to a static set of parameters.</span></span> <span data-ttu-id="90e33-166">Notez que le s’il est défini **pour vrai** la liste de paramètres statiques pour la commande est ignorée.</span><span class="sxs-lookup"><span data-stu-id="90e33-166">Note that the if set to **true** the static parameter list for the command is ignored.</span></span> | <span data-ttu-id="90e33-167">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-167">No</span></span> | <span data-ttu-id="90e33-168">1.4</span><span class="sxs-lookup"><span data-stu-id="90e33-168">1.4</span></span> |
| `parameters` | <span data-ttu-id="90e33-169">Liste statique des paramètres de la commande.</span><span class="sxs-lookup"><span data-stu-id="90e33-169">Static list of parameters for the command.</span></span> | <span data-ttu-id="90e33-170">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-170">Yes</span></span> | <span data-ttu-id="90e33-171">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-171">1.0</span></span> |
| `parameter.name` | <span data-ttu-id="90e33-172">Le nom du paramètre.</span><span class="sxs-lookup"><span data-stu-id="90e33-172">The name of the parameter.</span></span> <span data-ttu-id="90e33-173">Ceci est envoyé à votre service dans la demande de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90e33-173">This is sent to your service in the user request.</span></span> | <span data-ttu-id="90e33-174">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-174">Yes</span></span> | <span data-ttu-id="90e33-175">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-175">1.0</span></span> |
| `parameter.description` | <span data-ttu-id="90e33-176">Décrit les objectifs de ce paramètre ou l’exemple de la valeur qui devrait être fournie.</span><span class="sxs-lookup"><span data-stu-id="90e33-176">Describes this parameter’s purposes or example of the value that should be provided.</span></span> <span data-ttu-id="90e33-177">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="90e33-177">This value appears in the UI.</span></span> | <span data-ttu-id="90e33-178">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-178">Yes</span></span> | <span data-ttu-id="90e33-179">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-179">1.0</span></span> |
| `parameter.title` | <span data-ttu-id="90e33-180">Titre ou étiquette de paramètre s’il vous est convivial.</span><span class="sxs-lookup"><span data-stu-id="90e33-180">Short user-friendly parameter title or label.</span></span> | <span data-ttu-id="90e33-181">Oui</span><span class="sxs-lookup"><span data-stu-id="90e33-181">Yes</span></span> | <span data-ttu-id="90e33-182">1.0</span><span class="sxs-lookup"><span data-stu-id="90e33-182">1.0</span></span> |
| `parameter.inputType` | <span data-ttu-id="90e33-183">Définissez le type d’entrée requis.</span><span class="sxs-lookup"><span data-stu-id="90e33-183">Set to the type of input required.</span></span> <span data-ttu-id="90e33-184">Les valeurs possibles `text` incluent , , , , , `textarea` `number` `date` `time` `toggle` .</span><span class="sxs-lookup"><span data-stu-id="90e33-184">Possible values include `text`, `textarea`, `number`, `date`, `time`, `toggle`.</span></span> <span data-ttu-id="90e33-185">Par défaut est défini sur `text` .</span><span class="sxs-lookup"><span data-stu-id="90e33-185">Default is set to `text`.</span></span> | <span data-ttu-id="90e33-186">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-186">No</span></span> | <span data-ttu-id="90e33-187">1.4</span><span class="sxs-lookup"><span data-stu-id="90e33-187">1.4</span></span> |
| `context` | <span data-ttu-id="90e33-188">Tableau facultatif de valeurs qui définit le contexte dans lequel l’action du message est disponible.</span><span class="sxs-lookup"><span data-stu-id="90e33-188">Optional array of values that defines the context the message action is available in.</span></span> <span data-ttu-id="90e33-189">Les valeurs possibles `message` sont `compose` , ou `commandBox` .</span><span class="sxs-lookup"><span data-stu-id="90e33-189">Possible values are `message`, `compose`, or `commandBox`.</span></span> <span data-ttu-id="90e33-190">La valeur par défaut est `["compose", "commandBox"]`.</span><span class="sxs-lookup"><span data-stu-id="90e33-190">Default is `["compose", "commandBox"]`.</span></span> | <span data-ttu-id="90e33-191">Non</span><span class="sxs-lookup"><span data-stu-id="90e33-191">No</span></span> | <span data-ttu-id="90e33-192">1,5</span><span class="sxs-lookup"><span data-stu-id="90e33-192">1.5</span></span> |
