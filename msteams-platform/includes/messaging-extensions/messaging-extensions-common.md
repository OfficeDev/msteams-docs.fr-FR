## <a name="add-a-messaging-extension-to-your-app"></a><span data-ttu-id="28dc6-101">Ajouter une extension de messagerie à votre application</span><span class="sxs-lookup"><span data-stu-id="28dc6-101">Add a messaging extension to your app</span></span>

<span data-ttu-id="28dc6-102">Une extension de messagerie est un service hébergé dans le cloud qui écoute les demandes des utilisateurs et répond avec des données structurées, telles qu’une [carte.](~/task-modules-and-cards/what-are-cards.md)</span><span class="sxs-lookup"><span data-stu-id="28dc6-102">A messaging extension is a cloud-hosted service that listens to user requests and responds with structured data, such as a [card](~/task-modules-and-cards/what-are-cards.md).</span></span> <span data-ttu-id="28dc6-103">Vous intégrez votre service à Microsoft Teams via des objets Bot `Activity` Framework.</span><span class="sxs-lookup"><span data-stu-id="28dc6-103">You integrate your service with Microsoft Teams via Bot Framework `Activity` objects.</span></span> <span data-ttu-id="28dc6-104">Nos extensions .NET et Node.js pour le SDK Bot Builder peuvent vous aider à ajouter des fonctionnalités d’extension de messagerie à votre application.</span><span class="sxs-lookup"><span data-stu-id="28dc6-104">Our .NET and Node.js extensions for the Bot Builder SDK can help you add messaging extension functionality to your app.</span></span>

![Diagramme du flux de messages pour les extensions de messagerie](~/assets/images/compose-extensions/ceflow.png)

### <a name="register-in-the-bot-framework"></a><span data-ttu-id="28dc6-106">S’inscrire dans Bot Framework</span><span class="sxs-lookup"><span data-stu-id="28dc6-106">Register in the Bot Framework</span></span>

<span data-ttu-id="28dc6-107">Si ce n’est pas déjà fait, vous devez d’abord inscrire un bot auprès du Microsoft Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="28dc6-107">If you haven’t done so already, you must first register a bot with the Microsoft Bot Framework.</span></span> <span data-ttu-id="28dc6-108">L’ID d’application Microsoft et les points de terminaison de rappel pour votre bot, tels que définis ici, seront utilisés dans votre extension de messagerie pour recevoir et répondre aux demandes des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="28dc6-108">The Microsoft app ID and callback endpoints for your bot, as defined there, will be used in your messaging extension to receive and respond to user requests.</span></span> <span data-ttu-id="28dc6-109">N’oubliez pas d’activer Microsoft Teams canal de recherche pour votre bot.</span><span class="sxs-lookup"><span data-stu-id="28dc6-109">Remember to enable the Microsoft Teams channel for your bot.</span></span>

<span data-ttu-id="28dc6-110">Enregistrez votre ID d’application de bot et votre mot de passe d’application. Vous devez fournir l’ID de l’application dans le manifeste de votre application.</span><span class="sxs-lookup"><span data-stu-id="28dc6-110">Record your bot app ID and app password, you will need to supply the app ID in your app manifest.</span></span>

### <a name="update-your-app-manifest"></a><span data-ttu-id="28dc6-111">Mettre à jour le manifeste de votre application</span><span class="sxs-lookup"><span data-stu-id="28dc6-111">Update your app manifest</span></span>

<span data-ttu-id="28dc6-112">Comme avec les bots et [](~/resources/schema/manifest-schema.md#composeextensions) les onglets, vous mettez à jour le manifeste de votre application pour inclure les propriétés d’extension de messagerie.</span><span class="sxs-lookup"><span data-stu-id="28dc6-112">As with bots and tabs, you update the [manifest](~/resources/schema/manifest-schema.md#composeextensions) of your app to include the messaging extension properties.</span></span> <span data-ttu-id="28dc6-113">Ces propriétés régissent l’apparition et le comportement de votre extension de messagerie dans le client Microsoft Teams messagerie.</span><span class="sxs-lookup"><span data-stu-id="28dc6-113">These properties govern how your messaging extension appears and behaves in the Microsoft Teams client.</span></span> <span data-ttu-id="28dc6-114">Les extensions de messagerie sont pris en charge à partir de la v1.0 du manifeste.</span><span class="sxs-lookup"><span data-stu-id="28dc6-114">Messaging extensions are supported beginning with v1.0 of the manifest.</span></span>

#### <a name="declare-your-messaging-extension"></a><span data-ttu-id="28dc6-115">Déclarer votre extension de messagerie</span><span class="sxs-lookup"><span data-stu-id="28dc6-115">Declare your messaging extension</span></span>

<span data-ttu-id="28dc6-116">Pour ajouter une extension de messagerie, incluez une nouvelle structure JSON de niveau supérieur dans votre manifeste avec la `composeExtensions` propriété.</span><span class="sxs-lookup"><span data-stu-id="28dc6-116">To add a messaging extension, include a new top-level JSON structure in your manifest with the `composeExtensions` property.</span></span> <span data-ttu-id="28dc6-117">Actuellement, vous êtes limité à la création d’une extension de messagerie unique pour votre application.</span><span class="sxs-lookup"><span data-stu-id="28dc6-117">Currently, you are limited to creating a single messaging extension for your app.</span></span>

> [!NOTE]
> <span data-ttu-id="28dc6-118">Le manifeste fait référence aux extensions de messagerie comme `composeExtensions` .</span><span class="sxs-lookup"><span data-stu-id="28dc6-118">The manifest refers to messaging extensions as `composeExtensions`.</span></span> <span data-ttu-id="28dc6-119">Il s’agit de maintenir la compatibilité ascendante.</span><span class="sxs-lookup"><span data-stu-id="28dc6-119">This is to maintain backward compatibility.</span></span>

<span data-ttu-id="28dc6-120">La définition d’extension est un objet qui a la structure suivante :</span><span class="sxs-lookup"><span data-stu-id="28dc6-120">The extension definition is an object that has the following structure:</span></span>

| <span data-ttu-id="28dc6-121">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="28dc6-121">Property name</span></span> | <span data-ttu-id="28dc6-122">Objectif</span><span class="sxs-lookup"><span data-stu-id="28dc6-122">Purpose</span></span> | <span data-ttu-id="28dc6-123">Obligatoire ?</span><span class="sxs-lookup"><span data-stu-id="28dc6-123">Required?</span></span> |
|---|---|---|
| `botId` | <span data-ttu-id="28dc6-124">ID d’application Microsoft unique pour le bot inscrit dans le Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="28dc6-124">The unique Microsoft app ID for the bot as registered with the Bot Framework.</span></span> <span data-ttu-id="28dc6-125">Il doit généralement être identique à l’ID de votre application Teams globale.</span><span class="sxs-lookup"><span data-stu-id="28dc6-125">This should typically be the same as the ID for your overall Teams app.</span></span> | <span data-ttu-id="28dc6-126">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-126">Yes</span></span> |
| `scopes` | <span data-ttu-id="28dc6-127">Tableau déclarant si cette extension peut être ajoutée à ou `personal` à des `team` étendues (ou les deux).</span><span class="sxs-lookup"><span data-stu-id="28dc6-127">Array declaring whether this extension can be added to `personal` or `team` scopes (or both).</span></span> | <span data-ttu-id="28dc6-128">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-128">Yes</span></span> |
| `canUpdateConfiguration` | <span data-ttu-id="28dc6-129">Active **Paramètres’élément** de menu.</span><span class="sxs-lookup"><span data-stu-id="28dc6-129">Enables **Settings** menu item.</span></span> | <span data-ttu-id="28dc6-130">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-130">No</span></span> |
| `commands` | <span data-ttu-id="28dc6-131">Tableau de commandes pris en charge par cette extension de messagerie.</span><span class="sxs-lookup"><span data-stu-id="28dc6-131">Array of commands that this messaging extension supports.</span></span> <span data-ttu-id="28dc6-132">Vous êtes limité à 10 commandes.</span><span class="sxs-lookup"><span data-stu-id="28dc6-132">You are limited to 10 commands.</span></span> | <span data-ttu-id="28dc6-133">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-133">Yes</span></span> |

#### <a name="define-commands"></a><span data-ttu-id="28dc6-134">Définir des commandes</span><span class="sxs-lookup"><span data-stu-id="28dc6-134">Define commands</span></span>

<span data-ttu-id="28dc6-135">Votre extension de messagerie doit déclarer une commande, qui s’affiche lorsque l’utilisateur sélectionne votre application à partir du bouton Plus **d’options** (**&#8943;**) dans la zone de composition.</span><span class="sxs-lookup"><span data-stu-id="28dc6-135">Your messaging extension should declare one command, which appears when the user selects your app from the **More options** (**&#8943;**) button in the compose box.</span></span>

![Capture d’écran de la liste des extensions de messagerie dans Teams](~/assets/images/compose-extensions/compose-extension-list.png)

<span data-ttu-id="28dc6-137">Dans le manifeste de l’application, votre élément de commande est un objet avec la structure suivante :</span><span class="sxs-lookup"><span data-stu-id="28dc6-137">In the app manifest, your command item is an object with the following structure:</span></span>

| <span data-ttu-id="28dc6-138">Nom de la propriété</span><span class="sxs-lookup"><span data-stu-id="28dc6-138">Property name</span></span> | <span data-ttu-id="28dc6-139">Objectif</span><span class="sxs-lookup"><span data-stu-id="28dc6-139">Purpose</span></span> | <span data-ttu-id="28dc6-140">Obligatoire ?</span><span class="sxs-lookup"><span data-stu-id="28dc6-140">Required?</span></span> | <span data-ttu-id="28dc6-141">Version minimale du manifeste</span><span class="sxs-lookup"><span data-stu-id="28dc6-141">Minimum manifest version</span></span> |
|---|---|---|---|
| `id` | <span data-ttu-id="28dc6-142">ID unique que vous affectez à cette commande.</span><span class="sxs-lookup"><span data-stu-id="28dc6-142">Unique ID that you assign to this command.</span></span> <span data-ttu-id="28dc6-143">La demande de l’utilisateur inclut cet ID.</span><span class="sxs-lookup"><span data-stu-id="28dc6-143">The user request will include this ID.</span></span> | <span data-ttu-id="28dc6-144">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-144">Yes</span></span> | <span data-ttu-id="28dc6-145">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-145">1.0</span></span> |
| `title` | <span data-ttu-id="28dc6-146">Nom de la commande.</span><span class="sxs-lookup"><span data-stu-id="28dc6-146">Command name.</span></span> <span data-ttu-id="28dc6-147">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="28dc6-147">This value appears in the UI.</span></span> | <span data-ttu-id="28dc6-148">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-148">Yes</span></span> | <span data-ttu-id="28dc6-149">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-149">1.0</span></span> |
| `description` | <span data-ttu-id="28dc6-150">Texte d’aide indiquant ce que fait cette commande.</span><span class="sxs-lookup"><span data-stu-id="28dc6-150">Help text indicating what this command does.</span></span> <span data-ttu-id="28dc6-151">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="28dc6-151">This value appears in the UI.</span></span> | <span data-ttu-id="28dc6-152">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-152">Yes</span></span> | <span data-ttu-id="28dc6-153">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-153">1.0</span></span> |
| `type` | <span data-ttu-id="28dc6-154">Définissez le type de commande.</span><span class="sxs-lookup"><span data-stu-id="28dc6-154">Set the type of command.</span></span> <span data-ttu-id="28dc6-155">Les valeurs possibles sont `query` et `action`.</span><span class="sxs-lookup"><span data-stu-id="28dc6-155">Possible values include `query` and `action`.</span></span> <span data-ttu-id="28dc6-156">Si elle n’est pas présente, la valeur par défaut est définie sur `query` .</span><span class="sxs-lookup"><span data-stu-id="28dc6-156">If not present the default value is set to `query`.</span></span> | <span data-ttu-id="28dc6-157">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-157">No</span></span> | <span data-ttu-id="28dc6-158">1.4</span><span class="sxs-lookup"><span data-stu-id="28dc6-158">1.4</span></span> |
| `initialRun` | <span data-ttu-id="28dc6-159">Paramètre facultatif, utilisé avec `query` les commandes.</span><span class="sxs-lookup"><span data-stu-id="28dc6-159">Optional parameter, used with `query` commands.</span></span> <span data-ttu-id="28dc6-160">Si la valeur **est true,** indique que cette commande doit être exécutée dès que l’utilisateur choisit cette commande dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="28dc6-160">If set to **true**, indicates this command should be executed as soon as the user chooses this command in the UI.</span></span> | <span data-ttu-id="28dc6-161">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-161">No</span></span> | <span data-ttu-id="28dc6-162">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-162">1.0</span></span> |
| `fetchTask` | <span data-ttu-id="28dc6-163">Paramètre facultatif, utilisé avec `action` les commandes.</span><span class="sxs-lookup"><span data-stu-id="28dc6-163">Optional parameter, used with `action` commands.</span></span> <span data-ttu-id="28dc6-164">Définissez sur **true** pour récupérer la carte adaptative ou l’URL web à afficher dans le [module de tâche](~/task-modules-and-cards/what-are-task-modules.md).</span><span class="sxs-lookup"><span data-stu-id="28dc6-164">Set to **true** to fetch the adaptive card or web url to display within the [task module](~/task-modules-and-cards/what-are-task-modules.md).</span></span> <span data-ttu-id="28dc6-165">Cette valeur est utilisée lorsque les entrées de la commande sont dynamiques par opposition à un `action` ensemble statique de paramètres.</span><span class="sxs-lookup"><span data-stu-id="28dc6-165">This is used when the inputs to the `action` command is dynamic as opposed to a static set of parameters.</span></span> <span data-ttu-id="28dc6-166">Notez que si la valeur true **est définie,** la liste des paramètres statiques de la commande est ignorée.</span><span class="sxs-lookup"><span data-stu-id="28dc6-166">Note that the if set to **true** the static parameter list for the command is ignored.</span></span> | <span data-ttu-id="28dc6-167">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-167">No</span></span> | <span data-ttu-id="28dc6-168">1.4</span><span class="sxs-lookup"><span data-stu-id="28dc6-168">1.4</span></span> |
| `parameters` | <span data-ttu-id="28dc6-169">Liste statique des paramètres de la commande.</span><span class="sxs-lookup"><span data-stu-id="28dc6-169">Static list of parameters for the command.</span></span> | <span data-ttu-id="28dc6-170">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-170">Yes</span></span> | <span data-ttu-id="28dc6-171">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-171">1.0</span></span> |
| `parameter.name` | <span data-ttu-id="28dc6-172">Le nom du paramètre.</span><span class="sxs-lookup"><span data-stu-id="28dc6-172">The name of the parameter.</span></span> <span data-ttu-id="28dc6-173">Cette information est envoyée à votre service dans la demande de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="28dc6-173">This is sent to your service in the user request.</span></span> | <span data-ttu-id="28dc6-174">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-174">Yes</span></span> | <span data-ttu-id="28dc6-175">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-175">1.0</span></span> |
| `parameter.description` | <span data-ttu-id="28dc6-176">Décrit les objectifs de ce paramètre ou un exemple de la valeur à fournir.</span><span class="sxs-lookup"><span data-stu-id="28dc6-176">Describes this parameter’s purposes or example of the value that should be provided.</span></span> <span data-ttu-id="28dc6-177">Cette valeur apparaît dans l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="28dc6-177">This value appears in the UI.</span></span> | <span data-ttu-id="28dc6-178">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-178">Yes</span></span> | <span data-ttu-id="28dc6-179">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-179">1.0</span></span> |
| `parameter.title` | <span data-ttu-id="28dc6-180">Titre ou étiquette de paramètre court et convivial.</span><span class="sxs-lookup"><span data-stu-id="28dc6-180">Short user-friendly parameter title or label.</span></span> | <span data-ttu-id="28dc6-181">Oui</span><span class="sxs-lookup"><span data-stu-id="28dc6-181">Yes</span></span> | <span data-ttu-id="28dc6-182">1.0</span><span class="sxs-lookup"><span data-stu-id="28dc6-182">1.0</span></span> |
| `parameter.inputType` | <span data-ttu-id="28dc6-183">Définir sur le type d’entrée requis.</span><span class="sxs-lookup"><span data-stu-id="28dc6-183">Set to the type of input required.</span></span> <span data-ttu-id="28dc6-184">Les valeurs `text` possibles sont , , , , `textarea` `number` `date` `time` `toggle` .</span><span class="sxs-lookup"><span data-stu-id="28dc6-184">Possible values include `text`, `textarea`, `number`, `date`, `time`, `toggle`.</span></span> <span data-ttu-id="28dc6-185">La valeur par défaut est définie sur `text` .</span><span class="sxs-lookup"><span data-stu-id="28dc6-185">Default is set to `text`.</span></span> | <span data-ttu-id="28dc6-186">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-186">No</span></span> | <span data-ttu-id="28dc6-187">1.4</span><span class="sxs-lookup"><span data-stu-id="28dc6-187">1.4</span></span> |
| `context` | <span data-ttu-id="28dc6-188">Tableau facultatif de valeurs qui définit le contexte dans lequel l’action de message est disponible.</span><span class="sxs-lookup"><span data-stu-id="28dc6-188">Optional array of values that defines the context the message action is available in.</span></span> <span data-ttu-id="28dc6-189">Les valeurs possibles `message` sont , `compose` ou `commandBox` .</span><span class="sxs-lookup"><span data-stu-id="28dc6-189">Possible values are `message`, `compose`, or `commandBox`.</span></span> <span data-ttu-id="28dc6-190">La valeur par défaut est `["compose", "commandBox"]`.</span><span class="sxs-lookup"><span data-stu-id="28dc6-190">Default is `["compose", "commandBox"]`.</span></span> | <span data-ttu-id="28dc6-191">Non</span><span class="sxs-lookup"><span data-stu-id="28dc6-191">No</span></span> | <span data-ttu-id="28dc6-192">1,5</span><span class="sxs-lookup"><span data-stu-id="28dc6-192">1.5</span></span> |
