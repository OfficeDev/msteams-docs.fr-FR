---
title: Prise en charge de l' sign-on unique pour les onglets
description: Décrit l' sign-on unique (SSO)
ms.topic: how-to
keywords: Api d’authentification unique SSO AAD d’authentification teams
ms.openlocfilehash: e6bf278e446861556da8362905916cc030df723e
ms.sourcegitcommit: 82bda0599ba2676ab9348c2f4284f73c7dad0838
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2021
ms.locfileid: "51596680"
---
# <a name="single-sign-on-sso-support-for-tabs"></a><span data-ttu-id="643f4-104">Prise en charge de l' sign-on unique (SSO) pour les onglets</span><span class="sxs-lookup"><span data-stu-id="643f4-104">Single sign-on (SSO) support for tabs</span></span>

<span data-ttu-id="643f4-105">Les utilisateurs se connectent à Microsoft Teams via leurs comptes professionnels, scolaires ou Microsoft qui sont Office 365, Outlook, etc.</span><span class="sxs-lookup"><span data-stu-id="643f4-105">Users sign in to Microsoft Teams through their work, school, or Microsoft accounts that is Office 365, Outlook, and so on.</span></span> <span data-ttu-id="643f4-106">Vous pouvez en tirer parti en permettant à une sign-on unique d’autoriser votre onglet Teams ou module de tâche sur les clients de bureau ou mobiles.</span><span class="sxs-lookup"><span data-stu-id="643f4-106">You can take advantage of this by allowing a single sign-on to authorize your Teams tab or task module on desktop or mobile clients.</span></span> <span data-ttu-id="643f4-107">Si un utilisateur consent à utiliser votre application, il n’a pas à consentir à nouveau sur un autre appareil, car il est connecté automatiquement.</span><span class="sxs-lookup"><span data-stu-id="643f4-107">If a user consents to use your app, they do not have to consent again on another device as they are signed in automatically.</span></span> <span data-ttu-id="643f4-108">En outre, votre jeton d’accès est préréférable pour améliorer les performances et les temps de chargement.</span><span class="sxs-lookup"><span data-stu-id="643f4-108">In addition, your access token is prefetched to improve performance and load times.</span></span>

> [!NOTE]
> <span data-ttu-id="643f4-109">**Versions des clients mobiles Teams qui la prise en charge de l' sso**</span><span class="sxs-lookup"><span data-stu-id="643f4-109">**Teams mobile client versions supporting SSO**</span></span>  
>
> <span data-ttu-id="643f4-110">✔Teams pour Android (1416/1.0.0.2020073101 et ultérieures)</span><span class="sxs-lookup"><span data-stu-id="643f4-110">✔Teams for Android (1416/1.0.0.2020073101 and later)</span></span>
>
> <span data-ttu-id="643f4-111">✔Teams pour iOS (_Version_: 2.0.18 et versions ultérieures)</span><span class="sxs-lookup"><span data-stu-id="643f4-111">✔Teams for iOS (_Version_: 2.0.18 and later)</span></span>  
>
> <span data-ttu-id="643f4-112">Pour une expérience améliorée avec Teams, utilisez la dernière version d’iOS et Android.</span><span class="sxs-lookup"><span data-stu-id="643f4-112">For the best experience with Teams, use the latest version of iOS and Android.</span></span>

> [!NOTE]
> <span data-ttu-id="643f4-113">**Démarrage rapide**</span><span class="sxs-lookup"><span data-stu-id="643f4-113">**Quickstart**</span></span>  
>
> <span data-ttu-id="643f4-114">Le chemin d’accès le plus simple pour commencer à utiliser l' ssO onglet est le kit de ressources Teams pour Visual Studio Code.</span><span class="sxs-lookup"><span data-stu-id="643f4-114">The simplest path to getting started with tab SSO is with the Teams toolkit for Visual Studio Code.</span></span> <span data-ttu-id="643f4-115">Pour plus d’informations, voir [SSO avec le](../../../toolkit/visual-studio-code-tab-sso.md) kit de ressources Teams et Visual Studio code pour les onglets</span><span class="sxs-lookup"><span data-stu-id="643f4-115">For more information, see [SSO with Teams toolkit and Visual Studio Code for tabs](../../../toolkit/visual-studio-code-tab-sso.md)</span></span>

## <a name="how-sso-works-at-runtime"></a><span data-ttu-id="643f4-116">Mode de fonctionnement de l’authentification unique SSO en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="643f4-116">How SSO works at runtime</span></span>

<span data-ttu-id="643f4-117">L’image suivante illustre le fonctionnement du processus DSO :</span><span class="sxs-lookup"><span data-stu-id="643f4-117">The following image shows how the SSO process works:</span></span>

<!-- markdownlint-disable MD033 -->
<img src="~/assets/images/tabs/tabs-sso-diagram.png" alt="Tab single sign-on SSO diagram" width="75%"/>

1. <span data-ttu-id="643f4-118">Dans l’onglet, un appel JavaScript est effectué pour `getAuthToken()`.</span><span class="sxs-lookup"><span data-stu-id="643f4-118">In the tab, a JavaScript call is made to `getAuthToken()`.</span></span> <span data-ttu-id="643f4-119">Cela indique à Teams d’obtenir un jeton d’authentification pour l’application onglet.</span><span class="sxs-lookup"><span data-stu-id="643f4-119">This tells Teams to obtain an authentication token for the tab application.</span></span>
2. <span data-ttu-id="643f4-120">Si c’est la première fois que l’utilisateur actuel utilise votre application d’onglet, une invite de demande de consentement s’impose ou permet de gérer l’authentification par étapes, telle que l’authentification à deux facteurs.</span><span class="sxs-lookup"><span data-stu-id="643f4-120">If this is the first time the current user has used your tab application, there is a request prompt to consent if consent is required or to handle step-up authentication such as two-factor authentication.</span></span>
3. <span data-ttu-id="643f4-121">Teams demande le jeton d’application d’onglet au point de terminaison Azure Active Directory (AAD) pour l’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="643f4-121">Teams requests the tab application token from the Azure Active Directory (AAD) endpoint for the current user.</span></span>
4. <span data-ttu-id="643f4-122">AAD envoie le jeton d’application d’onglet à l’application Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-122">AAD sends the tab application token to the Teams application.</span></span>
5. <span data-ttu-id="643f4-123">Teams envoie le jeton d’application d’onglet à l’onglet dans le cadre de l’objet de résultat renvoyé par `getAuthToken()` l’appel.</span><span class="sxs-lookup"><span data-stu-id="643f4-123">Teams sends the tab application token to the tab as part of the result object returned by the `getAuthToken()` call.</span></span>
6. <span data-ttu-id="643f4-124">Le jeton est analysé dans l’application de l’onglet à l’aide de JavaScript, afin d’extraire les informations requises, telles que l’adresse de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="643f4-124">The token is parsed in the tab application using JavaScript, to extract required information, such as the user's email address.</span></span>

> [!NOTE]
> <span data-ttu-id="643f4-125">Le n’est valide que pour donner son consentement à un ensemble limité d’API au niveau de l’utilisateur , c’est-à-dire la messagerie, le `getAuthToken()` profil, offline_access et OpenId.</span><span class="sxs-lookup"><span data-stu-id="643f4-125">The `getAuthToken()` is only valid for consenting to a limited set of user-level APIs that is email, profile, offline_access and OpenId.</span></span> <span data-ttu-id="643f4-126">Il n’est pas utilisé pour d’autres étendues Graph telles `User.Read` que ou `Mail.Read` .</span><span class="sxs-lookup"><span data-stu-id="643f4-126">It is not used for further Graph scopes such as `User.Read` or `Mail.Read`.</span></span> <span data-ttu-id="643f4-127">Pour obtenir des solutions de contournement suggérées, voir [les étendues Graph supplémentaires.](#apps-that-require-additional-graph-scopes)</span><span class="sxs-lookup"><span data-stu-id="643f4-127">For suggested workarounds, see [additional Graph scopes](#apps-that-require-additional-graph-scopes).</span></span>

<span data-ttu-id="643f4-128">L’API DSO fonctionne également dans les [modules de tâche](../../../task-modules-and-cards/what-are-task-modules.md) qui incorporent du contenu web.</span><span class="sxs-lookup"><span data-stu-id="643f4-128">The SSO API also works in [task modules](../../../task-modules-and-cards/what-are-task-modules.md) that embed web content.</span></span>

## <a name="develop-an-sso-microsoft-teams-tab"></a><span data-ttu-id="643f4-129">Développer un onglet SSO Microsoft Teams</span><span class="sxs-lookup"><span data-stu-id="643f4-129">Develop an SSO Microsoft Teams tab</span></span>

<span data-ttu-id="643f4-130">Cette section décrit les tâches impliquées dans la création d’un onglet Teams qui utilise l' sso.</span><span class="sxs-lookup"><span data-stu-id="643f4-130">This section describes the tasks involved in creating a Teams tab that uses SSO.</span></span> <span data-ttu-id="643f4-131">Ces tâches sont spécifiques à la langue et à l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="643f4-131">These tasks are language- and framework-agnostic.</span></span>

### <a name="1-create-your-aad-application"></a><span data-ttu-id="643f4-132">1. Créer votre application AAD</span><span class="sxs-lookup"><span data-stu-id="643f4-132">1. Create your AAD application</span></span>

<span data-ttu-id="643f4-133">**Pour inscrire votre application dans la vue [d’ensemble du portail AAD](https://azure.microsoft.com/features/azure-portal/)**</span><span class="sxs-lookup"><span data-stu-id="643f4-133">**To register your application in the [AAD portal](https://azure.microsoft.com/features/azure-portal/) overview**</span></span>

1. <span data-ttu-id="643f4-134">Obtenez votre [ID d’application AAD.](/azure/active-directory/develop/howto-create-service-principal-portal#get-values-for-signing-in)</span><span class="sxs-lookup"><span data-stu-id="643f4-134">Get your [AAD Application ID](/azure/active-directory/develop/howto-create-service-principal-portal#get-values-for-signing-in).</span></span>
2. <span data-ttu-id="643f4-135">Spécifiez les autorisations dont votre application a besoin pour le point de terminaison AAD et, éventuellement, Graph.</span><span class="sxs-lookup"><span data-stu-id="643f4-135">Specify the permissions that your application needs for the AAD endpoint and, optionally, Graph.</span></span>
3. <span data-ttu-id="643f4-136">[Accorder des autorisations](/azure/active-directory/develop/howto-create-service-principal-portal#configure-access-policies-on-resources) pour les applications de bureau, web et mobiles Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-136">[Grant permissions](/azure/active-directory/develop/howto-create-service-principal-portal#configure-access-policies-on-resources) for Teams desktop, web, and mobile applications.</span></span>
4. <span data-ttu-id="643f4-137">Pré-autoriser Teams en sélectionnant le bouton Ajouter une étendue et dans le panneau qui s’ouvre, entrez **access_as_user** comme nom **d’étendue.** </span><span class="sxs-lookup"><span data-stu-id="643f4-137">Pre-authorize Teams by selecting the **Add a scope** button and in the panel that opens, enter **access_as_user** as the **Scope name**.</span></span>

> [!NOTE]
> <span data-ttu-id="643f4-138">Vous devez connaître certaines restrictions importantes :</span><span class="sxs-lookup"><span data-stu-id="643f4-138">There are some important restrictions that you must know:</span></span>
>
> * <span data-ttu-id="643f4-139">Seules les autorisations de l’API Graph au niveau de l’utilisateur sont pris en charge , c’est-à-dire, e-mail, profil, offline_access, OpenId.</span><span class="sxs-lookup"><span data-stu-id="643f4-139">Only user-level Graph API permissions are supported that is, email, profile, offline_access, OpenId.</span></span> <span data-ttu-id="643f4-140">Si vous devez avoir accès à d’autres étendues Graph telles que ou , voir `User.Read` `Mail.Read` la solution de [contournement recommandée.](#apps-that-require-additional-graph-scopes)</span><span class="sxs-lookup"><span data-stu-id="643f4-140">If you must have access to other Graph scopes such as `User.Read` or `Mail.Read`, see [recommended workaround](#apps-that-require-additional-graph-scopes).</span></span>
> * <span data-ttu-id="643f4-141">Il est important que le nom de domaine de votre application soit identique au nom de domaine que vous avez enregistré pour votre application AAD.</span><span class="sxs-lookup"><span data-stu-id="643f4-141">It is important that your application's domain name is the same as the domain name you have registered for your AAD application.</span></span>
> * <span data-ttu-id="643f4-142">Actuellement, plusieurs domaines par application ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="643f4-142">Currently multiple domains per app are not supported.</span></span>
> * <span data-ttu-id="643f4-143">Les applications qui utilisent le domaine ne sont pas pris en charge car elles sont trop courantes `azurewebsites.net` et peuvent être un risque pour la sécurité.</span><span class="sxs-lookup"><span data-stu-id="643f4-143">Applications that use the `azurewebsites.net` domain are not supported as it is too common and can be a security risk.</span></span>

<span data-ttu-id="643f4-144">**Pour inscrire votre application via le portail AAD**</span><span class="sxs-lookup"><span data-stu-id="643f4-144">**To register your app through the AAD portal**</span></span>

1. <span data-ttu-id="643f4-145">Inscrivez une nouvelle application dans le portail [d’inscription des applications AAD.](https://go.microsoft.com/fwlink/?linkid=2083908)</span><span class="sxs-lookup"><span data-stu-id="643f4-145">Register a new application in the [AAD App Registrations](https://go.microsoft.com/fwlink/?linkid=2083908) portal.</span></span>
2. <span data-ttu-id="643f4-146">Sélectionnez **Nouvelle inscription.**</span><span class="sxs-lookup"><span data-stu-id="643f4-146">Select **New Registration**.</span></span> <span data-ttu-id="643f4-147">La page **Inscrire une application** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="643f4-147">The **Register an application** page appears.</span></span>
3. <span data-ttu-id="643f4-148">Dans la page **Inscrire une application,** entrez les valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="643f4-148">In the **Register an application** page, enter the following values:</span></span>
    1. <span data-ttu-id="643f4-149">Entrez un **nom** pour votre application.</span><span class="sxs-lookup"><span data-stu-id="643f4-149">Enter a **Name** for your app.</span></span>
    2. <span data-ttu-id="643f4-150">Choisissez les **types de comptes pris en** charge, sélectionnez le type de compte client unique ou multi-locataire.</span><span class="sxs-lookup"><span data-stu-id="643f4-150">Choose the **Supported account types**, select single tenant or multitenant account type.</span></span> <span data-ttu-id="643f4-151">¹</span><span class="sxs-lookup"><span data-stu-id="643f4-151">¹</span></span>
    * <span data-ttu-id="643f4-152">Laissez **Redirect URI** vide.</span><span class="sxs-lookup"><span data-stu-id="643f4-152">Leave **Redirect URI** empty.</span></span>
    3. <span data-ttu-id="643f4-153">Choisissez **Inscrire**.</span><span class="sxs-lookup"><span data-stu-id="643f4-153">Choose **Register**.</span></span>
4. <span data-ttu-id="643f4-154">Dans la page vue d’ensemble, copiez et enregistrez **l’ID de l’application (client).**</span><span class="sxs-lookup"><span data-stu-id="643f4-154">On the overview page, copy and save the **Application (client) ID**.</span></span> <span data-ttu-id="643f4-155">Vous devez l’avoir ultérieurement lors de la mise à jour de votre manifeste d’application Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-155">You must have it later when updating your Teams application manifest.</span></span>
5. <span data-ttu-id="643f4-156">Sélectionnez **Exposer une API** sous **Gérer**.</span><span class="sxs-lookup"><span data-stu-id="643f4-156">Under **Manage**, select **Expose an API**.</span></span>
6. <span data-ttu-id="643f4-157">Sélectionnez **le lien** Définir pour générer l’URI d’ID d’application sous la forme `api://{AppID}` .</span><span class="sxs-lookup"><span data-stu-id="643f4-157">Select the **Set** link to generate the Application ID URI in the form of `api://{AppID}`.</span></span> <span data-ttu-id="643f4-158">Insérez votre nom de domaine complet avec une barre oblique « / » à la fin, entre les barres obliques doubles et le GUID.</span><span class="sxs-lookup"><span data-stu-id="643f4-158">Insert your fully qualified domain name with a forward slash "/" appended to the end, between the double forward slashes and the GUID.</span></span> <span data-ttu-id="643f4-159">L’ID entier doit avoir la forme de `api://fully-qualified-domain-name.com/{AppID}` .</span><span class="sxs-lookup"><span data-stu-id="643f4-159">The entire ID must have the form of `api://fully-qualified-domain-name.com/{AppID}`.</span></span> <span data-ttu-id="643f4-160">² Par exemple, `api://subdomain.example.com/00000000-0000-0000-0000-000000000000` .</span><span class="sxs-lookup"><span data-stu-id="643f4-160">² For example, `api://subdomain.example.com/00000000-0000-0000-0000-000000000000`.</span></span> <span data-ttu-id="643f4-161">Le nom de domaine complet est le nom de domaine lisible par l’homme à partir duquel votre application est servie.</span><span class="sxs-lookup"><span data-stu-id="643f4-161">The fully qualified domain name is the human readable domain name from which your app is served.</span></span> <span data-ttu-id="643f4-162">Si vous utilisez un service de tunneling tel que ngrok, vous devez mettre à jour cette valeur chaque fois que votre sous-domaine ngrok change.</span><span class="sxs-lookup"><span data-stu-id="643f4-162">If you are using a tunneling service such as ngrok, you must update this value whenever your ngrok subdomain changes.</span></span>
7. <span data-ttu-id="643f4-163">Sélectionnez **Ajouter une étendue**.</span><span class="sxs-lookup"><span data-stu-id="643f4-163">Select **Add a scope**.</span></span> <span data-ttu-id="643f4-164">Dans le panneau qui s’ouvre, **entrez access_as_user** comme **nom d’étendue.**</span><span class="sxs-lookup"><span data-stu-id="643f4-164">In the panel that opens, enter **access_as_user** as the **Scope name**.</span></span>
8. <span data-ttu-id="643f4-165">Dans la **zone Qui peut consentir ?** entrez **Administrateurs et utilisateurs.**</span><span class="sxs-lookup"><span data-stu-id="643f4-165">In the **Who can consent?** box, enter **Admins and users**.</span></span>
9. <span data-ttu-id="643f4-166">Entrez les détails dans les zones pour configurer les invites de consentement de l’administrateur et de l’utilisateur avec des valeurs appropriées pour `access_as_user` l’étendue :</span><span class="sxs-lookup"><span data-stu-id="643f4-166">Enter the details in the boxes for configuring the admin and user consent prompts with values that are appropriate for the `access_as_user` scope:</span></span>
    * <span data-ttu-id="643f4-167">**Titre du consentement de l’administrateur :** Teams peut accéder au profil de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="643f4-167">**Admin consent title:** Teams can access the user’s profile.</span></span>
    * <span data-ttu-id="643f4-168">**Description du consentement de** l’administrateur : Teams peut appeler les API web de l’application en tant qu’utilisateur actuel.</span><span class="sxs-lookup"><span data-stu-id="643f4-168">**Admin consent description**: Teams can call the app’s web APIs as the current user.</span></span>
    * <span data-ttu-id="643f4-169">**Titre du consentement de l’utilisateur**: Teams peut accéder à votre profil et effectuer des demandes en votre nom.</span><span class="sxs-lookup"><span data-stu-id="643f4-169">**User consent title**: Teams can access your profile and make requests on your behalf.</span></span>
    * <span data-ttu-id="643f4-170">**Description du consentement de l’utilisateur :** Teams peut appeler les API de cette application avec les mêmes droits que vous.</span><span class="sxs-lookup"><span data-stu-id="643f4-170">**User consent description:** Teams can call this app’s APIs with the same rights as you have.</span></span>
10. <span data-ttu-id="643f4-171">Vérifiez que **State** est défini comme **Enabled**.</span><span class="sxs-lookup"><span data-stu-id="643f4-171">Ensure that **State** is set to **Enabled**.</span></span>
11. <span data-ttu-id="643f4-172">Sélectionnez **Ajouter une étendue** pour enregistrer les détails.</span><span class="sxs-lookup"><span data-stu-id="643f4-172">Select **Add scope** to save the details.</span></span> <span data-ttu-id="643f4-173">La partie domaine  du nom d’étendue affichée sous le champ de texte doit automatiquement correspondre à l’URI **d’ID** d’application définie à l’étape précédente, avec ajouté à `/access_as_user` la `api://subdomain.example.com/00000000-0000-0000-0000-000000000000/access_as_user` fin.</span><span class="sxs-lookup"><span data-stu-id="643f4-173">The domain part of the **Scope name** displayed below the text field must automatically match the **Application ID** URI set in the previous step, with `/access_as_user` appended to the end `api://subdomain.example.com/00000000-0000-0000-0000-000000000000/access_as_user`.</span></span>
12. <span data-ttu-id="643f4-174">Dans la section **Applications clientes autorisées,** identifiez les applications que vous souhaitez autoriser pour l’application web de votre application.</span><span class="sxs-lookup"><span data-stu-id="643f4-174">In the **Authorized client applications** section, identify the applications that you want to authorize for your app’s web application.</span></span> <span data-ttu-id="643f4-175">Sélectionnez **Ajouter une application cliente.**</span><span class="sxs-lookup"><span data-stu-id="643f4-175">Select **Add a client application**.</span></span> <span data-ttu-id="643f4-176">Entrez chacun des ID clients suivants et sélectionnez l’étendue autorisée que vous avez créée à l’étape précédente :</span><span class="sxs-lookup"><span data-stu-id="643f4-176">Enter each of the following client IDs and select the authorized scope you created in the previous step:</span></span>
    * <span data-ttu-id="643f4-177">`1fec8e78-bce4-4aaf-ab1b-5451cc387264` pour l’application mobile ou de bureau Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-177">`1fec8e78-bce4-4aaf-ab1b-5451cc387264` for Teams mobile or desktop application.</span></span>
    * <span data-ttu-id="643f4-178">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346` pour l’application web Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-178">`5e3ce6c0-2b1f-4285-8d4b-75ee78787346` for Teams web application.</span></span>
13. <span data-ttu-id="643f4-179">Accédez aux **autorisations d’API.**</span><span class="sxs-lookup"><span data-stu-id="643f4-179">Navigate to **API Permissions**.</span></span> <span data-ttu-id="643f4-180">Sélectionnez **Ajouter une autorisation Autorisation**  >  déléguée Microsoft **Graph,** puis ajoutez les autorisations suivantes à partir de  >  l’API Graph :</span><span class="sxs-lookup"><span data-stu-id="643f4-180">Select **Add a permission** > **Microsoft Graph** > **Delegated permissions**, then add the following permissions from Graph API:</span></span>
    * <span data-ttu-id="643f4-181">User.Read activé par défaut</span><span class="sxs-lookup"><span data-stu-id="643f4-181">User.Read enabled by default</span></span>
    * <span data-ttu-id="643f4-182">email</span><span class="sxs-lookup"><span data-stu-id="643f4-182">email</span></span>
    * <span data-ttu-id="643f4-183">offline_access</span><span class="sxs-lookup"><span data-stu-id="643f4-183">offline_access</span></span>
    * <span data-ttu-id="643f4-184">OpenId</span><span class="sxs-lookup"><span data-stu-id="643f4-184">OpenId</span></span>
    * <span data-ttu-id="643f4-185">profil</span><span class="sxs-lookup"><span data-stu-id="643f4-185">profile</span></span>

14. <span data-ttu-id="643f4-186">Accédez à **l’authentification.**</span><span class="sxs-lookup"><span data-stu-id="643f4-186">Navigate to **Authentication**.</span></span>

    <span data-ttu-id="643f4-187">Si une application n’a pas reçu le consentement de l’administrateur informatique, les utilisateurs doivent donner leur consentement la première fois qu’ils utilisent une application.</span><span class="sxs-lookup"><span data-stu-id="643f4-187">If an app has not been granted IT admin consent, users have to provide consent the first time they use an app.</span></span>

    <span data-ttu-id="643f4-188">Pour entrer un URI de redirection :</span><span class="sxs-lookup"><span data-stu-id="643f4-188">To enter a redirect URI:</span></span>
    * <span data-ttu-id="643f4-189">Sélectionnez **Ajouter une plateforme.**</span><span class="sxs-lookup"><span data-stu-id="643f4-189">Select **Add a platform**.</span></span>
    * <span data-ttu-id="643f4-190">Sélectionnez **web**.</span><span class="sxs-lookup"><span data-stu-id="643f4-190">Select **web**.</span></span>
    * <span data-ttu-id="643f4-191">Entrez **l’URI de redirection** de votre application.</span><span class="sxs-lookup"><span data-stu-id="643f4-191">Enter the **redirect URI** for your app.</span></span> <span data-ttu-id="643f4-192">Il s’agit de la page dans laquelle un flux d’octroi implicite réussi redirige l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="643f4-192">This is the page where a successful implicit grant flow redirects the user.</span></span> <span data-ttu-id="643f4-193">Il s’agit du même nom de domaine complet que celui que vous avez entré à l’étape 5, suivi de l’itinéraire d’API où une réponse d’authentification est envoyée.</span><span class="sxs-lookup"><span data-stu-id="643f4-193">This is the same fully qualified domain name that you entered in step 5 followed by the API route where an authentication response is sent.</span></span> <span data-ttu-id="643f4-194">Si vous êtes suivi de l’un des exemples Teams, il s’agit `https://subdomain.example.com/auth-end` de .</span><span class="sxs-lookup"><span data-stu-id="643f4-194">If you are following any of the Teams samples, this is `https://subdomain.example.com/auth-end`.</span></span>

    <span data-ttu-id="643f4-195">Activez l’octroi implicite en cochant les cases suivantes : ✔ ID de ✔'accès</span><span class="sxs-lookup"><span data-stu-id="643f4-195">Enable implicit grant by checking the following boxes: ✔ ID Token ✔ Access Token</span></span>

<span data-ttu-id="643f4-196">Félicitations !</span><span class="sxs-lookup"><span data-stu-id="643f4-196">Congratulations!</span></span> <span data-ttu-id="643f4-197">Vous avez rempli les conditions préalables à l’inscription de l’application pour poursuivre l’application d' ces onglets.</span><span class="sxs-lookup"><span data-stu-id="643f4-197">You have completed the app registration prerequisites to proceed with your tab SSO app.</span></span>

> [!NOTE]
>
> * <span data-ttu-id="643f4-198">¹ Si votre application AAD est inscrite dans le même client que celui où vous faites une demande d’authentification dans Teams, l’utilisateur ne peut pas être invité à donner son consentement et se voir accorder un jeton d’accès immédiatement.</span><span class="sxs-lookup"><span data-stu-id="643f4-198">¹ If your AAD app is registered in the same tenant where you are making an authentication request in Teams, the user cannot be asked to consent and is granted an access token right away.</span></span> <span data-ttu-id="643f4-199">Les utilisateurs consentent uniquement à ces autorisations si l’application AAD est inscrite dans un autre client.</span><span class="sxs-lookup"><span data-stu-id="643f4-199">Users only consent to these permissions if the AAD app is registered in a different tenant.</span></span>
> * <span data-ttu-id="643f4-200">² Si le domaine personnalisé n’est pas ajouté à AAD, vous obtenez une erreur indiquant que le nom d’hôte ne doit pas être basé sur un domaine déjà propriétaire.</span><span class="sxs-lookup"><span data-stu-id="643f4-200">² If the custom domain is not added to AAD, you get an error stating that the host name must not be based on an already owned domain.</span></span> <span data-ttu-id="643f4-201">Pour ajouter un domaine personnalisé à AAD et l’enregistrer, suivez la procédure d’ajout d’un nom de domaine personnalisé à [la procédure AAD,](/azure/active-directory/fundamentals/add-custom-domain) puis répétez l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="643f4-201">To add custom domain to AAD and register it, follow the [add a custom domain name to AAD](/azure/active-directory/fundamentals/add-custom-domain) procedure, and then repeat step 5.</span></span> <span data-ttu-id="643f4-202">Vous pouvez également obtenir cette erreur si vous n’êtes pas signé avec des informations d’identification d’administrateur dans la location Office 365.</span><span class="sxs-lookup"><span data-stu-id="643f4-202">You can also get this error if you are not signed in with Admin credentials in the Office 365 tenancy.</span></span>
> * <span data-ttu-id="643f4-203">Si vous ne recevez pas le nom d’utilisateur principal (UPN) dans le jeton d’accès renvoyé, vous pouvez l’ajouter en tant que revendication facultative [dans](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) AAD.</span><span class="sxs-lookup"><span data-stu-id="643f4-203">If you are not receiving the user principal name (UPN)) in the returned access token, you can add it as an [optional claim](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) in AAD.</span></span>

### <a name="2-update-your-teams-application-manifest"></a><span data-ttu-id="643f4-204">2. Mettre à jour le manifeste de votre application Teams</span><span class="sxs-lookup"><span data-stu-id="643f4-204">2. Update your Teams application manifest</span></span>

<span data-ttu-id="643f4-205">Utilisez le code suivant pour ajouter de nouvelles propriétés à votre manifeste Teams :</span><span class="sxs-lookup"><span data-stu-id="643f4-205">Use the following code to add new properties to your Teams manifest:</span></span>

```json
"webApplicationInfo": {
  "id": "00000000-0000-0000-0000-000000000000",
  "resource": "api://subdomain.example.com/00000000-0000-0000-0000-000000000000"
}
```

* <span data-ttu-id="643f4-206">**WebApplicationInfo** est le parent des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="643f4-206">**WebApplicationInfo** is the parent of the following elements:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="643f4-207">**id** : ID client de l’application.</span><span class="sxs-lookup"><span data-stu-id="643f4-207">**id** - The client ID of the application.</span></span> <span data-ttu-id="643f4-208">Il s’agit de l’ID d’application que vous avez obtenu dans le cadre de l’inscription de l’application auprès d’Azure AD.</span><span class="sxs-lookup"><span data-stu-id="643f4-208">This is the application ID that you obtained as part of registering the application with Azure AD.</span></span>
>* <span data-ttu-id="643f4-209">**ressource** : domaine et sous-domaine de votre application.</span><span class="sxs-lookup"><span data-stu-id="643f4-209">**resource** - The domain and subdomain of your application.</span></span> <span data-ttu-id="643f4-210">Il s’agit du même URI (y compris le protocole) que vous avez enregistré lors de la création de votre à `api://` `scope` l’étape 6.</span><span class="sxs-lookup"><span data-stu-id="643f4-210">This is the same URI (including the `api://` protocol) that you registered when creating your `scope` in step 6.</span></span> <span data-ttu-id="643f4-211">Vous ne devez pas inclure le `access_as_user` chemin d’accès dans votre ressource.</span><span class="sxs-lookup"><span data-stu-id="643f4-211">You must not include the `access_as_user` path in your resource.</span></span> <span data-ttu-id="643f4-212">La partie domaine de cet URI doit correspondre au domaine, y compris les sous-domaines, utilisés dans les URL de votre manifeste d’application Teams.</span><span class="sxs-lookup"><span data-stu-id="643f4-212">The domain part of this URI must match the domain, including any subdomains, used in the URLs of your Teams application manifest.</span></span>

> [!NOTE]
>
>* <span data-ttu-id="643f4-213">La ressource d’une application AAD est généralement la racine de son URL de site et de l’appID (par exemple, `api://subdomain.example.com/00000000-0000-0000-0000-000000000000` ).</span><span class="sxs-lookup"><span data-stu-id="643f4-213">The resource for an AAD app is usually the root of its site URL and the appID (e.g. `api://subdomain.example.com/00000000-0000-0000-0000-000000000000`).</span></span> <span data-ttu-id="643f4-214">Cette valeur est également utilisée pour vous assurer que votre demande est provenant du même domaine.</span><span class="sxs-lookup"><span data-stu-id="643f4-214">This value is also used to ensure your request is coming from the same domain.</span></span> <span data-ttu-id="643f4-215">Assurez-vous que `contentURL` l’onglet utilise les mêmes domaines que votre propriété de ressource.</span><span class="sxs-lookup"><span data-stu-id="643f4-215">Ensure that the `contentURL` for your tab uses the same domains as your resource property.</span></span>
>* <span data-ttu-id="643f4-216">Vous devez utiliser la version de manifeste 1.5 ou une version supérieure pour implémenter le `webApplicationInfo` champ.</span><span class="sxs-lookup"><span data-stu-id="643f4-216">You must use manifest version 1.5 or higher to implement the `webApplicationInfo` field.</span></span>

### <a name="3-get-an-authentication-token-from-your-client-side-code"></a><span data-ttu-id="643f4-217">3. Obtenir un jeton d’authentification à partir de votre code côté client</span><span class="sxs-lookup"><span data-stu-id="643f4-217">3. Get an authentication token from your client-side code</span></span>

<span data-ttu-id="643f4-218">Utilisez l’API d’authentification suivante :</span><span class="sxs-lookup"><span data-stu-id="643f4-218">Use the following authentication API:</span></span>

```javascript
var authTokenRequest = {
  successCallback: function(result) { console.log("Success: " + result); },
  failureCallback: function(error) { console.log("Failure: " + error); }
};
microsoftTeams.authentication.getAuthToken(authTokenRequest);
```

<span data-ttu-id="643f4-219">Lorsque vous appelez et que le consentement de l’utilisateur supplémentaire est requis pour les autorisations au niveau de l’utilisateur, une boîte de dialogue s’affiche pour accorder un `getAuthToken` consentement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="643f4-219">When you call `getAuthToken` - and additional user consent is required for user-level permissions, a dialog is shown to the user to grant additional consent.</span></span>

<span data-ttu-id="643f4-220">Après avoir reçu le jeton d’accès dans le rappel de réussite, vous pouvez décoder le jeton d’accès pour afficher les revendications associées à ce jeton.</span><span class="sxs-lookup"><span data-stu-id="643f4-220">After you receive the access token in the success callback, you can decode the access token to view the claims associated with that token.</span></span> <span data-ttu-id="643f4-221">Si vous le souhaitez, vous pouvez copier et coller manuellement le jeton d’accès dans un outil, par exemple jwt.ms [pour](https://jwt.ms/) inspecter son contenu.</span><span class="sxs-lookup"><span data-stu-id="643f4-221">Optionally, you can manually copy and paste the access token into a tool, such as [jwt.ms](https://jwt.ms/) to inspect its contents.</span></span> <span data-ttu-id="643f4-222">Si vous ne recevez pas l’UPN dans le jeton d’accès renvoyé, vous pouvez l’ajouter en tant que [revendication facultative](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) dans AAD.</span><span class="sxs-lookup"><span data-stu-id="643f4-222">If you are not receiving the UPN in the returned access token, you can add it as an [optional claim](https://docs.microsoft.com/azure/active-directory/develop/active-directory-optional-claims) in AAD.</span></span>

<p>
    <img src="~/assets/images/tabs/tabs-sso-prompt.png" alt="Tab single sign-on SSO dialog prompt" width="75%"/>
</p>

## <a name="code-sample"></a><span data-ttu-id="643f4-223">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="643f4-223">Code sample</span></span>

|<span data-ttu-id="643f4-224">**Exemple de nom**</span><span class="sxs-lookup"><span data-stu-id="643f4-224">**Sample name**</span></span>|<span data-ttu-id="643f4-225">**Description**</span><span class="sxs-lookup"><span data-stu-id="643f4-225">**Description**</span></span>|<span data-ttu-id="643f4-226">**C#**</span><span class="sxs-lookup"><span data-stu-id="643f4-226">**C#**</span></span>|<span data-ttu-id="643f4-227">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="643f4-227">**Node.js**</span></span>|
|---------------|---------------|------|--------------|
| <span data-ttu-id="643f4-228">SSO d’onglet</span><span class="sxs-lookup"><span data-stu-id="643f4-228">Tab SSO</span></span> |<span data-ttu-id="643f4-229">Exemple d’application Microsoft Teams pour les onglets Azure AD SSO</span><span class="sxs-lookup"><span data-stu-id="643f4-229">Microsoft Teams sample app for tabs Azure AD SSO</span></span>| [<span data-ttu-id="643f4-230">View</span><span class="sxs-lookup"><span data-stu-id="643f4-230">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/tab-sso/csharp)|<span data-ttu-id="643f4-231">[Affichage,](https://github.com/OfficeDev/Microsoft-Teams-Samples/blob/main/samples/tab-sso/nodejs)</span><span class="sxs-lookup"><span data-stu-id="643f4-231">[View](https://github.com/OfficeDev/Microsoft-Teams-Samples/blob/main/samples/tab-sso/nodejs),</span></span> </br>[<span data-ttu-id="643f4-232">Équipes Shared Computer Toolkit</span><span class="sxs-lookup"><span data-stu-id="643f4-232">Teams Toolkit</span></span>](../../../toolkit/visual-studio-code-tab-sso.md)|

## <a name="known-limitations"></a><span data-ttu-id="643f4-233">Limitations connues</span><span class="sxs-lookup"><span data-stu-id="643f4-233">Known limitations</span></span>

### <a name="apps-that-require-additional-graph-scopes"></a><span data-ttu-id="643f4-234">Applications nécessitant des étendues Graph supplémentaires</span><span class="sxs-lookup"><span data-stu-id="643f4-234">Apps that require additional Graph scopes</span></span>

<span data-ttu-id="643f4-235">Notre implémentation actuelle pour l' utilisateur unique accorde uniquement le consentement pour les autorisations au niveau de l’utilisateur ( e-mail, profil, offline_access, OpenId et non pour d’autres API telles que User.Read ou Mail.Read).</span><span class="sxs-lookup"><span data-stu-id="643f4-235">Our current implementation for SSO only grants consent for user-level permissions that is email, profile, offline_access, OpenId and not for other APIs such as User.Read or Mail.Read.</span></span> <span data-ttu-id="643f4-236">Si votre application a besoin d’étendues Graph supplémentaires, la section suivante fournit des solutions de contournement.</span><span class="sxs-lookup"><span data-stu-id="643f4-236">If your app needs further Graph scopes, the next section provides some enabling workarounds.</span></span>

#### <a name="tenant-admin-consent"></a><span data-ttu-id="643f4-237">Consentement de l’administrateur client</span><span class="sxs-lookup"><span data-stu-id="643f4-237">Tenant Admin Consent</span></span>

<span data-ttu-id="643f4-238">L’approche la plus simple consiste à obtenir le consentement préalable d’un administrateur client au nom de l’organisation.</span><span class="sxs-lookup"><span data-stu-id="643f4-238">The simplest approach is to get a tenant admin to pre-consent on behalf of the organization.</span></span> <span data-ttu-id="643f4-239">Cela signifie que les utilisateurs n’ont pas à consentir à ces étendues et [](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow)que vous pouvez ensuite être libre d’échanger le côté serveur de jetons à l’aide du flux de la part d’AAD.</span><span class="sxs-lookup"><span data-stu-id="643f4-239">This means users do not have to consent to these scopes and you can then be free to exchange the token server side using AAD’s [on-behalf-of flow](/azure/active-directory/develop/v1-oauth2-on-behalf-of-flow).</span></span> <span data-ttu-id="643f4-240">Cette solution de contournement est acceptable pour les applications métier internes, mais elle n’est pas suffisante pour les développeurs tiers qui ne peuvent pas compter sur l’approbation de l’administrateur client.</span><span class="sxs-lookup"><span data-stu-id="643f4-240">This workaround is acceptable for internal line-of-business applications but is not enough for third-party developers who are not able to rely on tenant admin approval.</span></span>

<span data-ttu-id="643f4-241">Une méthode simple de consentement pour le compte d’une organisation en tant qu’administrateur client consiste à faire référence à `https://login.microsoftonline.com/common/adminconsent?client_id=<AAD_App_ID>` .</span><span class="sxs-lookup"><span data-stu-id="643f4-241">A simple way of consenting on behalf of an organization as a tenant admin is to refer to `https://login.microsoftonline.com/common/adminconsent?client_id=<AAD_App_ID>`.</span></span>

#### <a name="ask-for-additional-consent-using-the-auth-api"></a><span data-ttu-id="643f4-242">Demander un consentement supplémentaire à l’aide de l’API Auth</span><span class="sxs-lookup"><span data-stu-id="643f4-242">Ask for additional consent using the Auth API</span></span>

<span data-ttu-id="643f4-243">Une autre approche pour obtenir des étendues Graph supplémentaires consiste à présenter une boîte de dialogue de consentement à l’aide de notre approche d’authentification [Azure AD](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) basée sur le web existante qui implique l’obtention d’une boîte de dialogue de consentement Azure AD.</span><span class="sxs-lookup"><span data-stu-id="643f4-243">Another approach for getting additional Graph scopes is to present a consent dialog using our existing [web-based Azure AD authentication approach](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page) which involves popping up an Azure AD consent dialog box.</span></span> 

<span data-ttu-id="643f4-244">**Pour demander un consentement supplémentaire à l’aide de l’API Auth**</span><span class="sxs-lookup"><span data-stu-id="643f4-244">**To ask for additional consent using the Auth API**</span></span>

1. <span data-ttu-id="643f4-245">Le jeton récupéré à l’aide doit être échangé côté serveur à l’aide du flux AAD de la part de pour accéder à ces API `getAuthToken()` Graph supplémentaires. [](/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow)</span><span class="sxs-lookup"><span data-stu-id="643f4-245">The token retrieved using `getAuthToken()` needs to be exchanged server-side using AAD [on-behalf-of flow](/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow) to get access to those additional Graph APIs.</span></span> <span data-ttu-id="643f4-246">Assurez-vous d’utiliser le point de terminaison Graph v2 pour cet échange.</span><span class="sxs-lookup"><span data-stu-id="643f4-246">Ensure you use the v2 Graph endpoint for this exchange.</span></span>
2. <span data-ttu-id="643f4-247">Si l’échange échoue, AAD renvoie une exception d’octroi non valide.</span><span class="sxs-lookup"><span data-stu-id="643f4-247">If the exchange fails, AAD returns an invalid grant exception.</span></span> <span data-ttu-id="643f4-248">Il existe généralement l’un des deux messages `invalid_grant` d’erreur, ou `interaction_required` .</span><span class="sxs-lookup"><span data-stu-id="643f4-248">There are usually one of two error messages, `invalid_grant` or `interaction_required`.</span></span>
3. <span data-ttu-id="643f4-249">En cas d’échec de l’échange, vous devez demander un consentement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="643f4-249">When the exchange fails, you must ask for additional consent.</span></span> <span data-ttu-id="643f4-250">Affichez une interface utilisateur (IU) demandant à l’utilisateur d’accorder un consentement supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="643f4-250">Show some user interface (UI) asking the user to grant additional consent.</span></span> <span data-ttu-id="643f4-251">Cette interface utilisateur doit inclure un bouton qui déclenche une boîte de dialogue de consentement AAD à l’aide de notre [API d’authentification AAD.](~/concepts/authentication/auth-silent-aad.md)</span><span class="sxs-lookup"><span data-stu-id="643f4-251">This UI must include a button that triggers an AAD consent dialog box using our [AAD authentication API](~/concepts/authentication/auth-silent-aad.md).</span></span>
4. <span data-ttu-id="643f4-252">Lorsque vous demandez le consentement supplémentaire d’AAD, vous devez inclure dans votre paramètre de chaîne de requête à AAD, sinon AAD ne demande pas les `prompt=consent` étendues supplémentaires. [](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context)</span><span class="sxs-lookup"><span data-stu-id="643f4-252">When asking for additional consent from AAD, you must include `prompt=consent` in your [query-string-parameter](~/tabs/how-to/authentication/auth-silent-aad.md#get-the-user-context) to AAD, otherwise AAD does not ask for the additional scopes.</span></span>
    * <span data-ttu-id="643f4-253">Au lieu de `?scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="643f4-253">Instead of `?scope={scopes}`</span></span>
    * <span data-ttu-id="643f4-254">Utilisez cette `?prompt=consent&scope={scopes}`</span><span class="sxs-lookup"><span data-stu-id="643f4-254">Use this `?prompt=consent&scope={scopes}`</span></span>
    * <span data-ttu-id="643f4-255">Assurez-vous qu’il inclut toutes les étendues que vous invitez à l’utilisateur, par `{scopes}` exemple, Mail.Read ou User.Read.</span><span class="sxs-lookup"><span data-stu-id="643f4-255">Ensure that `{scopes}` includes all the scopes you are prompting the user for, for example, Mail.Read or User.Read.</span></span>
5. <span data-ttu-id="643f4-256">Une fois que l’utilisateur a accordé des autorisations supplémentaires, réessayez le flux « de la part de » pour accéder à ces API supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="643f4-256">Once the user has granted additional permission, retry the on-behalf-of-flow to get access to these additional APIs.</span></span>

### <a name="non-aad-authentication"></a><span data-ttu-id="643f4-257">Authentification non-AAD</span><span class="sxs-lookup"><span data-stu-id="643f4-257">Non-AAD authentication</span></span>

<span data-ttu-id="643f4-258">La solution d’authentification décrite ci-dessus fonctionne uniquement pour les applications et services qui utilisent AAD en tant que fournisseur d’identité.</span><span class="sxs-lookup"><span data-stu-id="643f4-258">The above-described authentication solution only works for apps and services that support AAD as an identity provider.</span></span> <span data-ttu-id="643f4-259">Les applications qui souhaitent s’authentifier à l’aide de services non basés sur AAD doivent continuer à utiliser le flux d’authentification web basé sur les fenêtres [pop-up.](~/concepts/authentication.md)</span><span class="sxs-lookup"><span data-stu-id="643f4-259">Apps that want to authenticate using non-AAD based services must continue using the pop-up-based [web authentication flow](~/concepts/authentication.md).</span></span>

> [!NOTE]
> <span data-ttu-id="643f4-260">L’ation SSO est prise en charge pour les applications du client au sein des clients AAD B2C.</span><span class="sxs-lookup"><span data-stu-id="643f4-260">SSO is supported for customer owned apps within the AAD B2C tenants.</span></span>
