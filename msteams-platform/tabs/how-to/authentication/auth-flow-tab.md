---
title: Flux d’authentification pour les onglets
description: Décrit le flux d’authentification dans les onglets
keywords: onglets de flux d’authentification des équipes
ms.openlocfilehash: 6c669162f407924f0844b89625f5c5791e96b6f7
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/01/2020
ms.locfileid: "41673790"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="659d0-104">Flux d’authentification Microsoft teams pour les onglets</span><span class="sxs-lookup"><span data-stu-id="659d0-104">Microsoft Teams authentication flow for tabs</span></span>

> [!Note]
> <span data-ttu-id="659d0-105">Pour que l’authentification fonctionne pour votre onglet sur les clients mobiles, vous devez vous assurer que vous utilisez au moins la version 1.4.1 du kit de développement logiciel (SDK) JavaScript Teams.</span><span class="sxs-lookup"><span data-stu-id="659d0-105">For authentication to work for your tab on mobile clients, you need to ensure you're using at least the 1.4.1 version of the Teams JavaScript SDK.</span></span>

<span data-ttu-id="659d0-106">OAuth 2,0 est une norme ouverte pour l’authentification et l’autorisation utilisées par Azure AD et de nombreux autres fournisseurs d’identité.</span><span class="sxs-lookup"><span data-stu-id="659d0-106">OAuth 2.0 is an open standard for authentication and authorization used by Azure AD and many other identity providers.</span></span> <span data-ttu-id="659d0-107">Une compréhension de base de OAuth 2,0 est une condition préalable à l’utilisation de l’authentification dans teams ; [Voici une bonne présentation](https://aaronparecki.com/oauth-2-simplified/) qui est plus facile à suivre que les [spécifications formelles](https://oauth.net/2/).</span><span class="sxs-lookup"><span data-stu-id="659d0-107">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams; [here's a good overview](https://aaronparecki.com/oauth-2-simplified/) that's easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="659d0-108">Le flux d’authentification pour les onglets et les robots est un peu différent, car les onglets sont très similaires aux sites Web afin qu’ils puissent utiliser OAuth 2,0 directement ; les robots ne sont pas et doivent effectuer quelques opérations différemment, mais les concepts de base sont identiques.</span><span class="sxs-lookup"><span data-stu-id="659d0-108">Authentication flow for tabs and bots are a little different because tabs are very similar to websites so they can use OAuth 2.0 directly; bots are not and must do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="659d0-109">pour obtenir un exemple illustrant le flux d’authentification des onglets et des bots à l’aide du nœud utilisant le [type d’autorisation implicite OAuth 2,0](https://oauth.net/2/grant-types/implicit/).</span><span class="sxs-lookup"><span data-stu-id="659d0-109">for an example that demonstrates authentication flow for tabs and bots using Node using the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/).</span></span>

![Diagramme de séquence d’authentification d’onglet](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="659d0-111">L’utilisateur interagit avec le contenu de la page de configuration ou de contenu de l’onglet, généralement un bouton intitulé « se connecter » ou « se connecter ».</span><span class="sxs-lookup"><span data-stu-id="659d0-111">The user interacts with the content on the tab configuration or content page, commonly a button labeled "Sign in" or "Log in".</span></span>
2. <span data-ttu-id="659d0-112">L’onglet construit l’URL pour sa page de démarrage d’authentification, en utilisant éventuellement les informations des espaces réservés d’URL `microsoftTeams.getContext()` ou en appelant teams Client SDK Method afin de rationaliser l’expérience d’authentification pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="659d0-112">The tab constructs the URL for its auth start page, optionally using information from URL placeholders or by calling `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="659d0-113">Par exemple, lors de l’authentification auprès d’Azure AD `login_hint` , si le paramètre est défini sur l’adresse e-mail de l’utilisateur, il est possible que l’utilisateur ne doive pas se connecter si cela a été fait récemment, car Azure ad utilise les informations d’identification mises en cache de l’utilisateur si cela est possible : le menu contextuel clignote brièvement, puis disparaît.</span><span class="sxs-lookup"><span data-stu-id="659d0-113">For example, when authenticating with Azure AD, if the `login_hint` parameter is set to the user's email address, the user may not even have to sign in if they have done so recently, because Azure AD will use the user's cached credentials if possible: the popup will flash briefly and then disappear.</span></span>
3. <span data-ttu-id="659d0-114">L’onglet appelle ensuite la `microsoftTeams.authentication.authenticate()` méthode et enregistre les `successCallback` fonctions et `failureCallback` .</span><span class="sxs-lookup"><span data-stu-id="659d0-114">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="659d0-115">Teams ouvre la page de démarrage dans un IFRAME dans une fenêtre contextuelle.</span><span class="sxs-lookup"><span data-stu-id="659d0-115">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="659d0-116">La page de démarrage génère `state` des données aléatoires, les enregistre pour une validation ultérieure et les redirige vers le `/authorize` point de terminaison `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` du fournisseur d’identité, par exemple pour Azure ad.</span><span class="sxs-lookup"><span data-stu-id="659d0-116">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="659d0-117">Remplacez `<tenant id>` par votre propre ID de client (Context. TID).</span><span class="sxs-lookup"><span data-stu-id="659d0-117">Replace `<tenant id>` with your own tenant id (context.tid).</span></span>
    * <span data-ttu-id="659d0-118">Comme les autres flux d’authentification d’application dans Teams, la page de démarrage doit se trouver sur `validDomains` un domaine de sa liste et sur le même domaine que la page de redirection post-connexion.</span><span class="sxs-lookup"><span data-stu-id="659d0-118">Like other application auth flows in Teams, the start page must be on a domain that's in its `validDomains` list, and on the same domain as the post-login redirect page.</span></span>
    * <span data-ttu-id="659d0-119">**Important**: les appels de flux d’octroi implicite OAuth `state` 2,0 pour un paramètre dans la demande d’authentification qui contient des données de session uniques pour empêcher une [attaque de contrefaçon de demande intersite](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span><span class="sxs-lookup"><span data-stu-id="659d0-119">**IMPORTANT**: The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="659d0-120">Les exemples ci-dessous utilisent un GUID généré de manière aléatoire `state` pour les données.</span><span class="sxs-lookup"><span data-stu-id="659d0-120">The examples below use a randomly-generated GUID for the `state` data.</span></span>
5. <span data-ttu-id="659d0-121">Sur le site du fournisseur, l’utilisateur se connecte et autorise l’accès à l’onglet.</span><span class="sxs-lookup"><span data-stu-id="659d0-121">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="659d0-122">Le fournisseur dirige l’utilisateur vers la page de redirection OAuth 2,0 de l’onglet avec un jeton d’accès.</span><span class="sxs-lookup"><span data-stu-id="659d0-122">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="659d0-123">L’onglet vérifie que la valeur `state` renvoyée correspond à ce qui a été enregistré `microsoftTeams.authentication.notifySuccess()`précédemment, et appelle, qui `successCallback` appelle à son tour la fonction inscrite à l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="659d0-123">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="659d0-124">Teams ferme la fenêtre contextuelle.</span><span class="sxs-lookup"><span data-stu-id="659d0-124">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="659d0-125">L’onglet affiche l’interface utilisateur de configuration ou actualise ou recharge le contenu des onglets, selon l’emplacement à partir duquel l’utilisateur a démarré.</span><span class="sxs-lookup"><span data-stu-id="659d0-125">The tab either displays configuration UI or refreshes or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="659d0-126">Considérer le contexte de l’onglet comme des conseils</span><span class="sxs-lookup"><span data-stu-id="659d0-126">Treat tab context as hints</span></span>

<span data-ttu-id="659d0-127">Bien que le contexte d’onglet fournit des informations utiles sur l’utilisateur, n’utilisez pas ces informations pour authentifier l’utilisateur, que vous l’obteniez comme paramètres d’URL de `microsoftTeams.getContext()` votre URL de contenu de tabulation ou en appelant la fonction dans le kit de développement logiciel (SDK) du client Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="659d0-127">Although the tab context provides useful information regarding the user, don't use this information to authenticate the user whether you get it as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="659d0-128">Un acteur malveillant peut appeler votre URL de contenu de tabulation avec ses propres paramètres, et une page Web qui emprunte l’identité de Microsoft teams pourrait charger votre URL de contenu d’onglet dans `getContext()` un IFRAME et renvoyer ses propres données à la fonction.</span><span class="sxs-lookup"><span data-stu-id="659d0-128">A malicious actor could invoke your tab content URL with its own parameters, and a web page impersonating Microsoft Teams could load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="659d0-129">Vous devez traiter les informations relatives à l’identité dans le contexte de l’onglet simplement comme des conseils et les valider avant de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="659d0-129">You should treat the identity-related information in the tab context simply as hints and validate them before use.</span></span>

## <a name="samples"></a><span data-ttu-id="659d0-130">Exemples</span><span class="sxs-lookup"><span data-stu-id="659d0-130">Samples</span></span>

<span data-ttu-id="659d0-131">Pour obtenir un exemple de code illustrant le processus d’authentification par onglet, voir :</span><span class="sxs-lookup"><span data-stu-id="659d0-131">For sample code showing the tab authentication process see:</span></span>

* [<span data-ttu-id="659d0-132">Exemple d’authentification de l’onglet Microsoft Teams (nœud)</span><span class="sxs-lookup"><span data-stu-id="659d0-132">Microsoft Teams tab authentication sample (Node)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-node)
* [<span data-ttu-id="659d0-133">Exemple d’authentification de l’onglet Microsoft Teams (C#)</span><span class="sxs-lookup"><span data-stu-id="659d0-133">Microsoft Teams tab authentication sample (C#)</span></span>](https://github.com/OfficeDev/microsoft-teams-sample-complete-csharp)

## <a name="more-details"></a><span data-ttu-id="659d0-134">Plus de détails</span><span class="sxs-lookup"><span data-stu-id="659d0-134">More details</span></span>

<span data-ttu-id="659d0-135">Pour obtenir une description détaillée de l’implémentation de l’authentification d’onglet pour Azure Active Directory, voir :</span><span class="sxs-lookup"><span data-stu-id="659d0-135">For a detailed implementation walkthrough for tab authentication targeting Azure Active Directory see:</span></span>

* [<span data-ttu-id="659d0-136">Authentifier un utilisateur sous un onglet Microsoft teams</span><span class="sxs-lookup"><span data-stu-id="659d0-136">Authenticate a user in a Microsoft Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="659d0-137">Authentification en mode silencieux</span><span class="sxs-lookup"><span data-stu-id="659d0-137">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
