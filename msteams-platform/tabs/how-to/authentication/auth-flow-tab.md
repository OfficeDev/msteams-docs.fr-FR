---
title: Flux d’authentification pour onglets
description: Décrit le flux d’authentification dans les onglets
ms.topic: conceptual
localization_priority: Normal
keywords: onglets de flux d’authentification des équipes
ms.openlocfilehash: 1282c149beba0ff5b424585f566a703f48234fa2
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566690"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="78129-104">Microsoft Teams d’authentification pour les onglets</span><span class="sxs-lookup"><span data-stu-id="78129-104">Microsoft Teams authentication flow for tabs</span></span>

> [!NOTE]
> <span data-ttu-id="78129-105">Pour que l’authentification fonctionne pour votre onglet sur les clients mobiles, vous devez vous assurer que vous utilisez au moins 1.4.1 version de la Microsoft Teams JavaScript SDK.</span><span class="sxs-lookup"><span data-stu-id="78129-105">For authentication to work for your tab on mobile clients, you must ensure you are using at least 1.4.1 version of the Microsoft Teams JavaScript SDK.</span></span>
> <span data-ttu-id="78129-106">Teams SDK lance une fenêtre séparée pour le flux d’authentification.</span><span class="sxs-lookup"><span data-stu-id="78129-106">Teams SDK launches separate window for authentication flow.</span></span> <span data-ttu-id="78129-107">Définissez `SameSite` l’attribut **de Lax**.</span><span class="sxs-lookup"><span data-stu-id="78129-107">Set the `SameSite` attribute to **Lax**.</span></span> <span data-ttu-id="78129-108">Teams client de bureau ou les anciennes versions de Chrome ou Safari ne supportent `SameSite` pas =None.</span><span class="sxs-lookup"><span data-stu-id="78129-108">Teams desktop client or older versions of Chrome or Safari do not support `SameSite`=None.</span></span>

<span data-ttu-id="78129-109">OAuth 2.0 est une norme ouverte pour l’authentification et l’autorisation utilisées par Azure Active Directory (AAD) et de nombreux autres fournisseurs d’identité.</span><span class="sxs-lookup"><span data-stu-id="78129-109">OAuth 2.0 is an open standard for authentication and authorization used by Azure Active Directory (AAD) and many other identity providers.</span></span> <span data-ttu-id="78129-110">Une compréhension de base d’OAuth 2.0 est une condition préalable pour travailler avec l’authentification Teams.</span><span class="sxs-lookup"><span data-stu-id="78129-110">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams.</span></span> <span data-ttu-id="78129-111">Pour plus d’informations, [voir OAuth 2 simplifié](https://aaronparecki.com/oauth-2-simplified/) qui est plus facile à suivre que [la spécification formelle](https://oauth.net/2/).</span><span class="sxs-lookup"><span data-stu-id="78129-111">For more information, see [OAuth 2 simplified](https://aaronparecki.com/oauth-2-simplified/) that is easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="78129-112">Le flux d’authentification pour les onglets et les bots est différent parce que les onglets sont similaires aux sites Web afin qu’ils puissent utiliser OAuth 2.0 directement.</span><span class="sxs-lookup"><span data-stu-id="78129-112">Authentication flow for tabs and bots are different because tabs are similar to websites so they can use OAuth 2.0 directly.</span></span> <span data-ttu-id="78129-113">Les bots font quelques choses différemment, mais les concepts de base sont identiques.</span><span class="sxs-lookup"><span data-stu-id="78129-113">Bots do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="78129-114">Pour un exemple de flux d’authentification pour les onglets et les bots utilisant nœud et le type de subvention implicite [OAuth 2.0](https://oauth.net/2/grant-types/implicit/), voir [lancer le flux d’authentification pour les onglets](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow).</span><span class="sxs-lookup"><span data-stu-id="78129-114">For an example of authentication flow for tabs and bots using Node and the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/), see [initiate authentication flow for tabs](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow).</span></span>

> [!NOTE]
> <span data-ttu-id="78129-115">Avant **d’afficher un bouton de** connexion à l’utilisateur et `microsoftTeams.authentication.authenticate` d’appeler l’API en réponse à la sélection du bouton, vous devez attendre la paracénalisation SDK pour terminer.</span><span class="sxs-lookup"><span data-stu-id="78129-115">Before showing a **Login** button to the user and calling the `microsoftTeams.authentication.authenticate` API in response to selecting the button, you must wait for the SDK initialization to complete.</span></span> <span data-ttu-id="78129-116">Vous pouvez transmettre un rappel à `microsoftTeams.initialize` l’API qui est appelé lorsque l’initialisation se termine.</span><span class="sxs-lookup"><span data-stu-id="78129-116">You can pass a callback to the `microsoftTeams.initialize` API that is called when initialization completes.</span></span>

![Diagramme de séquence d’authentification d’onglet](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="78129-118">L’utilisateur interagit avec le contenu de la configuration de l’onglet ou de la page de contenu, généralement **un bouton Connexion** ou **Connexion.**</span><span class="sxs-lookup"><span data-stu-id="78129-118">The user interacts with the content on the tab configuration or content page, commonly a **Sign in** or **Log in** button.</span></span>
2. <span data-ttu-id="78129-119">L’onglet construit l’URL de sa page de démarrage auth.</span><span class="sxs-lookup"><span data-stu-id="78129-119">The tab constructs the URL for its auth start page.</span></span> <span data-ttu-id="78129-120">En option, il utilise les informations des espaces réservés url ou `microsoftTeams.getContext()` des appels Teams client SDK méthode pour rationaliser l’expérience d’authentification pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="78129-120">Optionally, it uses information from URL placeholders or calls `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="78129-121">Par exemple, lors de l’authentification avec AAD, si `login_hint` le paramètre est défini sur l’adresse e-mail de l’utilisateur, l’utilisateur n’a pas à se connecter s’il l’a fait récemment.</span><span class="sxs-lookup"><span data-stu-id="78129-121">For example, when authenticating with AAD, if the `login_hint` parameter is set to the user's email address, the user does not have to sign in if they have done so recently.</span></span> <span data-ttu-id="78129-122">C’est parce qu’AAD utilise les informations d’identification mises en cache de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="78129-122">This is because AAD uses the user's cached credentials.</span></span> <span data-ttu-id="78129-123">La fenêtre contextée est affichée brièvement, puis disparaît.</span><span class="sxs-lookup"><span data-stu-id="78129-123">The pop-up window is shown briefly and then disappears.</span></span>
3. <span data-ttu-id="78129-124">L’onglet appelle ensuite la méthode `microsoftTeams.authentication.authenticate()` et inscrit les fonctions `successCallback` et `failureCallback`.</span><span class="sxs-lookup"><span data-stu-id="78129-124">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="78129-125">Teams ouvre la page de démarrage dans un iframe dans une fenêtre contextée.</span><span class="sxs-lookup"><span data-stu-id="78129-125">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="78129-126">La page de démarrage génère des `state` données aléatoires, les enregistre pour validation future et redirige vers le point de `/authorize` terminaison du fournisseur `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` d’identité, comme pour Azure AD.</span><span class="sxs-lookup"><span data-stu-id="78129-126">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint, such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="78129-127">Remplacez `<tenant id>` par votre propre id locataire qui est context.tid.</span><span class="sxs-lookup"><span data-stu-id="78129-127">Replace `<tenant id>` with your own tenant id that is context.tid.</span></span>
<span data-ttu-id="78129-128">Comme pour les autres flux d’auth d’application en Teams, la page de démarrage doit être sur un domaine qui est dans `validDomains` sa liste, et sur le même domaine que le signe de poste dans la page de redirection.</span><span class="sxs-lookup"><span data-stu-id="78129-128">Similar to other application auth flows in Teams, the start page must be on a domain that is in its `validDomains` list, and on the same domain as the post sign in redirect page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="78129-129">Le flux implicite de subvention oAuth 2.0 nécessite un `state` paramètre dans la demande d’authentification, qui contient des données de session uniques pour empêcher [une attaque de contrefaçon de demande inter-sites.](https://en.wikipedia.org/wiki/Cross-site_request_forgery)</span><span class="sxs-lookup"><span data-stu-id="78129-129">The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request, which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="78129-130">Les exemples utilisent un GUID généré au hasard pour les `state` données.</span><span class="sxs-lookup"><span data-stu-id="78129-130">The examples use a randomly-generated GUID for the `state` data.</span></span>

5. <span data-ttu-id="78129-131">Sur le site du fournisseur, l’utilisateur se s’insurde et donne accès à l’onglet.</span><span class="sxs-lookup"><span data-stu-id="78129-131">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="78129-132">Le fournisseur emmène l’utilisateur à la page de redirection OAuth 2.0 de l’onglet avec un jeton d’accès.</span><span class="sxs-lookup"><span data-stu-id="78129-132">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="78129-133">L’onglet vérifie que la valeur retournée `state` correspond à ce qui a été enregistré précédemment, et les appels , qui à son tour appelle la fonction enregistrée à `microsoftTeams.authentication.notifySuccess()` `successCallback` l’étape 3.</span><span class="sxs-lookup"><span data-stu-id="78129-133">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="78129-134">Teams ferme la fenêtre pop-up.</span><span class="sxs-lookup"><span data-stu-id="78129-134">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="78129-135">L’onglet affiche l’interface utilisateur de configuration, actualise ou recharge le contenu des onglets, selon l’endroit d’où l’utilisateur a commencé.</span><span class="sxs-lookup"><span data-stu-id="78129-135">The tab either displays configuration UI, refreshes, or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="78129-136">Traiter le contexte de l’onglet comme des indices</span><span class="sxs-lookup"><span data-stu-id="78129-136">Treat tab context as hints</span></span>

<span data-ttu-id="78129-137">Bien que le contexte de l’onglet fournit des informations utiles concernant l’utilisateur, n’utilisez pas ces informations pour authentifier l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="78129-137">Although the tab context provides helpful information regarding the user, do not use this information to authenticate the user.</span></span> <span data-ttu-id="78129-138">Authentifiez l’utilisateur même si vous obtenez les informations en tant que paramètres URL de votre URL de contenu d’onglet ou `microsoftTeams.getContext()` en appelant la fonction dans Microsoft Teams client SDK.</span><span class="sxs-lookup"><span data-stu-id="78129-138">Do authenticate the user even if you get the information as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="78129-139">Un acteur malveillant peut invoquer votre URL de contenu d’onglet avec ses propres paramètres.</span><span class="sxs-lookup"><span data-stu-id="78129-139">A malicious actor can invoke your tab content URL with its own parameters.</span></span> <span data-ttu-id="78129-140">L’acteur peut également invoquer une page Web se faisant passer pour Microsoft Teams pour charger votre URL de contenu d’onglet dans un iframe et retourner ses propres données à la `getContext()` fonction.</span><span class="sxs-lookup"><span data-stu-id="78129-140">The actor can also invoke a web page impersonating Microsoft Teams to load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="78129-141">Vous devez traiter les informations liées à l’identité dans le contexte de l’onglet simplement comme des indices et les valider avant utilisation.</span><span class="sxs-lookup"><span data-stu-id="78129-141">You must treat the identity-related information in the tab context simply as hints and validate them before use.</span></span> <span data-ttu-id="78129-142">Référez-vous aux notes dans [naviguer vers la page d’autorisation de votre page pop-up](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span><span class="sxs-lookup"><span data-stu-id="78129-142">Refer to the notes in [navigate to the authorization page from your pop-up page](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span></span>

## <a name="code-sample"></a><span data-ttu-id="78129-143">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="78129-143">Code sample</span></span>

<span data-ttu-id="78129-144">Exemple de code montrant le processus d’authentification de l’onglet :</span><span class="sxs-lookup"><span data-stu-id="78129-144">Sample code showing the tab authentication process:</span></span>

| <span data-ttu-id="78129-145">**Nom de l’échantillon**</span><span class="sxs-lookup"><span data-stu-id="78129-145">**Sample name**</span></span> | <span data-ttu-id="78129-146">**Description**</span><span class="sxs-lookup"><span data-stu-id="78129-146">**Description**</span></span> | <span data-ttu-id="78129-147">**C#**</span><span class="sxs-lookup"><span data-stu-id="78129-147">**C#**</span></span> | <span data-ttu-id="78129-148">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="78129-148">**Node.js**</span></span> |
|-----------------|-----------------|-------------|------------|
| <span data-ttu-id="78129-149">Teams’authentification de l’onglet</span><span class="sxs-lookup"><span data-stu-id="78129-149">Teams tab authentication</span></span> | <span data-ttu-id="78129-150">Processus d’authentification pour les onglets utilisant AAD.</span><span class="sxs-lookup"><span data-stu-id="78129-150">Authentication process for tabs using AAD.</span></span> | [<span data-ttu-id="78129-151">View</span><span class="sxs-lookup"><span data-stu-id="78129-151">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/csharp) | [<span data-ttu-id="78129-152">View</span><span class="sxs-lookup"><span data-stu-id="78129-152">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/nodejs) |

## <a name="more-details"></a><span data-ttu-id="78129-153">Plus de détails</span><span class="sxs-lookup"><span data-stu-id="78129-153">More details</span></span>

<span data-ttu-id="78129-154">Pour une implémentation détaillée pour l’authentification des onglets à l’aide d’AAD, voir :</span><span class="sxs-lookup"><span data-stu-id="78129-154">For a detailed implementation for tab authentication using AAD, see:</span></span>

* [<span data-ttu-id="78129-155">Authentifier un utilisateur dans un onglet Teams’utilisateur</span><span class="sxs-lookup"><span data-stu-id="78129-155">Authenticate a user in a Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="78129-156">Authentification en mode silencieux</span><span class="sxs-lookup"><span data-stu-id="78129-156">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
