---
title: Flux d'authentification pour les onglets
description: Décrit le flux d'authentification dans les onglets
ms.topic: conceptual
localization_priority: Normal
keywords: Onglets de flux d'authentification Teams
ms.openlocfilehash: 012e38b0fa689527999237ccc07b7352fc00ae71
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020393"
---
# <a name="microsoft-teams-authentication-flow-for-tabs"></a><span data-ttu-id="ba958-104">Flux d'authentification Microsoft Teams pour les onglets</span><span class="sxs-lookup"><span data-stu-id="ba958-104">Microsoft Teams authentication flow for tabs</span></span>

> [!NOTE]
> <span data-ttu-id="ba958-105">Pour que l'authentification fonctionne pour votre onglet sur les clients mobiles, vous devez vous assurer que vous utilisez au moins la version 1.4.1 du SDK JavaScript Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="ba958-105">For authentication to work for your tab on mobile clients, you must ensure you are using at least 1.4.1 version of the Microsoft Teams JavaScript SDK.</span></span>
> <span data-ttu-id="ba958-106">Le SDK Teams lance une fenêtre distincte pour le flux d'authentification.</span><span class="sxs-lookup"><span data-stu-id="ba958-106">Teams SDK launches separate window for authentication flow.</span></span> <span data-ttu-id="ba958-107">Définissez `SameSite` l'attribut **sur Lax**.</span><span class="sxs-lookup"><span data-stu-id="ba958-107">Set the `SameSite` attribute to **Lax**.</span></span> <span data-ttu-id="ba958-108">Le client de bureau Teams ou les versions antérieures de Chrome ou Safari ne sont pas en charge `SameSite` = Aucun.</span><span class="sxs-lookup"><span data-stu-id="ba958-108">Teams desktop client or older versions of Chrome or Safari do not support `SameSite`=None.</span></span>

<span data-ttu-id="ba958-109">OAuth 2.0 est une norme ouverte d'authentification et d'autorisation utilisée par Azure Active Directory (AAD) et de nombreux autres fournisseurs d'identité.</span><span class="sxs-lookup"><span data-stu-id="ba958-109">OAuth 2.0 is an open standard for authentication and authorization used by Azure Active Directory (AAD) and many other identity providers.</span></span> <span data-ttu-id="ba958-110">Une compréhension de base d'OAuth 2.0 est une condition préalable à l'utilisation de l'authentification dans Teams.</span><span class="sxs-lookup"><span data-stu-id="ba958-110">A basic understanding of OAuth 2.0 is a prerequisite for working with authentication in Teams.</span></span> <span data-ttu-id="ba958-111">Pour plus d'informations, [voir OAuth 2 simplifié](https://aaronparecki.com/oauth-2-simplified/) qui est plus facile à suivre que la [spécification formelle](https://oauth.net/2/).</span><span class="sxs-lookup"><span data-stu-id="ba958-111">For more information, see [OAuth 2 simplified](https://aaronparecki.com/oauth-2-simplified/) that is easier to follow than the [formal specification](https://oauth.net/2/).</span></span> <span data-ttu-id="ba958-112">Le flux d'authentification pour les onglets et les bots est différent, car les onglets sont similaires aux sites web afin qu'ils peuvent utiliser OAuth 2.0 directement.</span><span class="sxs-lookup"><span data-stu-id="ba958-112">Authentication flow for tabs and bots are different because tabs are similar to websites so they can use OAuth 2.0 directly.</span></span> <span data-ttu-id="ba958-113">Les bots font certaines choses différemment, mais les concepts de base sont identiques.</span><span class="sxs-lookup"><span data-stu-id="ba958-113">Bots do a few things differently, but the core concepts are identical.</span></span>

<span data-ttu-id="ba958-114">Pour obtenir un exemple de flux d'authentification pour les onglets et les bots utilisant Node et le type d'octroi implicite [OAuth 2.0,](https://oauth.net/2/grant-types/implicit/)voir démarrer le flux d'authentification pour les [onglets.](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow)</span><span class="sxs-lookup"><span data-stu-id="ba958-114">For an example of authentication flow for tabs and bots using Node and the [OAuth 2.0 implicit grant type](https://oauth.net/2/grant-types/implicit/), see [initiate authentication flow for tabs](~/tabs/how-to/authentication/auth-tab-aad.md#initiate-authentication-flow).</span></span>

> [!NOTE]
> <span data-ttu-id="ba958-115">Avant **d'afficher** un bouton de connexion à l'utilisateur et d'appeler l'API en réponse à la sélection du bouton, vous devez attendre la fin de l'initialisation du `microsoftTeams.authentication.authenticate` SDK.</span><span class="sxs-lookup"><span data-stu-id="ba958-115">Before showing a **Login** button to the user and calling the `microsoftTeams.authentication.authenticate` API in response to selecting the button, you must wait for the SDK initialization to complete.</span></span> <span data-ttu-id="ba958-116">Vous pouvez transmettre un rappel à l'API qui est appelé à la `microsoftTeams.initialize` fin de l'initialisation.</span><span class="sxs-lookup"><span data-stu-id="ba958-116">You can pass a callback to the `microsoftTeams.initialize` API that is called when initialization completes.</span></span>

![Diagramme de séquence d'authentification par onglet](~/assets/images/authentication/tab_auth_sequence_diagram.png)

1. <span data-ttu-id="ba958-118">L'utilisateur interagit avec le contenu de la  page de configuration ou de contenu de l'onglet, généralement un bouton Se connecter ou **Se** connecter.</span><span class="sxs-lookup"><span data-stu-id="ba958-118">The user interacts with the content on the tab configuration or content page, commonly a **Sign in** or **Log in** button.</span></span>
2. <span data-ttu-id="ba958-119">L'onglet construit l'URL de sa page de démarrage d'th.</span><span class="sxs-lookup"><span data-stu-id="ba958-119">The tab constructs the URL for its auth start page.</span></span> <span data-ttu-id="ba958-120">Éventuellement, il utilise les informations des espaces réservé d'URL ou appelle la méthode du SDK client Teams pour simplifier l'expérience d'authentification `microsoftTeams.getContext()` de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ba958-120">Optionally, it uses information from URL placeholders or calls `microsoftTeams.getContext()` Teams client SDK method to streamline the authentication experience for the user.</span></span> <span data-ttu-id="ba958-121">Par exemple, lors de l'authentification auprès d'AAD, si le paramètre est définie sur l'adresse e-mail de l'utilisateur, l'utilisateur n'a pas besoin de se connecter s'il `login_hint` l'a fait récemment.</span><span class="sxs-lookup"><span data-stu-id="ba958-121">For example, when authenticating with AAD, if the `login_hint` parameter is set to the user's email address, the user does not have to sign in if they have done so recently.</span></span> <span data-ttu-id="ba958-122">Cela est dû au fait qu'AAD utilise les informations d'identification mises en cache de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ba958-122">This is because AAD uses the user's cached credentials.</span></span> <span data-ttu-id="ba958-123">La fenêtre pop-up s'affiche brièvement, puis disparaît.</span><span class="sxs-lookup"><span data-stu-id="ba958-123">The pop-up window is shown briefly and then disappears.</span></span>
3. <span data-ttu-id="ba958-124">L’onglet appelle ensuite la méthode `microsoftTeams.authentication.authenticate()` et inscrit les fonctions `successCallback` et `failureCallback`.</span><span class="sxs-lookup"><span data-stu-id="ba958-124">The tab then calls the `microsoftTeams.authentication.authenticate()` method and registers the `successCallback` and `failureCallback` functions.</span></span>
4. <span data-ttu-id="ba958-125">Teams ouvre la page de démarrage dans un iframe dans une fenêtre fenêtre.</span><span class="sxs-lookup"><span data-stu-id="ba958-125">Teams opens the start page in an iframe in a pop-up window.</span></span> <span data-ttu-id="ba958-126">La page de démarrage génère des données aléatoires, les enregistre pour une validation future et les redirige vers le point de terminaison du fournisseur d'identité, par exemple `state` `/authorize` pour Azure `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` AD.</span><span class="sxs-lookup"><span data-stu-id="ba958-126">The start page generates random `state` data, saves it for future validation, and redirects to the identity provider's `/authorize` endpoint, such as `https://login.microsoftonline.com/<tenant ID>/oauth2/authorize` for Azure AD.</span></span> <span data-ttu-id="ba958-127">Remplacez `<tenant id>` par votre propre ID de client context.tid.</span><span class="sxs-lookup"><span data-stu-id="ba958-127">Replace `<tenant id>` with your own tenant id that is context.tid.</span></span>
<span data-ttu-id="ba958-128">Comme les autres flux d'th d'application dans Teams, la page de démarrage doit se trouver sur un domaine qui se trouve dans sa liste et sur le même domaine que la page de redirection de la publication `validDomains` de la signature.</span><span class="sxs-lookup"><span data-stu-id="ba958-128">Similar to other application auth flows in Teams, the start page must be on a domain that is in its `validDomains` list, and on the same domain as the post sign in redirect page.</span></span>

    > [!NOTE]
    > <span data-ttu-id="ba958-129">Le flux d'octroi implicite OAuth 2.0 appelle un paramètre dans la demande d'authentification, qui contient des données de session uniques pour empêcher une attaque par falsification de demande entre `state` [sites.](https://en.wikipedia.org/wiki/Cross-site_request_forgery)</span><span class="sxs-lookup"><span data-stu-id="ba958-129">The OAuth 2.0 implicit grant flow calls for a `state` parameter in the authentication request, which contains unique session data to prevent a [cross-site request forgery attack](https://en.wikipedia.org/wiki/Cross-site_request_forgery).</span></span> <span data-ttu-id="ba958-130">Les exemples utilisent un GUID généré de manière aléatoire pour les `state` données.</span><span class="sxs-lookup"><span data-stu-id="ba958-130">The examples use a randomly-generated GUID for the `state` data.</span></span>

5. <span data-ttu-id="ba958-131">Sur le site du fournisseur, l'utilisateur se signe et accorde l'accès à l'onglet.</span><span class="sxs-lookup"><span data-stu-id="ba958-131">On the provider's site, the user signs in and grants access to the tab.</span></span>
6. <span data-ttu-id="ba958-132">Le fournisseur redirige l'utilisateur vers la page de redirection OAuth 2.0 de l'onglet avec un jeton d'accès.</span><span class="sxs-lookup"><span data-stu-id="ba958-132">The provider takes the user to the tab's OAuth 2.0 redirect page with an access token.</span></span>
7. <span data-ttu-id="ba958-133">L'onglet vérifie que la valeur renvoyée correspond à ce qui a été enregistré précédemment et appelle, ce qui appelle à son tour la fonction inscrite à `state` `microsoftTeams.authentication.notifySuccess()` l'étape `successCallback` 3.</span><span class="sxs-lookup"><span data-stu-id="ba958-133">The tab checks that the returned `state` value matches what was saved earlier, and calls `microsoftTeams.authentication.notifySuccess()`, which in turn calls the `successCallback` function registered in step 3.</span></span>
8. <span data-ttu-id="ba958-134">Teams ferme la fenêtre pop-up.</span><span class="sxs-lookup"><span data-stu-id="ba958-134">Teams closes the pop-up window.</span></span>
9. <span data-ttu-id="ba958-135">L'onglet affiche l'interface utilisateur de configuration, actuale ou recharge le contenu des onglets, en fonction de l'origine de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ba958-135">The tab either displays configuration UI, refreshes, or reloads the tabs content, depending on where the user started from.</span></span>

## <a name="treat-tab-context-as-hints"></a><span data-ttu-id="ba958-136">Traiter le contexte de l'onglet comme des conseils</span><span class="sxs-lookup"><span data-stu-id="ba958-136">Treat tab context as hints</span></span>

<span data-ttu-id="ba958-137">Bien que le contexte de l'onglet fournit des informations utiles concernant l'utilisateur, n'utilisez pas ces informations pour authentifier l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ba958-137">Although the tab context provides helpful information regarding the user, do not use this information to authenticate the user.</span></span> <span data-ttu-id="ba958-138">Authentifier l'utilisateur même si vous obtenez les informations en tant que paramètres d'URL de l'URL de contenu de l'onglet ou en appelant la fonction dans le `microsoftTeams.getContext()` SDK client Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="ba958-138">Do authenticate the user even if you get the information as URL parameters to your tab content URL or by calling the `microsoftTeams.getContext()` function in the Microsoft Teams client SDK.</span></span> <span data-ttu-id="ba958-139">Un acteur malveillant peut appeler l'URL de contenu de votre onglet avec ses propres paramètres.</span><span class="sxs-lookup"><span data-stu-id="ba958-139">A malicious actor can invoke your tab content URL with its own parameters.</span></span> <span data-ttu-id="ba958-140">L'acteur peut également appeler une page web usurpant l'identité de Microsoft Teams pour charger l'URL du contenu de votre onglet dans un iframe et renvoyer ses propres données à la `getContext()` fonction.</span><span class="sxs-lookup"><span data-stu-id="ba958-140">The actor can also invoke a web page impersonating Microsoft Teams to load your tab content URL in an iframe and return its own data to the `getContext()` function.</span></span> <span data-ttu-id="ba958-141">Vous devez traiter les informations relatives à l'identité dans le contexte de l'onglet simplement comme des conseils et les valider avant de les utiliser.</span><span class="sxs-lookup"><span data-stu-id="ba958-141">You must treat the identity-related information in the tab context simply as hints and validate them before use.</span></span> <span data-ttu-id="ba958-142">Reportez-vous aux notes [pour accéder à la page d'autorisation à partir de votre page de fenêtre pop-up.](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page)</span><span class="sxs-lookup"><span data-stu-id="ba958-142">Refer to the notes in [navigate to the authorization page from your pop-up page](~/tabs/how-to/authentication/auth-tab-aad.md#navigate-to-the-authorization-page-from-your-popup-page).</span></span>

## <a name="code-sample"></a><span data-ttu-id="ba958-143">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="ba958-143">Code sample</span></span>

<span data-ttu-id="ba958-144">Exemple de code montrant le processus d'authentification par onglets.</span><span class="sxs-lookup"><span data-stu-id="ba958-144">Sample code showing the tab authentication process.</span></span>

| <span data-ttu-id="ba958-145">**Exemple de nom**</span><span class="sxs-lookup"><span data-stu-id="ba958-145">**Sample name**</span></span> | <span data-ttu-id="ba958-146">**Description**</span><span class="sxs-lookup"><span data-stu-id="ba958-146">**Description**</span></span> | <span data-ttu-id="ba958-147">**C#**</span><span class="sxs-lookup"><span data-stu-id="ba958-147">**C#**</span></span> | <span data-ttu-id="ba958-148">**Node.js**</span><span class="sxs-lookup"><span data-stu-id="ba958-148">**Node.js**</span></span> |
|-----------------|-----------------|-------------|------------|
| <span data-ttu-id="ba958-149">Authentification d'onglet Teams</span><span class="sxs-lookup"><span data-stu-id="ba958-149">Teams tab authentication</span></span> | <span data-ttu-id="ba958-150">Processus d'authentification pour les onglets à l'aide d'AAD.</span><span class="sxs-lookup"><span data-stu-id="ba958-150">Authentication process for tabs using AAD.</span></span> | [<span data-ttu-id="ba958-151">View</span><span class="sxs-lookup"><span data-stu-id="ba958-151">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/csharp) | [<span data-ttu-id="ba958-152">View</span><span class="sxs-lookup"><span data-stu-id="ba958-152">View</span></span>](https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-complete-sample/nodejs) |

## <a name="more-details"></a><span data-ttu-id="ba958-153">Plus de détails</span><span class="sxs-lookup"><span data-stu-id="ba958-153">More details</span></span>

<span data-ttu-id="ba958-154">Pour une implémentation détaillée de l'authentification par onglet à l'aide d'AAD, voir :</span><span class="sxs-lookup"><span data-stu-id="ba958-154">For a detailed implementation for tab authentication using AAD, see:</span></span>

* [<span data-ttu-id="ba958-155">Authentifier un utilisateur dans un onglet Teams</span><span class="sxs-lookup"><span data-stu-id="ba958-155">Authenticate a user in a Teams tab</span></span>](~/tabs/how-to/authentication/auth-tab-AAD.md)
* [<span data-ttu-id="ba958-156">Authentification en mode silencieux</span><span class="sxs-lookup"><span data-stu-id="ba958-156">Silent authentication</span></span>](~/tabs/how-to/authentication/auth-silent-AAD.md)
