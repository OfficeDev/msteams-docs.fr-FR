---
title: Créer une page de suppression d’onglets
author: surbhigupta
description: Comment créer une page de suppression d’onglets
keywords: suppression des onglets teams du canal de groupe configurable
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: 1b4ef5435ad1be82726edbf02d7205c0b1feba06
ms.sourcegitcommit: 4d9d1542e04abacfb252511c665a7229d8bb7162
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/25/2021
ms.locfileid: "53140193"
---
# <a name="create-a-removal-page"></a><span data-ttu-id="01f63-104">Créer une page de suppression</span><span class="sxs-lookup"><span data-stu-id="01f63-104">Create a removal page</span></span>

<span data-ttu-id="01f63-105">Vous pouvez étendre et améliorer l’expérience utilisateur en prendre en charge les options de suppression et de modification dans votre application.</span><span class="sxs-lookup"><span data-stu-id="01f63-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="01f63-106">Teams permet aux utilisateurs de renommer ou de supprimer un onglet de canal ou de groupe et vous pouvez permettre aux utilisateurs de reconfigurer votre onglet après l’installation.</span><span class="sxs-lookup"><span data-stu-id="01f63-106">Teams enables users to rename or remove a channel or group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="01f63-107">En outre, l’expérience de suppression d’onglet offre aux utilisateurs des options post-suppression pour supprimer ou archiver du contenu.</span><span class="sxs-lookup"><span data-stu-id="01f63-107">Additionally, the tab removal experience provides the users with post-removal options to delete or archive content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="01f63-108">Activer la reconfiguration de votre onglet après l’installation</span><span class="sxs-lookup"><span data-stu-id="01f63-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="01f63-109">Votre **manifest.jsdéfinit** les fonctionnalités et fonctionnalités de votre onglet.</span><span class="sxs-lookup"><span data-stu-id="01f63-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="01f63-110">La propriété d’instance d’onglet prend une valeur boolé générale qui indique si un utilisateur peut modifier ou reconfigurer l’onglet `canUpdateConfiguration` après sa création.</span><span class="sxs-lookup"><span data-stu-id="01f63-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created.</span></span> <span data-ttu-id="01f63-111">Le tableau suivant fournit les détails de la propriété :</span><span class="sxs-lookup"><span data-stu-id="01f63-111">The following table provides the property details:</span></span>

|<span data-ttu-id="01f63-112">Nom</span><span class="sxs-lookup"><span data-stu-id="01f63-112">Name</span></span>| <span data-ttu-id="01f63-113">Type</span><span class="sxs-lookup"><span data-stu-id="01f63-113">Type</span></span>| <span data-ttu-id="01f63-114">Taille maximale</span><span class="sxs-lookup"><span data-stu-id="01f63-114">Maximum size</span></span> | <span data-ttu-id="01f63-115">Requis</span><span class="sxs-lookup"><span data-stu-id="01f63-115">Required</span></span> | <span data-ttu-id="01f63-116">Description</span><span class="sxs-lookup"><span data-stu-id="01f63-116">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="01f63-117">Boolean</span><span class="sxs-lookup"><span data-stu-id="01f63-117">Boolean</span></span>|||<span data-ttu-id="01f63-118">Valeur indiquant si une instance de la configuration de l’onglet peut être mise à jour par l’utilisateur après sa création.</span><span class="sxs-lookup"><span data-stu-id="01f63-118">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="01f63-119">La valeur par défaut est `true`.</span><span class="sxs-lookup"><span data-stu-id="01f63-119">Default is `true`.</span></span> |

<span data-ttu-id="01f63-120">Lorsque votre onglet est téléchargé vers un canal ou une conversation de groupe, Teams un menu déroulant de clic droit pour votre onglet. Les options disponibles sont déterminées par le `canUpdateConfiguration` paramètre.</span><span class="sxs-lookup"><span data-stu-id="01f63-120">When your tab is uploaded to a channel or group chat, Teams adds a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting.</span></span> <span data-ttu-id="01f63-121">Le tableau suivant fournit les détails des paramètres :</span><span class="sxs-lookup"><span data-stu-id="01f63-121">The following table provides the setting details:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="01f63-122">true</span><span class="sxs-lookup"><span data-stu-id="01f63-122">true</span></span>   | <span data-ttu-id="01f63-123">false</span><span class="sxs-lookup"><span data-stu-id="01f63-123">false</span></span> | <span data-ttu-id="01f63-124">description</span><span class="sxs-lookup"><span data-stu-id="01f63-124">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="01f63-125">Paramètres</span><span class="sxs-lookup"><span data-stu-id="01f63-125">Settings</span></span>            |   <span data-ttu-id="01f63-126">√</span><span class="sxs-lookup"><span data-stu-id="01f63-126">√</span></span>    |       |<span data-ttu-id="01f63-127">La page est rechargée dans un IFrame, ce qui permet à l’utilisateur de `configurationUrl` reconfigurer l’onglet.</span><span class="sxs-lookup"><span data-stu-id="01f63-127">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span> |
|     <span data-ttu-id="01f63-128">Renommer</span><span class="sxs-lookup"><span data-stu-id="01f63-128">Rename</span></span>              |   <span data-ttu-id="01f63-129">√</span><span class="sxs-lookup"><span data-stu-id="01f63-129">√</span></span>    |   <span data-ttu-id="01f63-130">√</span><span class="sxs-lookup"><span data-stu-id="01f63-130">√</span></span>   | <span data-ttu-id="01f63-131">L’utilisateur peut modifier le nom de l’onglet tel qu’il apparaît dans la barre d’onglets.</span><span class="sxs-lookup"><span data-stu-id="01f63-131">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="01f63-132">Supprimer</span><span class="sxs-lookup"><span data-stu-id="01f63-132">Remove</span></span>              |   <span data-ttu-id="01f63-133">√</span><span class="sxs-lookup"><span data-stu-id="01f63-133">√</span></span>    |   <span data-ttu-id="01f63-134">√</span><span class="sxs-lookup"><span data-stu-id="01f63-134">√</span></span>   |  <span data-ttu-id="01f63-135">Si la propriété et la valeur sont incluses dans la page de configuration, la page de suppression est chargée dans un IFrame et présentée `removeURL` à l’utilisateur.  </span><span class="sxs-lookup"><span data-stu-id="01f63-135">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="01f63-136">Si une page de suppression n’est pas incluse, une boîte de dialogue de confirmation est présentée à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="01f63-136">If a removal page is not included, the user is presented with a confirm dialog box.</span></span>          |

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="01f63-137">Créer une page de suppression d’onglets pour votre application</span><span class="sxs-lookup"><span data-stu-id="01f63-137">Create a tab removal page for your application</span></span>

<span data-ttu-id="01f63-138">La page de suppression facultative est une page HTML que vous hébergez et qui s’affiche lorsque l’onglet est supprimé.</span><span class="sxs-lookup"><span data-stu-id="01f63-138">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="01f63-139">L’URL de la page de suppression est désignée par la `setSettings()` méthode dans votre page de configuration.</span><span class="sxs-lookup"><span data-stu-id="01f63-139">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="01f63-140">Comme pour toutes les pages de votre application, la page de suppression doit respecter les conditions préalables [Teams’onglet.](../../../tabs/how-to/tab-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="01f63-140">As with all pages in your app, the removal page must comply with [Teams tab prerequisites](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="01f63-141">Inscrire un remove handler</span><span class="sxs-lookup"><span data-stu-id="01f63-141">Register a remove handler</span></span>

<span data-ttu-id="01f63-142">Si vous le souhaitez, dans votre logique de page de suppression, vous pouvez appeler le handler d’événements lorsque l’utilisateur supprime une `registerOnRemoveHandler((RemoveEvent) => {}` configuration d’onglet existante.</span><span class="sxs-lookup"><span data-stu-id="01f63-142">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="01f63-143">La méthode prend l’interface et exécute le code dans le handler lorsqu’un utilisateur tente [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) de supprimer du contenu.</span><span class="sxs-lookup"><span data-stu-id="01f63-143">The method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="01f63-144">La méthode permet d’effectuer des opérations de nettoyage, telles que la suppression de la ressource sous-jacente qui alimentera le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="01f63-144">The method is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="01f63-145">À la fois, un seul handler de suppression peut être inscrit.</span><span class="sxs-lookup"><span data-stu-id="01f63-145">At a time only one remove handler can be registered.</span></span>

<span data-ttu-id="01f63-146">`RemoveEvent`L’interface décrit un objet avec deux méthodes :</span><span class="sxs-lookup"><span data-stu-id="01f63-146">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="01f63-147">La `notifySuccess()` fonction est obligatoire.</span><span class="sxs-lookup"><span data-stu-id="01f63-147">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="01f63-148">Il indique que la suppression de la ressource sous-jacente a réussi et que son contenu peut être supprimé.</span><span class="sxs-lookup"><span data-stu-id="01f63-148">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="01f63-149">La `notifyFailure(string)` fonction est facultative.</span><span class="sxs-lookup"><span data-stu-id="01f63-149">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="01f63-150">Il indique que la suppression de la ressource sous-jacente a échoué et que son contenu ne peut pas être supprimé.</span><span class="sxs-lookup"><span data-stu-id="01f63-150">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="01f63-151">Le paramètre de chaîne facultatif spécifie la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="01f63-151">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="01f63-152">Si elle est fournie, cette chaîne s’affiche pour l’utilisateur ; sinon, une erreur générique s’affiche.</span><span class="sxs-lookup"><span data-stu-id="01f63-152">If provided, this string is displayed to the user; else a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="01f63-153">Utiliser la `getSettings()` fonction</span><span class="sxs-lookup"><span data-stu-id="01f63-153">Use the `getSettings()` function</span></span>

<span data-ttu-id="01f63-154">Vous pouvez `getSettings()` l’utiliser pour affecter le contenu de l’onglet à supprimer.</span><span class="sxs-lookup"><span data-stu-id="01f63-154">You can use `getSettings()`to assign the tab content to be removed.</span></span> <span data-ttu-id="01f63-155">La fonction prend dans et fournit les valeurs de propriété `getSettings((Settings) =>{})` de [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) paramètres valides qui peuvent être récupérées.</span><span class="sxs-lookup"><span data-stu-id="01f63-155">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="01f63-156">Utiliser la `getContext()` fonction</span><span class="sxs-lookup"><span data-stu-id="01f63-156">Use the `getContext()` function</span></span>

<span data-ttu-id="01f63-157">Vous pouvez utiliser `getContext()` pour obtenir le contexte actuel dans lequel l’image est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="01f63-157">You can use `getContext()` to get the current context in which the frame is running.</span></span> <span data-ttu-id="01f63-158">La `getContext((Context) =>{})` fonction prend dans le [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) .</span><span class="sxs-lookup"><span data-stu-id="01f63-158">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true).</span></span> <span data-ttu-id="01f63-159">La fonction fournit des valeurs de propriété valides que vous pouvez utiliser dans la logique de votre page de suppression pour déterminer le contenu à afficher `Context` dans la page de suppression.</span><span class="sxs-lookup"><span data-stu-id="01f63-159">The function provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="01f63-160">Inclure l’authentification</span><span class="sxs-lookup"><span data-stu-id="01f63-160">Include authentication</span></span>

<span data-ttu-id="01f63-161">L’authentification est requise avant de permettre à un utilisateur de supprimer le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="01f63-161">Authentication is required before allowing a user to delete the tab content.</span></span> <span data-ttu-id="01f63-162">Les informations de contexte peuvent être utilisées pour créer des demandes d’authentification et des URL de page d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="01f63-162">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="01f63-163">Voir [Microsoft Teams flux d’authentification pour les onglets.](~/tabs/how-to/authentication/auth-flow-tab.md)</span><span class="sxs-lookup"><span data-stu-id="01f63-163">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="01f63-164">Assurez-vous que tous les domaines utilisés dans vos pages d’onglets sont répertoriés dans le `manifest.json` `validDomains` tableau.</span><span class="sxs-lookup"><span data-stu-id="01f63-164">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="01f63-165">Voici un exemple de bloc de code de suppression d’onglet :</span><span class="sxs-lookup"><span data-stu-id="01f63-165">The following is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="01f63-166">Lorsqu’un utilisateur  sélectionne Supprimer du menu déroulant de l’onglet, Teams charge la page facultative affectée dans votre page de `removeUrl` **configuration,** dans un IFrame.</span><span class="sxs-lookup"><span data-stu-id="01f63-166">When a user selects **Remove** from the tab's drop-down menu, Teams loads the optional `removeUrl` page assigned in your **configuration page**, into an IFrame.</span></span> <span data-ttu-id="01f63-167">L’utilisateur voit un bouton chargé avec la fonction qui appelle et active le bouton Supprimer affiché en bas de `onClick()` `microsoftTeams.settings.setValidityState(true)` l’IFrame de la page de suppression. </span><span class="sxs-lookup"><span data-stu-id="01f63-167">The user is shown a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button shown at the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="01f63-168">Une fois le handler de suppression exécuté, ou avertit Teams `removeEvent.notifySuccess()` du résultat de suppression de `removeEvent.notifyFailure()` contenu.</span><span class="sxs-lookup"><span data-stu-id="01f63-168">After the remove handler is executed, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="01f63-169">Pour vous assurer que le contrôle d’un utilisateur autorisé sur un onglet n’est pas inhibé, Teams supprime l’onglet dans les cas de réussite et d’échec.</span><span class="sxs-lookup"><span data-stu-id="01f63-169">To ensure that an authorized user's control over a tab is not inhibited, Teams removes the tab in both success and failure cases.</span></span>
> * <span data-ttu-id="01f63-170">Teams active le bouton **Supprimer** après cinq secondes, même si votre onglet n’a pas `setValidityState()` appelé.</span><span class="sxs-lookup"><span data-stu-id="01f63-170">Teams enables the **Remove** button after five seconds, even if your tab has not called `setValidityState()`.</span></span>
> * <span data-ttu-id="01f63-171">Lorsque l’utilisateur sélectionne **Supprimer,** Teams l’onglet après 30 secondes, que les actions soient terminées ou non.</span><span class="sxs-lookup"><span data-stu-id="01f63-171">When the user selects **Remove**, Teams removes the tab after 30 seconds regardless of whether the actions have been completed or not.</span></span>

## <a name="see-also"></a><span data-ttu-id="01f63-172">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="01f63-172">See also</span></span>

* [<span data-ttu-id="01f63-173">Teams onglets</span><span class="sxs-lookup"><span data-stu-id="01f63-173">Teams tabs</span></span>](~/tabs/what-are-tabs.md)
* [<span data-ttu-id="01f63-174">Conditions préalables</span><span class="sxs-lookup"><span data-stu-id="01f63-174">Prerequisites</span></span>](~/tabs/how-to/tab-requirements.md)
* [<span data-ttu-id="01f63-175">Créer un onglet personnel</span><span class="sxs-lookup"><span data-stu-id="01f63-175">Create a personal tab</span></span>](~/tabs/how-to/create-personal-tab.md)
* [<span data-ttu-id="01f63-176">Créer un onglet de canal ou de groupe</span><span class="sxs-lookup"><span data-stu-id="01f63-176">Create a channel or group tab</span></span>](~/tabs/how-to/create-channel-group-tab.md)
* [<span data-ttu-id="01f63-177">Créer une page de contenu</span><span class="sxs-lookup"><span data-stu-id="01f63-177">Create a content page</span></span>](~/tabs/how-to/create-tab-pages/content-page.md)
* [<span data-ttu-id="01f63-178">Créer une page de configuration</span><span class="sxs-lookup"><span data-stu-id="01f63-178">Create a configuration page</span></span>](~/tabs/how-to/create-tab-pages/configuration-page.md)
* [<span data-ttu-id="01f63-179">Obtenir un contexte Teams pour votre onglet</span><span class="sxs-lookup"><span data-stu-id="01f63-179">Get context for your tab</span></span>](~/tabs/how-to/access-teams-context.md)
* [<span data-ttu-id="01f63-180">Créer des onglets avec les Cartes adaptatives</span><span class="sxs-lookup"><span data-stu-id="01f63-180">Build tabs with Adaptive Cards</span></span>](~/tabs/how-to/build-adaptive-card-tabs.md)
* [<span data-ttu-id="01f63-181">Déploiement du lien des onglets et vue des étapes</span><span class="sxs-lookup"><span data-stu-id="01f63-181">Tabs link unfurling and Stage View</span></span>](~/tabs/tabs-link-unfurling.md)
* [<span data-ttu-id="01f63-182">Créer des onglets de conversation</span><span class="sxs-lookup"><span data-stu-id="01f63-182">Create conversational tabs</span></span>](~/tabs/how-to/conversational-tabs.md)
* [<span data-ttu-id="01f63-183">Modifications des marges de l’onglet</span><span class="sxs-lookup"><span data-stu-id="01f63-183">Tab margin changes</span></span>](~/resources/removing-tab-margins.md)

## <a name="next-step"></a><span data-ttu-id="01f63-184">Étape suivante</span><span class="sxs-lookup"><span data-stu-id="01f63-184">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="01f63-185">Onglets sur les appareils mobiles</span><span class="sxs-lookup"><span data-stu-id="01f63-185">Tabs on mobile</span></span>](~/tabs/design/tabs-mobile.md)