---
title: Créer une page de suppression d’onglets
author: laujan
description: Comment créer une page de suppression d’onglets
keywords: équipes onglets canal de groupe configurable supprimer supprimer
localization_priority: Normal
ms.topic: conceptual
ms.author: lajanuar
ms.openlocfilehash: e1a1f38a2bcb3b5bc4bc54f469c8727e44d8695e
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566669"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="efca9-104">Modifier ou supprimer un onglet de groupe de canal</span><span class="sxs-lookup"><span data-stu-id="efca9-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="efca9-105">Vous pouvez étendre et améliorer l’expérience utilisateur en soutenant les options de suppression et de modification dans votre application.</span><span class="sxs-lookup"><span data-stu-id="efca9-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="efca9-106">Teams permet aux utilisateurs de renommer ou de supprimer un onglet canal/groupe et vous pouvez permettre aux utilisateurs de reconfigurer votre onglet après l’installation.</span><span class="sxs-lookup"><span data-stu-id="efca9-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="efca9-107">En outre, votre expérience de suppression d’onglet peut inclure la déstabilisation de ce qui arrive au contenu lorsque votre onglet est supprimé ou de donner aux utilisateurs des options post-suppression telles que la suppression ou l’archivage du contenu.</span><span class="sxs-lookup"><span data-stu-id="efca9-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="efca9-108">Activez la reconfiguration de votre onglet après l’installation</span><span class="sxs-lookup"><span data-stu-id="efca9-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="efca9-109">Votre **manifest.jsdéfinit** les fonctionnalités et les capacités de votre onglet.</span><span class="sxs-lookup"><span data-stu-id="efca9-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="efca9-110">La propriété `canUpdateConfiguration` d’instance d’onglet prend une valeur Boolean qui indique si un utilisateur peut modifier ou reconfigurer l’onglet après sa création :</span><span class="sxs-lookup"><span data-stu-id="efca9-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="efca9-111">Nom</span><span class="sxs-lookup"><span data-stu-id="efca9-111">Name</span></span>| <span data-ttu-id="efca9-112">Type</span><span class="sxs-lookup"><span data-stu-id="efca9-112">Type</span></span>| <span data-ttu-id="efca9-113">Taille maximale</span><span class="sxs-lookup"><span data-stu-id="efca9-113">Maximum size</span></span> | <span data-ttu-id="efca9-114">Requis</span><span class="sxs-lookup"><span data-stu-id="efca9-114">Required</span></span> | <span data-ttu-id="efca9-115">Description</span><span class="sxs-lookup"><span data-stu-id="efca9-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="efca9-116">Booléen</span><span class="sxs-lookup"><span data-stu-id="efca9-116">Boolean</span></span>|||<span data-ttu-id="efca9-117">Une valeur indiquant si une instance de la configuration de l’onglet peut être mise à jour par l’utilisateur après la création.</span><span class="sxs-lookup"><span data-stu-id="efca9-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="efca9-118">faire défaut: `true`</span><span class="sxs-lookup"><span data-stu-id="efca9-118">Default: `true`</span></span>|

<span data-ttu-id="efca9-119">Lorsque votre onglet est téléchargé sur un canal ou un chat de groupe, Teams ajoutera un menu drop-down à clic droit pour votre onglet. Les options disponibles sont déterminées par le `canUpdateConfiguration` paramètre :</span><span class="sxs-lookup"><span data-stu-id="efca9-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="efca9-120">true</span><span class="sxs-lookup"><span data-stu-id="efca9-120">true</span></span>   | <span data-ttu-id="efca9-121">false</span><span class="sxs-lookup"><span data-stu-id="efca9-121">false</span></span> | <span data-ttu-id="efca9-122">description</span><span class="sxs-lookup"><span data-stu-id="efca9-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="efca9-123">Paramètres</span><span class="sxs-lookup"><span data-stu-id="efca9-123">Settings</span></span>            |   <span data-ttu-id="efca9-124">√</span><span class="sxs-lookup"><span data-stu-id="efca9-124">√</span></span>    |       |<span data-ttu-id="efca9-125">La `configurationUrl` page est rechargée dans un IFrame permettant à l’utilisateur de reconfigurer l’onglet.</span><span class="sxs-lookup"><span data-stu-id="efca9-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="efca9-126">Renommer</span><span class="sxs-lookup"><span data-stu-id="efca9-126">Rename</span></span>              |   <span data-ttu-id="efca9-127">√</span><span class="sxs-lookup"><span data-stu-id="efca9-127">√</span></span>    |   <span data-ttu-id="efca9-128">√</span><span class="sxs-lookup"><span data-stu-id="efca9-128">√</span></span>   | <span data-ttu-id="efca9-129">L’utilisateur peut modifier le nom de l’onglet tel qu’il apparaît dans la barre d’onglet.</span><span class="sxs-lookup"><span data-stu-id="efca9-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="efca9-130">Supprimer</span><span class="sxs-lookup"><span data-stu-id="efca9-130">Remove</span></span>              |   <span data-ttu-id="efca9-131">√</span><span class="sxs-lookup"><span data-stu-id="efca9-131">√</span></span>    |   <span data-ttu-id="efca9-132">√</span><span class="sxs-lookup"><span data-stu-id="efca9-132">√</span></span>   |  <span data-ttu-id="efca9-133">Si la  `removeURL` propriété et la valeur sont incluses dans la page de **configuration,** la **page de suppression** est chargée dans un IFrame et présentée à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="efca9-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="efca9-134">Si une page de suppression n’est pas incluse, l’utilisateur est présenté avec une boîte de dialogue de confirmation.</span><span class="sxs-lookup"><span data-stu-id="efca9-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="efca9-135">Créez une page de suppression d’onglets pour votre application</span><span class="sxs-lookup"><span data-stu-id="efca9-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="efca9-136">La page de suppression optionnelle est une page HTML que vous hébergez et s’affiche lorsque l’onglet est supprimé.</span><span class="sxs-lookup"><span data-stu-id="efca9-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="efca9-137">L’URL de la page de suppression est désignée par `setSettings()` la méthode dans votre page de configuration.</span><span class="sxs-lookup"><span data-stu-id="efca9-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="efca9-138">Comme pour toutes les pages de votre application, la page de suppression doit se conformer aux [exigences Teams’onglets](../../../tabs/how-to/tab-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="efca9-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](../../../tabs/how-to/tab-requirements.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="efca9-139">Enregistrer un gestionnaire de suppression</span><span class="sxs-lookup"><span data-stu-id="efca9-139">Register a remove handler</span></span>

<span data-ttu-id="efca9-140">En option, dans votre logique de page de suppression, vous pouvez invoquer `registerOnRemoveHandler((RemoveEvent) => {}` le gestionnaire d’événements lorsque l’utilisateur supprime une configuration d’onglet existante.</span><span class="sxs-lookup"><span data-stu-id="efca9-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="efca9-141">La méthode prend dans [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) l’interface et exécute le code dans le gestionnaire quand un utilisateur tente de supprimer du contenu.</span><span class="sxs-lookup"><span data-stu-id="efca9-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest&preserve-view=true) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="efca9-142">Il est utilisé pour effectuer des opérations de nettoyage telles que la suppression de la ressource sous-jacente qui alimenter le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="efca9-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="efca9-143">Un seul gestionnaire de suppression peut être enregistré à la fois.</span><span class="sxs-lookup"><span data-stu-id="efca9-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="efca9-144">`RemoveEvent`L’interface décrit un objet avec deux méthodes :</span><span class="sxs-lookup"><span data-stu-id="efca9-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="efca9-145">La `notifySuccess()` fonction est requise.</span><span class="sxs-lookup"><span data-stu-id="efca9-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="efca9-146">Il indique que la suppression de la ressource sous-jacente a réussi et que son contenu peut être supprimé.</span><span class="sxs-lookup"><span data-stu-id="efca9-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="efca9-147">La `notifyFailure(string)` fonction est facultative.</span><span class="sxs-lookup"><span data-stu-id="efca9-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="efca9-148">Il indique que la suppression de la ressource sous-jacente a échoué et que son contenu ne peut pas être supprimé.</span><span class="sxs-lookup"><span data-stu-id="efca9-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="efca9-149">Le paramètre de chaîne optionnel spécifie une raison de la défaillance.</span><span class="sxs-lookup"><span data-stu-id="efca9-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="efca9-150">Si elle est fournie, cette chaîne s’affiche à l’utilisateur; sinon une erreur générique s’affiche.</span><span class="sxs-lookup"><span data-stu-id="efca9-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="efca9-151">Utiliser la `getSettings()` fonction</span><span class="sxs-lookup"><span data-stu-id="efca9-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="efca9-152">Vous pouvez utiliser `getSettings()` pour désigner le contenu de l’onglet à supprimer.</span><span class="sxs-lookup"><span data-stu-id="efca9-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="efca9-153">La `getSettings((Settings) =>{})` fonction prend dans le et fournit les valeurs de propriété paramètres [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) valides qui peuvent être récupérés.</span><span class="sxs-lookup"><span data-stu-id="efca9-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest&preserve-view=true) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="efca9-154">Utiliser la `getContext()` fonction</span><span class="sxs-lookup"><span data-stu-id="efca9-154">Use the `getContext()` function</span></span>

<span data-ttu-id="efca9-155">Vous pouvez utiliser pour `getContext()` récupérer le contexte actuel dans lequel le cadre est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="efca9-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="efca9-156">La `getContext((Context) =>{})` fonction prend dans le et fournit des valeurs de propriété [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) `Context` valides que vous pouvez utiliser dans votre logique de page de suppression pour déterminer le contenu à afficher dans la page de suppression.</span><span class="sxs-lookup"><span data-stu-id="efca9-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest&preserve-view=true) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="efca9-157">Inclure l’authentification</span><span class="sxs-lookup"><span data-stu-id="efca9-157">Include authentication</span></span>

<span data-ttu-id="efca9-158">Vous pourriez avoir besoin d’authentification avant de permettre à un utilisateur de supprimer le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="efca9-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="efca9-159">Les informations context contextiées peuvent être utilisées pour aider à construire des demandes d’authentification et des URL de page d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="efca9-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="efca9-160">Voir le [Microsoft Teams’authentification pour les onglets](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="efca9-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="efca9-161">Assurez-vous que tous les domaines utilisés dans vos pages d’onglets sont répertoriés dans le `manifest.json` `validDomains` tableau.</span><span class="sxs-lookup"><span data-stu-id="efca9-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="efca9-162">Voici un bloc de code de suppression d’onglets d’échantillon :</span><span class="sxs-lookup"><span data-stu-id="efca9-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="efca9-163">Lorsqu’un utilisateur sélectionne **Supprimer du** menu de drop-down de l’onglet, Teams charge la page optionnelle (désignée dans votre page `removeUrl` de **configuration)** dans un IFrame.</span><span class="sxs-lookup"><span data-stu-id="efca9-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="efca9-164">Ici, l’utilisateur est présenté avec un bouton chargé de la `onClick()` fonction qui appelle et permet le bouton `microsoftTeams.settings.setValidityState(true)` **Supprimer** situé près du bas de la page de suppression IFrame.</span><span class="sxs-lookup"><span data-stu-id="efca9-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="efca9-165">Après l’exécution du gestionnaire de suppression, `removeEvent.notifySuccess()` ou `removeEvent.notifyFailure()` avertit Teams résultat de suppression de contenu.</span><span class="sxs-lookup"><span data-stu-id="efca9-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
> * <span data-ttu-id="efca9-166">Pour s’assurer que le contrôle d’un utilisateur autorisé sur un onglet n’est pas inhibé, Teams supprimera l’onglet dans les cas de succès et d’échec.</span><span class="sxs-lookup"><span data-stu-id="efca9-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
> * <span data-ttu-id="efca9-167">Teams permet le **bouton Supprimer** après 5 secondes, même si votre onglet n’a pas appelé `setValidityState()` .</span><span class="sxs-lookup"><span data-stu-id="efca9-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
> * <span data-ttu-id="efca9-168">Lorsque l’utilisateur sélectionne **Supprimer Teams** supprime l’onglet après 30 secondes, que vos actions aient été terminées ou non.</span><span class="sxs-lookup"><span data-stu-id="efca9-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
