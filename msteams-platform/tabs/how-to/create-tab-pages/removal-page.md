---
title: Créer une page de suppression d’onglets
author: laujan
description: Procédure de création d’une page de suppression d’onglets
keywords: onglets teams groupe canal configurable supprimer supprimer
ms.topic: conceptual
ms.author: ''
ms.openlocfilehash: 576a3bc88d8776a193b48868d37df204c3112fd8
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/01/2020
ms.locfileid: "41673542"
---
# <a name="modify-or-remove-a-channel-group-tab"></a><span data-ttu-id="46dda-104">Modifier ou supprimer un onglet de groupe de canaux</span><span class="sxs-lookup"><span data-stu-id="46dda-104">Modify or remove a channel group tab</span></span>

<span data-ttu-id="46dda-105">Vous pouvez étendre et améliorer l’expérience utilisateur en prenant en charge les options de suppression et de modification dans votre application.</span><span class="sxs-lookup"><span data-stu-id="46dda-105">You can extend and enhance the user experience by supporting removal and modification options in your app.</span></span> <span data-ttu-id="46dda-106">Teams permet aux utilisateurs de renommer ou de supprimer un onglet de canal/groupe et de permettre aux utilisateurs de reconfigurer votre onglet après l’installation.</span><span class="sxs-lookup"><span data-stu-id="46dda-106">Teams enables users to rename or remove a channel/group tab and you can permit users to reconfigure your tab after installation.</span></span> <span data-ttu-id="46dda-107">En outre, l’expérience de suppression de votre onglet peut inclure la désignation de ce qui se passe sur le contenu lorsque votre onglet est supprimé ou en fournissant aux utilisateurs des options de post-suppression telles que la suppression ou l’archivage du contenu.</span><span class="sxs-lookup"><span data-stu-id="46dda-107">Additionally, your tab removal experience can include designating what happens to the content when your tab is removed or giving users post-removal options such as deleting or archiving the content.</span></span>

## <a name="enable-your-tab-to-be-reconfigured-after-installation"></a><span data-ttu-id="46dda-108">Activer la reconfiguration de votre onglet après l’installation</span><span class="sxs-lookup"><span data-stu-id="46dda-108">Enable your tab to be reconfigured after installation</span></span>

<span data-ttu-id="46dda-109">Votre **fichier manifest. JSON** définit les fonctionnalités et fonctionnalités de votre onglet.</span><span class="sxs-lookup"><span data-stu-id="46dda-109">Your **manifest.json** defines your tab's features and capabilities.</span></span> <span data-ttu-id="46dda-110">La propriété d' `canUpdateConfiguration` instance d’onglet prend une valeur de type Boolean qui indique si un utilisateur peut modifier ou reconfigurer l’onglet après sa création :</span><span class="sxs-lookup"><span data-stu-id="46dda-110">The tab instance `canUpdateConfiguration` property takes a Boolean value that indicates whether a user can modify or reconfigure the tab after it is created:</span></span>

|<span data-ttu-id="46dda-111">Nom</span><span class="sxs-lookup"><span data-stu-id="46dda-111">Name</span></span>| <span data-ttu-id="46dda-112">Type</span><span class="sxs-lookup"><span data-stu-id="46dda-112">Type</span></span>| <span data-ttu-id="46dda-113">Taille maximale</span><span class="sxs-lookup"><span data-stu-id="46dda-113">Maximum size</span></span> | <span data-ttu-id="46dda-114">Requis</span><span class="sxs-lookup"><span data-stu-id="46dda-114">Required</span></span> | <span data-ttu-id="46dda-115">Description</span><span class="sxs-lookup"><span data-stu-id="46dda-115">Description</span></span>|
|---|---|---|---|---|
|`canUpdateConfiguration`|<span data-ttu-id="46dda-116">Boolean</span><span class="sxs-lookup"><span data-stu-id="46dda-116">Boolean</span></span>|||<span data-ttu-id="46dda-117">Valeur indiquant si une instance de la configuration de l’onglet peut être mise à jour par l’utilisateur après sa création.</span><span class="sxs-lookup"><span data-stu-id="46dda-117">A value indicating whether an instance of the tab's configuration can be updated by the user after creation.</span></span> <span data-ttu-id="46dda-118">Default`true`</span><span class="sxs-lookup"><span data-stu-id="46dda-118">Default: `true`</span></span>|

<span data-ttu-id="46dda-119">Lorsque votre onglet est chargé dans un canal ou une conversation de groupe, teams ajoute un menu déroulant de clic droit pour votre onglet. Les options disponibles sont déterminées `canUpdateConfiguration` par le paramètre :</span><span class="sxs-lookup"><span data-stu-id="46dda-119">When your tab is uploaded to a channel or group chat, Teams will add a right-click drop-down menu for your tab. The available options are determined by the `canUpdateConfiguration` setting:</span></span>

| `canUpdateConfiguration`| <span data-ttu-id="46dda-120">true</span><span class="sxs-lookup"><span data-stu-id="46dda-120">true</span></span>   | <span data-ttu-id="46dda-121">false</span><span class="sxs-lookup"><span data-stu-id="46dda-121">false</span></span> | <span data-ttu-id="46dda-122">description</span><span class="sxs-lookup"><span data-stu-id="46dda-122">description</span></span> |
| ----------------------- | :----: | ----- | ----------- |
|     <span data-ttu-id="46dda-123">Paramètres</span><span class="sxs-lookup"><span data-stu-id="46dda-123">Settings</span></span>            |   <span data-ttu-id="46dda-124">√</span><span class="sxs-lookup"><span data-stu-id="46dda-124">√</span></span>    |       |<span data-ttu-id="46dda-125">La `configurationUrl` page est rechargée dans un IFRAME, ce qui permet à l’utilisateur de reconfigurer l’onglet.</span><span class="sxs-lookup"><span data-stu-id="46dda-125">The `configurationUrl` page is reloaded in an IFrame allowing the user to reconfigure the tab.</span></span>  |
|     <span data-ttu-id="46dda-126">Renommer</span><span class="sxs-lookup"><span data-stu-id="46dda-126">Rename</span></span>              |   <span data-ttu-id="46dda-127">√</span><span class="sxs-lookup"><span data-stu-id="46dda-127">√</span></span>    |   <span data-ttu-id="46dda-128">√</span><span class="sxs-lookup"><span data-stu-id="46dda-128">√</span></span>   | <span data-ttu-id="46dda-129">L’utilisateur peut modifier le nom de l’onglet tel qu’il apparaît dans la barre d’onglets.</span><span class="sxs-lookup"><span data-stu-id="46dda-129">The user can change the tab name as it appears in the tab bar.</span></span>          |
|     <span data-ttu-id="46dda-130">Supprimer</span><span class="sxs-lookup"><span data-stu-id="46dda-130">Remove</span></span>              |   <span data-ttu-id="46dda-131">√</span><span class="sxs-lookup"><span data-stu-id="46dda-131">√</span></span>    |   <span data-ttu-id="46dda-132">√</span><span class="sxs-lookup"><span data-stu-id="46dda-132">√</span></span>   |  <span data-ttu-id="46dda-133">Si la `removeURL` propriété et la valeur sont incluses dans la **page de configuration**, la page de **suppression** est chargée dans un IFRAME et présentée à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="46dda-133">If the  `removeURL` property and value are included in the **configuration page**, the **removal page** is loaded into an IFrame and presented to the user.</span></span> <span data-ttu-id="46dda-134">Si une page de suppression n’est pas incluse, l’utilisateur voit s’afficher une boîte de dialogue de confirmation.</span><span class="sxs-lookup"><span data-stu-id="46dda-134">If a removal page is not included the user is presented with a confirm dialog box.</span></span>          |
|||||

## <a name="create-a-tab-removal-page-for-your-application"></a><span data-ttu-id="46dda-135">Créer une page de suppression d’onglets pour votre application</span><span class="sxs-lookup"><span data-stu-id="46dda-135">Create a tab removal page for your application</span></span>

<span data-ttu-id="46dda-136">La page de suppression facultative est une page HTML que vous hébergez et qui s’affiche lorsque l’onglet est supprimé.</span><span class="sxs-lookup"><span data-stu-id="46dda-136">The optional removal page is an HTML page that you host and is displayed when the tab is removed.</span></span> <span data-ttu-id="46dda-137">L’URL de la page de suppression est `setSettings()` désignée par la méthode dans votre page de configuration.</span><span class="sxs-lookup"><span data-stu-id="46dda-137">The removal page URL is designated by the `setSettings()` method within your configuration page.</span></span> <span data-ttu-id="46dda-138">Comme avec toutes les pages de votre application, la page de suppression doit respecter les [exigences des onglets teams](~/tabs/how-to/add-tab.md).</span><span class="sxs-lookup"><span data-stu-id="46dda-138">As with all pages in your app, the removal page must comply with [Teams tab requirements](~/tabs/how-to/add-tab.md).</span></span>

### <a name="register-a-remove-handler"></a><span data-ttu-id="46dda-139">Inscrire un gestionnaire de suppression</span><span class="sxs-lookup"><span data-stu-id="46dda-139">Register a remove handler</span></span>

<span data-ttu-id="46dda-140">Éventuellement, dans la logique de votre page de suppression, vous pouvez `registerOnRemoveHandler((RemoveEvent) => {}` appeler le gestionnaire d’événements lorsque l’utilisateur supprime une configuration d’onglet existante.</span><span class="sxs-lookup"><span data-stu-id="46dda-140">Optionally, within your removal page logic, you can  invoke the `registerOnRemoveHandler((RemoveEvent) => {}` event handler when the user removes an existing tab configuration.</span></span> <span data-ttu-id="46dda-141">La méthode prend l' [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface et exécute le code dans le gestionnaire lorsqu’un utilisateur tente de supprimer du contenu.</span><span class="sxs-lookup"><span data-stu-id="46dda-141">The  method takes in the [`RemoveEvent`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.removeevent?view=msteams-client-js-latest) interface and executes the code in the handler when a user attempts to remove content.</span></span> <span data-ttu-id="46dda-142">Il est utilisé pour effectuer des opérations de nettoyage, telles que la suppression de la ressource sous-jacente qui alimente le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="46dda-142">It is used to perform cleanup operations such as removing the underlying resource powering the tab content.</span></span> <span data-ttu-id="46dda-143">Un seul gestionnaire de suppression peut être inscrit à la fois.</span><span class="sxs-lookup"><span data-stu-id="46dda-143">Only one remove handler can be registered at a time.</span></span>

<span data-ttu-id="46dda-144">L' `RemoveEvent` interface décrit un objet avec deux méthodes :</span><span class="sxs-lookup"><span data-stu-id="46dda-144">The `RemoveEvent` interface describes an object with two methods:</span></span>

* <span data-ttu-id="46dda-145">La `notifySuccess()` fonction est requise.</span><span class="sxs-lookup"><span data-stu-id="46dda-145">The `notifySuccess()` function is required.</span></span> <span data-ttu-id="46dda-146">Il indique que la suppression de la ressource sous-jacente a réussi et que son contenu peut être supprimé.</span><span class="sxs-lookup"><span data-stu-id="46dda-146">It indicates that the removal of the underlying resource succeeded and its content can be removed.</span></span>

* <span data-ttu-id="46dda-147">La `notifyFailure(string)` fonction est facultative.</span><span class="sxs-lookup"><span data-stu-id="46dda-147">The `notifyFailure(string)` function is optional.</span></span> <span data-ttu-id="46dda-148">Cela indique que la suppression de la ressource sous-jacente a échoué et que son contenu ne peut pas être supprimé.</span><span class="sxs-lookup"><span data-stu-id="46dda-148">It indicates that removal of the underlying resource failed and its content cannot be removed.</span></span> <span data-ttu-id="46dda-149">Le paramètre facultatif String spécifie la raison de l’échec.</span><span class="sxs-lookup"><span data-stu-id="46dda-149">The optional string parameter specifies a reason for the failure.</span></span> <span data-ttu-id="46dda-150">S’il est fourni, cette chaîne est affichée à l’utilisateur ; Sinon, une erreur générique s’affiche.</span><span class="sxs-lookup"><span data-stu-id="46dda-150">If provided, this string is displayed to the user; otherwise a generic error is displayed.</span></span>

#### <a name="use-the-getsettings-function"></a><span data-ttu-id="46dda-151">Utiliser la `getSettings()` fonction</span><span class="sxs-lookup"><span data-stu-id="46dda-151">Use the `getSettings()` function</span></span>

<span data-ttu-id="46dda-152">Vous pouvez utiliser `getSettings()`pour désigner le contenu des onglets à supprimer.</span><span class="sxs-lookup"><span data-stu-id="46dda-152">You can use `getSettings()`to designate the tab content to be removed.</span></span> <span data-ttu-id="46dda-153">La `getSettings((Settings) =>{})` fonction prend le [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) et fournit les valeurs de propriété de paramètres valides qui peuvent être récupérées.</span><span class="sxs-lookup"><span data-stu-id="46dda-153">The `getSettings((Settings) =>{})` function takes in the [`Settings interface`](/javascript/api/@microsoft/teams-js/microsoftteams.settings.settings?view=msteams-client-js-latest) and provides the valid settings property values that can be retrieved.</span></span>

#### <a name="use-the-getcontext-function"></a><span data-ttu-id="46dda-154">Utiliser la `getContext()` fonction</span><span class="sxs-lookup"><span data-stu-id="46dda-154">Use the `getContext()` function</span></span>

<span data-ttu-id="46dda-155">Vous pouvez utiliser `getContext()` pour extraire le contexte actuel dans lequel le cadre est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="46dda-155">You can use `getContext()` to retrieves the current context in which the frame is running.</span></span> <span data-ttu-id="46dda-156">La `getContext((Context) =>{})` fonction prend en [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) et fournit des valeurs `Context` de propriété valides que vous pouvez utiliser dans la logique de votre page de suppression pour déterminer le contenu à afficher dans la page de suppression.</span><span class="sxs-lookup"><span data-stu-id="46dda-156">The `getContext((Context) =>{})` function takes in the [`Context interface`](/javascript/api/@microsoft/teams-js/microsoftteams.context?view=msteams-client-js-latest) and provides valid `Context` property values that you can use in your removal page logic to determine the content to display in the removal page.</span></span>

#### <a name="include-authentication"></a><span data-ttu-id="46dda-157">Inclure l’authentification</span><span class="sxs-lookup"><span data-stu-id="46dda-157">Include authentication</span></span>

<span data-ttu-id="46dda-158">Vous pouvez exiger l’authentification avant d’autoriser un utilisateur à supprimer le contenu de l’onglet.</span><span class="sxs-lookup"><span data-stu-id="46dda-158">You might require authentication before allowing a user to delete the tab content.</span></span> <span data-ttu-id="46dda-159">Les informations de contexte peuvent être utilisées pour vous aider à créer des demandes d’authentification et des URL de page d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="46dda-159">Context information can be used to help construct authentication requests and authorization page URLs.</span></span> <span data-ttu-id="46dda-160">Consultez la rubrique [flux d’authentification Microsoft teams pour les onglets](~/tabs/how-to/authentication/auth-flow-tab.md).</span><span class="sxs-lookup"><span data-stu-id="46dda-160">See [Microsoft Teams authentication flow for tabs](~/tabs/how-to/authentication/auth-flow-tab.md).</span></span> <span data-ttu-id="46dda-161">Assurez-vous que tous les domaines utilisés dans vos pages d’onglets sont répertoriés dans le `manifest.json` `validDomains` tableau.</span><span class="sxs-lookup"><span data-stu-id="46dda-161">Make sure that all domains used in your tab pages are listed in the `manifest.json` `validDomains` array.</span></span>

<span data-ttu-id="46dda-162">Vous trouverez ci-dessous un exemple de bloc de code de suppression d’onglet :</span><span class="sxs-lookup"><span data-stu-id="46dda-162">Below is a sample tab removal code block:</span></span>

```html
<body>
  <button onclick="onClick()">Delete this tab and all underlying data?</button>
  <script>
    microsoftTeams.initialize();
    microsoftTeams.settings.registerOnRemoveHandler((removeEvent) => {
      // Here you can designate the tab content to be removed and/or archived.
        microsoftTeams.settings.getSettings((settings) => {
        settings.contentUrl = "..."
        });
        removeEvent.notifySuccess();
    });

    const onClick() => {
        microsoftTeams.settings.setValidityState(true);
    }
  </script>
</body>

```

<span data-ttu-id="46dda-163">Lorsqu’un utilisateur sélectionne **supprimer** dans le menu déroulant de l’onglet, teams charge la page `removeUrl` facultative (désignée dans votre **page de configuration**) dans un IFRAME.</span><span class="sxs-lookup"><span data-stu-id="46dda-163">When a user selects **Remove** from the tab's drop-down menu, Teams will load the optional `removeUrl` page (designated in your **configuration page**) into an IFrame.</span></span> <span data-ttu-id="46dda-164">Ici, l’utilisateur voit s’afficher un bouton chargé avec la `onClick()` fonction qui appelle `microsoftTeams.settings.setValidityState(true)` et active le bouton **supprimer** situé dans la partie inférieure du cadre de la page de suppression.</span><span class="sxs-lookup"><span data-stu-id="46dda-164">Here, the user is presented with a button loaded with the `onClick()` function that calls `microsoftTeams.settings.setValidityState(true)` and enables the **Remove** button located near the bottom of the removal page IFrame.</span></span>

<span data-ttu-id="46dda-165">Après l’exécution du gestionnaire de suppression, `removeEvent.notifySuccess()` ou `removeEvent.notifyFailure()` avertir les équipes du résultat de la suppression de contenu.</span><span class="sxs-lookup"><span data-stu-id="46dda-165">Following the execution of the remove handler, `removeEvent.notifySuccess()` or `removeEvent.notifyFailure()` notifies Teams of the content removal outcome.</span></span>

>[!NOTE]
><span data-ttu-id="46dda-166">Pour vous assurer que le contrôle d’un utilisateur autorisé sur un onglet n’est pas inhibé, teams supprime l’onglet dans les cas de réussite et d’échec. </span><span class="sxs-lookup"><span data-stu-id="46dda-166">To ensure that an authorized user's control over a tab is not inhibited, Teams will remove the tab in both success and failure cases.</span></span>\
><span data-ttu-id="46dda-167">Teams active le bouton **supprimer** au bout de 5 secondes, même si votre `setValidityState()`onglet n’a pas été appelé. </span><span class="sxs-lookup"><span data-stu-id="46dda-167">Teams enables the **Remove** button after 5 seconds, even if your tab hasn't called `setValidityState()`.</span></span>\
><span data-ttu-id="46dda-168">Lorsque l’utilisateur sélectionne **supprimer** teams supprime l’onglet après 30 secondes, que vos actions soient terminées ou non.</span><span class="sxs-lookup"><span data-stu-id="46dda-168">When the user selects **Remove** Teams removes the tab after 30 seconds regardless of whether your actions have completed.</span></span>
