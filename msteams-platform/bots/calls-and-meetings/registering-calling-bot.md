---
title: Inscription d’un robot de réunion et d’appel pour Microsoft teams
description: Découvrez comment enregistrer un nouveau robot d’appel audio/vidéo pour Microsoft teams
keywords: appels audio/vidéo vidéo audio/vidéo
ms.openlocfilehash: 4db6c29352aa117e0dd1959826d0560359864d8a
ms.sourcegitcommit: 1aa0b172931d0f81db346452788c41dc4a6717b9
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/22/2020
ms.locfileid: "48209752"
---
# <a name="register-a-calling-bot-for-microsoft-teams"></a><span data-ttu-id="2d902-104">Enregistrer un bot appelant pour Microsoft teams</span><span class="sxs-lookup"><span data-stu-id="2d902-104">Register a calling bot for Microsoft Teams</span></span>

<span data-ttu-id="2d902-105">Un bot qui participe à des appels audio/vidéo et des réunions en ligne est un robot Microsoft teams ordinaire avec quelques fonctionnalités supplémentaires :</span><span class="sxs-lookup"><span data-stu-id="2d902-105">A bot that participates in audio/video calls and online meetings is an ordinary Microsoft Teams bot with a few extra features:</span></span>

* <span data-ttu-id="2d902-106">Il existe une nouvelle version du manifeste de l’application teams avec deux paramètres supplémentaires, `supportsCalling` et `supportsVideo` .</span><span class="sxs-lookup"><span data-stu-id="2d902-106">There's a new version of the Teams app manifest with two additional settings, `supportsCalling` and `supportsVideo`.</span></span> <span data-ttu-id="2d902-107">Ces paramètres sont inclus dans la version d' [évaluation du développeur](../../resources/dev-preview/developer-preview-intro.md) du manifeste de l’application Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="2d902-107">These settings are included in the [Developer Preview](../../resources/dev-preview/developer-preview-intro.md) version of the Microsoft Teams app manifest.</span></span>
* <span data-ttu-id="2d902-108">Les [autorisations Microsoft Graph](./registering-calling-bot.md#add-microsoft-graph-permissions) doivent être configurées pour l’ID d’application Microsoft de votre robot.</span><span class="sxs-lookup"><span data-stu-id="2d902-108">[Microsoft Graph permissions](./registering-calling-bot.md#add-microsoft-graph-permissions) must be configured for your bot's Microsoft App ID.</span></span>
* <span data-ttu-id="2d902-109">Les autorisations d’appels et d’API de réunions en ligne de Microsoft Graph nécessitent un consentement de l’administrateur client.</span><span class="sxs-lookup"><span data-stu-id="2d902-109">The Microsoft Graph calls and online meetings APIs permissions require tenant admin consent.</span></span>

<span data-ttu-id="2d902-110">Nous allons étudier ce qui précède plus en détail.</span><span class="sxs-lookup"><span data-stu-id="2d902-110">Let's discuss the above in more detail.</span></span>

## <a name="new-manifest-settings"></a><span data-ttu-id="2d902-111">Nouveaux paramètres de manifeste</span><span class="sxs-lookup"><span data-stu-id="2d902-111">New manifest settings</span></span>

<span data-ttu-id="2d902-112">Les robots d’appels et de réunions en ligne ont deux paramètres supplémentaires dans la manifest.jssur qui activent l’audio/vidéo pour votre robot dans Teams.</span><span class="sxs-lookup"><span data-stu-id="2d902-112">Calling and online meetings bots have two additional settings in the manifest.json that enable audio/video for your bot in Teams.</span></span>

* <span data-ttu-id="2d902-113">`bots[0].supportsCalling`.</span><span class="sxs-lookup"><span data-stu-id="2d902-113">`bots[0].supportsCalling`.</span></span> <span data-ttu-id="2d902-114">S’il est présent et défini sur `true` , teams permettra à votre bot de participer à des appels et réunions en ligne.</span><span class="sxs-lookup"><span data-stu-id="2d902-114">If present and set to `true`, Teams will allow your bot to participate in calls and online meetings.</span></span>
* <span data-ttu-id="2d902-115">`bots[0].supportsVideo`.</span><span class="sxs-lookup"><span data-stu-id="2d902-115">`bots[0].supportsVideo`.</span></span> <span data-ttu-id="2d902-116">S’il est présent et défini sur `true` , teams sait que votre bot prend en charge la vidéo.</span><span class="sxs-lookup"><span data-stu-id="2d902-116">If present and set to `true`, Teams knows that your bot supports video.</span></span>

<span data-ttu-id="2d902-117">Si vous souhaitez que votre IDE valide correctement les manifest.jssur le schéma de votre appel et de votre robot de réunion pour ces valeurs, vous pouvez modifier l' `$schema` attribut comme suit :</span><span class="sxs-lookup"><span data-stu-id="2d902-117">If you want your IDE to properly validate the manifest.json schema for your calling and meeting bot for these values, you can change the `$schema` attribute as follows:</span></span>

```json
"$schema": "https://raw.githubusercontent.com/OfficeDev/microsoft-teams-app-schema/preview/DevPreview/MicrosoftTeams.schema.json",
```

## <a name="creating-a-new-bot-or-adding-calling-capabilities-to-an-existing-bot"></a><span data-ttu-id="2d902-118">Création d’un nouveau Bot ou ajout de fonctionnalités d’appel à un bot existant</span><span class="sxs-lookup"><span data-stu-id="2d902-118">Creating a new bot or adding calling capabilities to an existing bot</span></span>

<span data-ttu-id="2d902-119">La création d’un nouveau Bot est décrite plus en détail dans la rubrique [créer un bot pour Microsoft teams](../how-to/create-a-bot-for-teams.md) , mais nous allons répéter une partie de celle-ci ici :</span><span class="sxs-lookup"><span data-stu-id="2d902-119">Creating a new bot is covered in more detail in the [Create a bot for Microsoft Teams](../how-to/create-a-bot-for-teams.md) topic, but we'll repeat some of it here:</span></span>

1. <span data-ttu-id="2d902-120">Utilisez ce lien pour créer un nouveau robot : `https://dev.botframework.com/bots/new` .</span><span class="sxs-lookup"><span data-stu-id="2d902-120">Use this link to create a new bot: `https://dev.botframework.com/bots/new`.</span></span> <span data-ttu-id="2d902-121">Si, au lieu de cela, vous sélectionnez le bouton *créer un bot* dans le portail de l’infrastructure bot, vous allez créer votre robot dans Microsoft Azure, pour lequel vous aurez besoin d’un compte Azure.</span><span class="sxs-lookup"><span data-stu-id="2d902-121">If, instead,  you select the *Create a bot* button in the Bot Framework portal, you will create your bot in Microsoft Azure, for which you'll need an Azure account.</span></span>
1. <span data-ttu-id="2d902-122">Ajoutez le canal Microsoft Teams.</span><span class="sxs-lookup"><span data-stu-id="2d902-122">Add the Microsoft Teams channel.</span></span> <span data-ttu-id="2d902-123">Cliquez sur l’onglet « appel » de la page de la chaîne Microsoft teams et sélectionnez **activer l’appel**, puis mettez à jour **webhook (pour les appels)** avec votre URL https dans laquelle vous recevrez des notifications entrantes, par exemple `https://contoso.com/teamsapp/api/calling` .</span><span class="sxs-lookup"><span data-stu-id="2d902-123">Click on the "Calling" tab on the Microsoft Teams channel page and select **Enable calling**, and then update **Webhook (for calling)** with your HTTPS URL where you will receive incoming notifications, e.g.`https://contoso.com/teamsapp/api/calling`.</span></span> <span data-ttu-id="2d902-124">Reportez-vous à la rubrique [Configuring Channels](/bot-framework/portal-configure-channels) pour plus d’informations sur la configuration des canaux.</span><span class="sxs-lookup"><span data-stu-id="2d902-124">Refer to [Configuring Channels](/bot-framework/portal-configure-channels) for more information on how to configure channels.</span></span>
  <span data-ttu-id="2d902-125">![Configurer les informations de canal Microsoft teams](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span><span class="sxs-lookup"><span data-stu-id="2d902-125">![Configure Microsoft Teams channel information](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span></span>

## <a name="add-microsoft-graph-permissions"></a><span data-ttu-id="2d902-126">Ajouter des autorisations Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="2d902-126">Add Microsoft Graph permissions</span></span>

<span data-ttu-id="2d902-127">Microsoft Graph expose des autorisations granulaires qui contrôlent l’accès des applications aux ressources.</span><span class="sxs-lookup"><span data-stu-id="2d902-127">Microsoft Graph exposes granular permissions controlling the access that apps have to resources.</span></span> <span data-ttu-id="2d902-128">En tant que développeur, vous décidez des autorisations demandées par votre application pour Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="2d902-128">As a developer, you decide which permissions for Microsoft Graph your app requests.</span></span>  <span data-ttu-id="2d902-129">Les API d’appel Microsoft Graph prennent en charge les _autorisations d’application_, qui sont utilisées par les applications qui s’exécutent sans utilisateur connecté présent.</span><span class="sxs-lookup"><span data-stu-id="2d902-129">The Microsoft Graph Calling APIs support _Application permissions_, which are used by apps that run without a signed-in user present.</span></span>  <span data-ttu-id="2d902-130">Un administrateur client doit accorder le consentement aux autorisations d’application.</span><span class="sxs-lookup"><span data-stu-id="2d902-130">A tenant administrator must grant consent to application permissions.</span></span> <span data-ttu-id="2d902-131">Vous trouverez ci-dessous une liste de ces autorisations :</span><span class="sxs-lookup"><span data-stu-id="2d902-131">Below is a list of those permissions:</span></span>

### <a name="application-permissions-calls"></a><span data-ttu-id="2d902-132">Autorisations d’application : appels</span><span class="sxs-lookup"><span data-stu-id="2d902-132">Application permissions: calls</span></span>

|<span data-ttu-id="2d902-133">Autorisation</span><span class="sxs-lookup"><span data-stu-id="2d902-133">Permission</span></span>    |<span data-ttu-id="2d902-134">Chaîne d’affichage</span><span class="sxs-lookup"><span data-stu-id="2d902-134">Display String</span></span>   |<span data-ttu-id="2d902-135">Description</span><span class="sxs-lookup"><span data-stu-id="2d902-135">Description</span></span> |<span data-ttu-id="2d902-136">Autorisation de l’administrateur requise</span><span class="sxs-lookup"><span data-stu-id="2d902-136">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="2d902-137">_Calls.Initiate.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-137">_Calls.Initiate.All_</span></span>|<span data-ttu-id="2d902-138">Lancer les appels sortants 1:1 depuis l’application (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-138">Initiate outgoing 1:1 calls from the app (preview)</span></span>|<span data-ttu-id="2d902-139">Permet à l’application de passer des appels sortants à un seul utilisateur et de transférer des appels à des utilisateurs dans l’annuaire de votre organisation, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-139">Allows the app to place outbound calls to a single user and transfer calls to users in your organization’s directory, without a signed-in user.</span></span>|<span data-ttu-id="2d902-140">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-140">Yes</span></span>|
|<span data-ttu-id="2d902-141">_Calls.InitiateGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-141">_Calls.InitiateGroupCall.All_</span></span>|<span data-ttu-id="2d902-142">Lancer les appels de groupe sortants 1:1 depuis l’application (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-142">Initiate outgoing group calls from the app (preview)</span></span>|<span data-ttu-id="2d902-143">Permet à l’application de passer des appels sortants à plusieurs utilisateurs et d’ajouter des participants à des réunions dans votre organisation, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-143">Allows the app to place outbound calls to multiple users and add participants to meetings in your organization, without a signed-in user.</span></span>|<span data-ttu-id="2d902-144">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-144">Yes</span></span>|
|<span data-ttu-id="2d902-145">_Calls.JoinGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-145">_Calls.JoinGroupCall.All_</span></span>|<span data-ttu-id="2d902-146">Participer à des réunions et à des appels de groupe en tant qu’application (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-146">Join Group Calls and Meetings as an app (preview)</span></span>|<span data-ttu-id="2d902-147">Permet à l’application de rejoindre les appels de groupe et les réunions planifiées dans votre organisation, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-147">Allows the app to join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="2d902-148">L’application se joindra aux réunions avec les privilèges d’un utilisateur d’annuaire dans votre client.</span><span class="sxs-lookup"><span data-stu-id="2d902-148">The app will be joined with the privileges of a directory user to meetings in your tenant.</span></span>|<span data-ttu-id="2d902-149">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-149">Yes</span></span>|
|<span data-ttu-id="2d902-150">_Calls.JoinGroupCallasGuest.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-150">_Calls.JoinGroupCallasGuest.All_</span></span>|<span data-ttu-id="2d902-151">Participer à des réunions et à des appels de groupe en tant qu’invité (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-151">Join Group Calls and Meetings as a guest (preview)</span></span>|<span data-ttu-id="2d902-152">Permet à l’application de rejoindre anonymement les appels de groupe et les réunions planifiées dans votre organisation, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-152">Allows the app to anonymously join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="2d902-153">L’application se joindra aux réunions en tant qu’invité dans votre client.</span><span class="sxs-lookup"><span data-stu-id="2d902-153">The app will be joined as a guest to meetings in your tenant.</span></span>|<span data-ttu-id="2d902-154">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-154">Yes</span></span>|
|<span data-ttu-id="2d902-155">_Calls. AccessMedia. All_ <sup> _voir ci-dessous_</sup></span><span class="sxs-lookup"><span data-stu-id="2d902-155">_Calls.AccessMedia.All_ <sup>_see below_</sup></span></span>|<span data-ttu-id="2d902-156">Accéder aux flux multimédias dans un appel en tant qu’application (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-156">Access media streams in a call as an app (preview)</span></span>|<span data-ttu-id="2d902-157">Permet à l’application d’obtenir un accès direct aux flux multimédias dans un appel, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-157">Allows the app to get direct access to media streams in a call, without a signed-in user.</span></span>|<span data-ttu-id="2d902-158">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-158">Yes</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="2d902-159">Vous **ne pouvez pas** utiliser l’API Microsoft. Graph. Calls. Media pour enregistrer ou conserver un contenu multimédia à partir d’appels ou de réunions auxquels votre bot accède.</span><span class="sxs-lookup"><span data-stu-id="2d902-159">You **cannot** use the Microsoft.Graph.Calls.Media API to record or otherwise persist media content from calls or meetings that your bot accesses.</span></span>

### <a name="application-permissions-online-meetings"></a><span data-ttu-id="2d902-160">Autorisations d’application : réunions en ligne</span><span class="sxs-lookup"><span data-stu-id="2d902-160">Application permissions: online meetings</span></span>

|<span data-ttu-id="2d902-161">Autorisation</span><span class="sxs-lookup"><span data-stu-id="2d902-161">Permission</span></span>    |<span data-ttu-id="2d902-162">Chaîne d’affichage</span><span class="sxs-lookup"><span data-stu-id="2d902-162">Display String</span></span>   |<span data-ttu-id="2d902-163">Description</span><span class="sxs-lookup"><span data-stu-id="2d902-163">Description</span></span> |<span data-ttu-id="2d902-164">Autorisation de l’administrateur requise</span><span class="sxs-lookup"><span data-stu-id="2d902-164">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="2d902-165">_OnlineMeetings.Read.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-165">_OnlineMeetings.Read.All_</span></span>|<span data-ttu-id="2d902-166">Lire les détails de la réunion en ligne à partir de l’application (aperçu)</span><span class="sxs-lookup"><span data-stu-id="2d902-166">Read Online Meeting details from the app (preview)</span></span>|<span data-ttu-id="2d902-167">Permet à l’application de lire tous les détails de la réunion en ligne dans votre organisation, sans utilisateur connectéé.</span><span class="sxs-lookup"><span data-stu-id="2d902-167">Allows the app to read Online Meeting details in your organization, without a signed-in user.</span></span>|<span data-ttu-id="2d902-168">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-168">Yes</span></span>|
|<span data-ttu-id="2d902-169">_OnlineMeetings.ReadWrite.All_</span><span class="sxs-lookup"><span data-stu-id="2d902-169">_OnlineMeetings.ReadWrite.All_</span></span>|<span data-ttu-id="2d902-170">Lire et créer des réunions en ligne à partir de l’application (aperçu) au nom d’un utilisateur</span><span class="sxs-lookup"><span data-stu-id="2d902-170">Read and Create Online Meetings from the app (preview) on behalf of a user</span></span>|<span data-ttu-id="2d902-171">Permet à l’application de créer des réunions en ligne dans votre organisation au nom d’un utilisateur, sans utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="2d902-171">Allows the app to create Online Meetings in your organization on behalf of a user, without a signed-in user.</span></span>|<span data-ttu-id="2d902-172">Oui</span><span class="sxs-lookup"><span data-stu-id="2d902-172">Yes</span></span>|

### <a name="assigning-permissions"></a><span data-ttu-id="2d902-173">Attribution d'autorisations</span><span class="sxs-lookup"><span data-stu-id="2d902-173">Assigning permissions</span></span>

<span data-ttu-id="2d902-174">Vous devez configurer les autorisations d’application pour votre robot à l’avance.</span><span class="sxs-lookup"><span data-stu-id="2d902-174">You must configure the application permissions for your bot in advance.</span></span> <span data-ttu-id="2d902-175">Nous vous recommandons d’utiliser le [portail d’inscription de l’application Microsoft](https://apps.dev.microsoft.com/) comme décrit [ici](/graph/auth_register_app_v2) , car c’est là que se trouve votre bot. Toutefois, vous pouvez toujours utiliser le [portail Azure](https://aka.ms/aadapplist) si vous préférez utiliser le [point de terminaison Azure ad v1](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span><span class="sxs-lookup"><span data-stu-id="2d902-175">We recommend using the [Microsoft App Registration Portal](https://apps.dev.microsoft.com/) as described [here](/graph/auth_register_app_v2) because that's where your bot was configured; however, you can still use the [Azure portal](https://aka.ms/aadapplist) if you prefer to use the [Azure AD V1 endpoint](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span></span>

### <a name="getting-tenant-administrator-consent"></a><span data-ttu-id="2d902-176">Obtention du consentement de l’administrateur client</span><span class="sxs-lookup"><span data-stu-id="2d902-176">Getting tenant administrator consent</span></span>

<span data-ttu-id="2d902-177">Pour les applications qui utilisent le point de terminaison Azure AD v1, un administrateur client peut accorder des autorisations d’application à l’aide du [portail Azure](https://portal.azure.com) lorsque votre application est installée dans son organisation, ou vous pouvez fournir une expérience d’inscription dans votre application grâce à laquelle les administrateurs peuvent consentir aux autorisations que vous avez configurées.</span><span class="sxs-lookup"><span data-stu-id="2d902-177">For apps using the Azure AD V1 endpoint, a tenant administrator can consent to the application permissions using the [Azure portal](https://portal.azure.com) when your app is installed in their organization, or you can provide a sign-up experience in your app through which administrators can consent to the permissions you configured.</span></span> <span data-ttu-id="2d902-178">Une fois le consentement de l’administrateur enregistré par Azure AD, votre application peut demander des jetons sans avoir à demander de nouveau l’autorisation.</span><span class="sxs-lookup"><span data-stu-id="2d902-178">Once administrator consent is recorded by Azure AD, your app can request tokens without having to request consent again.</span></span>

<span data-ttu-id="2d902-179">Vous pouvez compter sur un administrateur pour accorder les autorisations dont votre application a besoin sur le [portail Azure](https://portal.azure.com); Toutefois, il est souvent préférable de fournir une expérience d’abonnement pour les administrateurs à l’aide du point de terminaison Azure AD v2 `/adminconsent` .</span><span class="sxs-lookup"><span data-stu-id="2d902-179">You can rely on an administrator to grant the permissions your app needs at the [Azure portal](https://portal.azure.com); though, often a better option is to provide a sign-up experience for administrators by using the Azure AD V2 `/adminconsent` endpoint.</span></span>  <span data-ttu-id="2d902-180">Pour plus d’informations, reportez-vous aux [instructions sur la création d’une URL de consentement d’administrateur](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) .</span><span class="sxs-lookup"><span data-stu-id="2d902-180">Please refer to the [instructions on constructing an Admin Consent URL](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) for more information.</span></span>

> [!NOTE]
> <span data-ttu-id="2d902-181">La construction de l’URL de consentement de l’administrateur client nécessite une URL de redirection/URL de réponse dans le [portail d’inscription des applications](https://apps.dev.microsoft.com/).</span><span class="sxs-lookup"><span data-stu-id="2d902-181">Constructing the Tenant Admin Consent URL requires a configured Redirect URI/Reply URL in the [App Registration Portal](https://apps.dev.microsoft.com/).</span></span> <span data-ttu-id="2d902-182">Pour ajouter des URL de réponse pour votre bot, accédez à votre enregistrement de robot, choisissez Options avancées-> modifier le manifeste d’application.</span><span class="sxs-lookup"><span data-stu-id="2d902-182">To add reply URLs for your bot, access your bot registration, choose Advanced Options -> Edit Application Manifest.</span></span>  <span data-ttu-id="2d902-183">Ajoutez votre URL de redirection à la `replyUrls` collection.</span><span class="sxs-lookup"><span data-stu-id="2d902-183">Add your Redirect URL to the `replyUrls` collection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2d902-184">Chaque fois que vous modifiez les autorisations de votre application, vous devez également répéter le processus de consentement de l’administrateur.</span><span class="sxs-lookup"><span data-stu-id="2d902-184">Anytime you make a change to your application's permissions, you must also repeat the Admin Consent process.</span></span> <span data-ttu-id="2d902-185">Les modifications apportées dans le portail d’inscription des applications prennent effet uniquement lorsque le consentement a été donné par l’administrateur du client.</span><span class="sxs-lookup"><span data-stu-id="2d902-185">Changes made in the app registration portal will not be reflected until consent has been reapplied by the tenant's administrator.</span></span>
