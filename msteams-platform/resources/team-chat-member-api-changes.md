---
title: Modifications de l’API du bot pour les membres de l’équipe et de la conversation
author: ojasvichoudhary
description: Décrit les modifications à venir et en cours apportées aux API bot utilisées pour récupérer les membres des équipes et des conversations
keywords: liste des membres de l’équipe d’api bot Framework
ms.topic: reference
ms.author: ojchoudh
ms.openlocfilehash: d55cbcdfea5e374c151c3eec82c52ac7f434c153
ms.sourcegitcommit: 49d1ecda14042bf3f368b14c1971618fe979b914
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/23/2021
ms.locfileid: "51034690"
---
# <a name="changes-to-teams-bot-apis-for-fetching-team-and-chat-members"></a><span data-ttu-id="0f26c-104">Modifications apportées aux API de bot Teams pour la récupération des membres d’équipe et de conversation</span><span class="sxs-lookup"><span data-stu-id="0f26c-104">Changes to Teams bot APIs for fetching team and chat members</span></span>

>[!NOTE]
> <span data-ttu-id="0f26c-105">Nous avons commencé avec le processus de désintériation pour `TeamsInfo.getMembers` les `TeamsInfo.GetMembersAsync` API.</span><span class="sxs-lookup"><span data-stu-id="0f26c-105">We've started with the deprecation process for `TeamsInfo.getMembers` and `TeamsInfo.GetMembersAsync` APIs.</span></span> <span data-ttu-id="0f26c-106">Initialement, ils seront fortement limitées à 5 demandes par minute et retourneront un maximum de 10 000 membres par équipe.</span><span class="sxs-lookup"><span data-stu-id="0f26c-106">Initially, they will be heavily throttled to 5 requests per minute and return a maximum of 10K members per team.</span></span> <span data-ttu-id="0f26c-107">Ainsi, la liste complète n’est pas renvoyée à mesure que la taille de l’équipe augmente.</span><span class="sxs-lookup"><span data-stu-id="0f26c-107">This will result in the full roster not being returned as team size increases.</span></span> 
> 
> <span data-ttu-id="0f26c-108">Vous devez mettre à jour la **version 4.10** ou une version supérieure du SDK Bot Framework et basculer vers les points de terminaison de l’API paginée ou l’API utilisateur `TeamsInfo.GetMemberAsync` unique.</span><span class="sxs-lookup"><span data-stu-id="0f26c-108">**You must update to version 4.10 or higher of the Bot Framework SDK** and switch to the paginated API endpoints, or the `TeamsInfo.GetMemberAsync` single user API.</span></span> <span data-ttu-id="0f26c-109">Cela s’applique également à votre bot même si vous n’utilisez pas directement ces API, car les anciens SDK appellent ces API pendant les événements [MembersAdded.](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added)</span><span class="sxs-lookup"><span data-stu-id="0f26c-109">This also applies to your bot even if you're not directly using these APIs, as older SDKs call these APIs during [membersAdded](../bots/how-to/conversations/subscribe-to-conversation-events.md#team-members-added) events.</span></span> <span data-ttu-id="0f26c-110">Pour afficher la liste des modifications à venir, consultez [les modifications apportées aux API.](team-chat-member-api-changes.md#api-changes)</span><span class="sxs-lookup"><span data-stu-id="0f26c-110">To view the list of upcoming changes, see [API changes](team-chat-member-api-changes.md#api-changes).</span></span> 

<span data-ttu-id="0f26c-111">Actuellement, les développeurs de bots qui souhaitent récupérer des informations pour un ou plusieurs membres d’une conversation ou d’une équipe utilisent les API de bot Microsoft Teams `TeamsInfo.GetMembersAsync` (pour C#) ou `TeamsInfo.getMembers` (pour TypeScript/Node.js) [(documentées ici).](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile)</span><span class="sxs-lookup"><span data-stu-id="0f26c-111">Currently, bot developers who want to retrieve information for one or more members of a chat or team use the Microsoft Teams bot APIs `TeamsInfo.GetMembersAsync` (for C#) or `TeamsInfo.getMembers` (for TypeScript/Node.js) APIs [(documented here)](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile).</span></span> <span data-ttu-id="0f26c-112">Ces API ont aujourd’hui plusieurs défauts :</span><span class="sxs-lookup"><span data-stu-id="0f26c-112">These APIs have several shortcomings today:</span></span>

* <span data-ttu-id="0f26c-113">**Pour les grandes équipes, les performances sont médiocres et les délai d’exécution sont plus probables.**</span><span class="sxs-lookup"><span data-stu-id="0f26c-113">**For large teams, performance is poor and timeouts are more likely.**</span></span> <span data-ttu-id="0f26c-114">La taille maximale de l’équipe a considérablement augmenté depuis la publication de Microsoft Teams début 2017.</span><span class="sxs-lookup"><span data-stu-id="0f26c-114">The maximum team size has grown considerably since Microsoft Teams was released in early 2017.</span></span> <span data-ttu-id="0f26c-115">Étant donné que renvoie l’intégralité de la liste des membres, le retour de l’appel d’API pour les grandes équipes prend beaucoup de temps, et il n’est pas rare que `GetMembersAsync` / l’appel n’approche pas du délai d’attente et que vous devez essayer à `getMembers` nouveau.</span><span class="sxs-lookup"><span data-stu-id="0f26c-115">Since `GetMembersAsync`/`getMembers` returns the entire member list, it takes a long time for the API call to return for large teams, and it’s not uncommon for the call to time out and you have to try again.</span></span>
* <span data-ttu-id="0f26c-116">**L’obtention des détails de profil pour un seul utilisateur est fastidieuse.**</span><span class="sxs-lookup"><span data-stu-id="0f26c-116">**Getting profile details for a single user is cumbersome.**</span></span> <span data-ttu-id="0f26c-117">Pour obtenir les informations de profil d’un seul utilisateur, vous devez récupérer l’intégralité de la liste des membres, puis rechercher celle que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="0f26c-117">To get the profile information for a single user, you have to retrieve the entire member list and then search for the one you want.</span></span> <span data-ttu-id="0f26c-118">Vrai, il existe une fonction d’aide dans le SDK Bot Framework pour le simplifier, mais en réalité, elle n’est pas efficace.</span><span class="sxs-lookup"><span data-stu-id="0f26c-118">True, there’s a helper function in the Bot Framework SDK to make it simpler, but under the covers it’s not efficient.</span></span>

<span data-ttu-id="0f26c-119">Séparément, avec l’introduction des équipes à l’échelle de l’organisation, nous avons compris qu’il était temps de mieux aligner ces API avec les contrôles de confidentialité Office 365 : les bots utilisés dans les grandes équipes peuvent récupérer des informations de profil de base, ce qui est similaire à l’autorisation `User.ReadBasic.All` Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="0f26c-119">Separately, with the introduction of org-wide teams, we realized it was time to better align these APIs with Office 365 privacy controls: bots used in large teams are able to retrieve basic profile information, which is similar to the `User.ReadBasic.All` Microsoft Graph permission.</span></span> <span data-ttu-id="0f26c-120">Les administrateurs clients contrôlent de manière très grande les applications et les bots qui peuvent être utilisés dans leur client, mais ces paramètres sont différents de ceux qui régissent Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="0f26c-120">Tenant administrators have a great deal of control over which apps and bots can be used in their tenant, but these settings are different than the ones governing Microsoft Graph.</span></span>

<span data-ttu-id="0f26c-121">Voici un exemple de représentation JSON de ce qui est renvoyé aujourd’hui par ces API.</span><span class="sxs-lookup"><span data-stu-id="0f26c-121">Here’s a sample JSON representation of what’s returned by these APIs today.</span></span> <span data-ttu-id="0f26c-122">Je vais faire référence à certains des champs ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="0f26c-122">I’ll refer to some of the fields below.</span></span>

```json
[{
    "id": "29:1GcS4EyB_oSI8A88XmWBN7NJFyMqe3QGnJdgLfFGkJnVelzRGos0bPbpsfJjcbAD22bmKc4GMbrY2g4JDrrA8vM06X1-cHHle4zOE6U4ttcc",
    "name": "Anon1 (Guest)",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "anonymous"
}, {
    "id": "29:1bSnHZ7Js2STWrgk6ScEErLk1Lp2zQuD5H2qQ960rtvstKp8tKLl-3r8b6DoW0QxZimuTxk_kupZ1DBMpvIQQUAZL-PNj0EORDvRZXy8kvWk",
    "objectId": "76b0b09f-d410-48fd-993e-84da521a597b",
    "givenName": "John",
    "surname": "Patterson",
    "email": "johnp@fabrikam.com",
    "userPrincipalName": "johnp@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}, {
    "id": "29:1URzNQM1x1PNMr1D7L5_lFe6qF6gEfAbkdG8_BUxOW2mTKryQqEZtBTqDt10-MghkzjYDuUj4KG6nvg5lFAyjOLiGJ4jzhb99WrnI7XKriCs",
    "objectId": "6b7b3b2a-2c4b-4175-8582-41c9e685c1b5",
    "givenName": "Rick",
    "surname": "Stevens",
    "email": "Rick.Stevens@fabrikam.com",
    "userPrincipalName": "rstevens@fabrikam.com",
    "tenantId":"72f988bf-86f1-41af-91ab-2d7cd011db47",
    "userRole": "user"
}]
```

## <a name="api-changes"></a><span data-ttu-id="0f26c-123">Modifications apportées aux API</span><span class="sxs-lookup"><span data-stu-id="0f26c-123">API Changes</span></span>
<span data-ttu-id="0f26c-124">Voici les modifications à venir apportées aux API :</span><span class="sxs-lookup"><span data-stu-id="0f26c-124">Here are the upcoming API changes:</span></span>

* <span data-ttu-id="0f26c-125">Nous avons créé une API pour récupérer les informations de profil pour les membres [`TeamsInfo.GetPagedMembersAsync`](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile) d’une conversation/équipe.</span><span class="sxs-lookup"><span data-stu-id="0f26c-125">We've created a new API [`TeamsInfo.GetPagedMembersAsync`](../bots/how-to/get-teams-context.md#fetching-the-roster-or-user-profile) for retrieving profile information for members of a chat/team.</span></span> <span data-ttu-id="0f26c-126">Cette API est désormais disponible avec le SDK Bot Framework 4.10.</span><span class="sxs-lookup"><span data-stu-id="0f26c-126">This API is now available with the Bot Framework 4.10 SDK.</span></span> <span data-ttu-id="0f26c-127">Pour le développement dans toutes les autres versions, utilisez la [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) méthode.</span><span class="sxs-lookup"><span data-stu-id="0f26c-127">For development in all other versions use the [`GetConversationPagedMembers`](/dotnet/api/microsoft.bot.connector.conversationsextensions.getconversationpagedmembersasync?view=botbuilder-dotnet-stable&preserve-view=true) method.</span></span> 
  > [!NOTE]
  > <span data-ttu-id="0f26c-128">Dans la version v3 ou v4, la meilleure action consiste à mettre à niveau vers la dernière version de point.</span><span class="sxs-lookup"><span data-stu-id="0f26c-128">In either v3 or v4, the best action is to upgrade to the latest point release.</span></span> 
* <span data-ttu-id="0f26c-129">Nous avons créé une nouvelle API pour récupérer les informations de [`TeamsInfo.GetMemberAsync`](../bots/how-to/get-teams-context.md#get-single-member-details) profil d’un seul utilisateur.</span><span class="sxs-lookup"><span data-stu-id="0f26c-129">We've created a new API [`TeamsInfo.GetMemberAsync`](../bots/how-to/get-teams-context.md#get-single-member-details) for retrieving the profile information for a single user.</span></span> <span data-ttu-id="0f26c-130">Il prend l’ID de l’équipe/la conversation et un [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) ( , voir ci-dessus ), Azure Active Directory Object ID ( , voir ci-dessus ), ou l’ID utilisateur Teams ( , voir ci-dessus ) comme paramètres et renvoie les informations de profil pour cet `userPrincipalName`  `objectId`  `id` utilisateur. </span><span class="sxs-lookup"><span data-stu-id="0f26c-130">It takes the ID of the team/chat and a [UPN](https://docs.microsoft.com/windows/win32/ad/naming-properties#userprincipalname) (`userPrincipalName`, *see above*), Azure Active Directory Object ID (`objectId`, *see above*), or the Teams user ID (`id`, *see above*) as parameters and returns the profile information for that user.</span></span> 
  > [!NOTE]
  > <span data-ttu-id="0f26c-131">Nous changeons pour correspondre à ce `objectId` `aadObjectId` qu’il est appelé dans `Activity` l’objet d’un message Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="0f26c-131">We're changing `objectId` to `aadObjectId` to match what it's called in the `Activity` object of a Bot Framework message.</span></span> <span data-ttu-id="0f26c-132">La nouvelle API est disponible avec la version 4.10 du SDK Bot Framework.</span><span class="sxs-lookup"><span data-stu-id="0f26c-132">The new API is available with version 4.10 of the Bot Framework SDK.</span></span> <span data-ttu-id="0f26c-133">Il sera bientôt disponible dans l’extension SDK Teams Bot Framework 3.x également . pendant ce temps, vous pouvez utiliser le point de terminaison [REST.](../bots/how-to/get-teams-context.md?get-single-member-details)</span><span class="sxs-lookup"><span data-stu-id="0f26c-133">It will soon be available in the Teams SDK extension Bot Framework 3.x as well; meanwhile you can use the [REST](../bots/how-to/get-teams-context.md?get-single-member-details) endpoint.</span></span>
* <span data-ttu-id="0f26c-134">`TeamsInfo.GetMembersAsync` (C#) et (TypeScript/Node.js) sont officiellement supprimés et cesseront de fonctionner fin `TeamsInfo.getMembers` 2021.</span><span class="sxs-lookup"><span data-stu-id="0f26c-134">`TeamsInfo.GetMembersAsync` (C#) and `TeamsInfo.getMembers` (TypeScript/Node.js) is formally deprecated and will stop working in late 2021.</span></span> <span data-ttu-id="0f26c-135">Mettez à jour vos bots pour utiliser les API pagiée.</span><span class="sxs-lookup"><span data-stu-id="0f26c-135">Please update your bots to use the paged APIs.</span></span> <span data-ttu-id="0f26c-136">(Cela s’applique également à [l’API REST sous-jacente que ces API utilisent.)](../bots/how-to/get-teams-context.md)</span><span class="sxs-lookup"><span data-stu-id="0f26c-136">(This also applies to the [underlying REST API these APIs use](../bots/how-to/get-teams-context.md).)</span></span>
* <span data-ttu-id="0f26c-137">Fin 2021, les bots ne pourront pas récupérer de manière proactive les propriétés des membres d’une conversation/équipe et devront utiliser Microsoft Graph pour `userPrincipalName` `email` les récupérer.</span><span class="sxs-lookup"><span data-stu-id="0f26c-137">By late 2021, bots will not be able to proactively retrieve the `userPrincipalName` or `email` properties for members of a chat/team and will need to use Microsoft Graph to retrieve them.</span></span> <span data-ttu-id="0f26c-138">Plus précisément, les propriétés ne seront pas renvoyées à partir de la nouvelle API à partir `userPrincipalName` `email` de la fin `GetConversationPagedMembers` 2021.</span><span class="sxs-lookup"><span data-stu-id="0f26c-138">Specifically, `userPrincipalName` and `email` properties won't be returned from the new `GetConversationPagedMembers` API starting in late 2021.</span></span> <span data-ttu-id="0f26c-139">Les bots devront utiliser Microsoft Graph avec un jeton d’accès pour récupérer ces informations.</span><span class="sxs-lookup"><span data-stu-id="0f26c-139">Bots will have to use Microsoft Graph with an access token to retrieve this information.</span></span> <span data-ttu-id="0f26c-140">Il s’agit évidemment d’une modification majeure : nous devons faciliter l’accès d’un jeton d’accès aux bots, et rationaliser et simplifier le processus de consentement de l’utilisateur final.</span><span class="sxs-lookup"><span data-stu-id="0f26c-140">This is obviously a major change: We must make it easier for bots to get an access token, and we must streamline and simplify the end-user consent process.</span></span>

## <a name="feedback-and-more-information"></a><span data-ttu-id="0f26c-141">Commentaires et plus d’informations</span><span class="sxs-lookup"><span data-stu-id="0f26c-141">Feedback and More Information</span></span>
<span data-ttu-id="0f26c-142">Nous utiliserons cette page pour fournir des informations à jour sur ces modifications.</span><span class="sxs-lookup"><span data-stu-id="0f26c-142">We'll use this page for providing up to date information on these changes.</span></span> <span data-ttu-id="0f26c-143">Si vous avez des questions, utilisez la section « Envoyer > commentaires sur cette page » dans la section **Commentaires ci-dessous.**</span><span class="sxs-lookup"><span data-stu-id="0f26c-143">If you have questions, use the "Send feedback > on this page" in the **Feedback** section below.</span></span> 
